import{v as ae,F as se,aU as ue,aG as le,G as ie,H as re,g as ce,r as M,x as r,J as fe,aV as de,a2 as ve,aH as ge,L as he,aW as me,p as D,bc as Pe,bd as A,be as Te,Z as ye,bf as Se,aX as ke,bg as xe,bh as Be,j as H,y as be,aI as Ce,m as Oe,aF as qe,S as Ee}from"./index-Cl83UuLA.js";import{v as Fe,d as R,u as we,f as Me,c as De,p as K,g as Ae,r as I,s as He}from"./position-engine-D6nSYRF0.js";const Ie=ae({name:"QMenu",inheritAttrs:!1,props:{...we,...re,...ie,...le,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:R},self:{type:String,validator:R},offset:{type:Array,validator:Fe},scrollTarget:ue,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...se,"click","escapeKey"],setup(e,{slots:o,emit:n,attrs:s}){let a=null,v,c,g;const S=ce(),{proxy:h}=S,{$q:u}=h,l=M(null),i=M(!1),j=r(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),z=fe(e,u),{registerTick:G,removeTick:Q}=de(),{registerTimeout:k}=ve(),{transitionProps:$,transitionStyle:L}=ge(e),{localScrollTarget:x,changeScrollEvent:U,unconfigureScrollTarget:_}=Me(e,F),{anchorEl:f,canShow:J}=De({showing:i}),{hide:B}=he({showing:i,canShow:J,handleShow:Y,handleHide:p,hideOnRouteChange:j,processOnMount:!0}),{showPortal:b,hidePortal:C,renderPortal:V}=me(S,l,te,"menu"),m={anchorEl:f,innerRef:l,onClickOutside(t){if(e.persistent!==!0&&i.value===!0)return B(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&Ee(t),!0}},O=r(()=>K(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),X=r(()=>e.cover===!0?O.value:K(e.self||"top start",u.lang.rtl)),Z=r(()=>(e.square===!0?" q-menu--square":"")+(z.value===!0?" q-menu--dark q-dark":"")),N=r(()=>e.autoClose===!0?{onClick:ee}:{}),q=r(()=>i.value===!0&&e.persistent!==!0);D(q,t=>{t===!0?(Pe(T),Ae(m)):(A(T),I(m))});function P(){qe(()=>{let t=l.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function Y(t){if(a=e.noRefocus===!1?document.activeElement:null,Te(w),b(),F(),v=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const y=ye(t);if(y.left!==void 0){const{top:oe,left:ne}=f.value.getBoundingClientRect();v={left:y.left-ne,top:y.top-oe}}}c===void 0&&(c=D(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,d)),e.noFocus!==!0&&document.activeElement.blur(),G(()=>{d(),e.noFocus!==!0&&P()}),k(()=>{u.platform.is.ios===!0&&(g=e.autoClose,l.value.click()),d(),b(!0),n("show",t)},e.transitionDuration)}function p(t){Q(),C(),E(!0),a!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t?.type.indexOf("key")===0?a.closest('[tabindex]:not([tabindex^="-"])'):void 0)||a).focus(),a=null),k(()=>{C(!0),n("hide",t)},e.transitionDuration)}function E(t){v=void 0,c!==void 0&&(c(),c=void 0),(t===!0||i.value===!0)&&(Se(w),_(),I(m),A(T)),t!==!0&&(a=null)}function F(){(f.value!==null||e.scrollTarget!==void 0)&&(x.value=ke(f.value,e.scrollTarget),U(x.value,d))}function ee(t){g!==!0?(xe(h,t),n("click",t)):g=!1}function w(t){q.value===!0&&e.noFocus!==!0&&Be(l.value,t.target)!==!0&&P()}function T(t){e.noEscDismiss!==!0&&(n("escapeKey"),B(t))}function d(){He({targetEl:l.value,offset:e.offset,anchorEl:f.value,anchorOrigin:O.value,selfOrigin:X.value,absoluteOffset:v,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function te(){return H(Ce,$.value,()=>i.value===!0?H("div",{role:"menu",...s,ref:l,tabindex:-1,class:["q-menu q-position-engine scroll"+Z.value,s.class],style:[s.style,L.value],...N.value},be(o.default)):null)}return Oe(E),Object.assign(h,{focus:P,updatePosition:d}),V}}),W=["B","KB","MB","GB","TB","PB"];function We(e,o=1){let n=0;for(;parseInt(e,10)>=1024&&n<W.length-1;)e/=1024,++n;return`${e.toFixed(o)}${W[n]}`}function je(e,o,n){return n<=o?o:Math.min(n,Math.max(o,e))}function ze(e,o,n){if(n<=o)return o;const s=n-o+1;let a=o+(e-o)%s;return a<o&&(a=s+a),a===0?0:a}function Ge(e,o=2,n="0"){if(e==null)return e;const s=""+e;return s.length>=o?s:new Array(o-s.length+1).join(n)+s}export{Ie as Q,je as b,We as h,ze as n,Ge as p};
