import{_ as F,c as x,o as b,w as t,b as l,a as e,f as w,Q as f,e as _,t as r,d,O as h,a7 as i,a8 as y,a9 as V,ag as D,aa as E,ab as j,ad as A,h as P,aj as G,ai as S,P as U}from"./index-Cl83UuLA.js";import{Q as B,a as T,b as R,c as q}from"./QTabPanels-DV1ge9A_.js";import{Q as N}from"./QTd-CmxqCGTJ.js";import{Q as C}from"./QBadge-DpwAwdG3.js";import{Q}from"./QTooltip-CfInIkIR.js";import{Q as L}from"./QBtnGroup-fzuFnLyP.js";import{Q as O}from"./QTable-CiHXgcXp.js";import{Q as g,b as n,a as u}from"./position-engine-D6nSYRF0.js";import{Q as z}from"./QList-BkXNU4f3.js";import{Q as M}from"./QForm-DaH_sXUe.js";import{Q as I}from"./QBanner-BEGEs9Nu.js";import{Q as H}from"./QPage-BEA7z6sV.js";import{C as K}from"./ClosePopup-C07de-C8.js";import"./QResizeObserver-DkQCQwCt.js";import"./QSelect-Cxsf63Um.js";import"./QChip-CqufFhuY.js";import"./format-TNedi91C.js";import"./use-panel-DyuWuAyA.js";import"./touch-BjYP5sR0.js";import"./selection-BFvblPyJ.js";import"./use-render-cache-DLxPkVnQ.js";import"./QMarkupTable-kt3qpGaC.js";import"./QLinearProgress-BFMhlV2o.js";import"./use-fullscreen-e78jS5-E.js";const J={name:"TransportesPage",data(){return{loading:!1,rows:[],columns:[{name:"actions",label:"Acciones",align:"center",style:"width: 150px"},{name:"empresa",label:"Empresa",align:"left",field:"empresa",sortable:!0},{name:"placa",label:"Placa",align:"left",field:"placa",sortable:!0},{name:"responsable",label:"Responsable",align:"left",field:"responsable",sortable:!0},{name:"estadisticas",label:"Uso",align:"center",style:"width: 120px"},{name:"alertas",label:"Alertas",align:"center",style:"width: 150px"}],filter:"",pagination:{rowsPerPage:10},tab:"lista",estadisticas:{entrada:{total_viajes:0,kg_transportados:0,distancia_total_km:0,alertas_temperatura:0,alertas_tiempo:0,productores_atendidos:0,porcentaje_cumplimiento:100},salida:{total_entregas:0,kg_entregados:0,valor_total:0,clientes_atendidos:0},totales:{total_viajes:0,total_kg:0}},dlg:{open:!1,mode:"create",row:null},form:{empresa:"",placa:"",responsable:"",telefono:"",observaciones:""},saving:!1,dlgDetalle:{open:!1,transporte:null,estadisticas:null,tab:"entrada"}}},computed:{canSubmit(){const c=this.form;return!!(c.empresa&&c.placa&&c.responsable)},topTransportes(){return[...this.rows].sort((c,a)=>{const v=c.estadisticas_uso?.total_viajes||0;return(a.estadisticas_uso?.total_viajes||0)-v}).slice(0,5)},transportesConAlertas(){return this.rows.filter(c=>{const a=c.estadisticas_uso?.alertas_temperatura||0,v=c.estadisticas_uso?.alertas_tiempo||0;return a>0||v>0})}},mounted(){this.fetch(),this.cargarEstadisticas()},methods:{async fetch(){this.loading=!0;try{const c={};this.filter&&(c.q=this.filter);const{data:a}=await this.$axios.get("/transportes",{params:c});this.rows=Array.isArray(a)?a:a.data||[]}catch(c){this.$q.notify({type:"negative",message:c.response?.data?.message||"Error al listar transportes"})}finally{this.loading=!1}},async cargarEstadisticas(){try{const c=this.rows.map(p=>this.$axios.get(`/transportes/${p.id}/estadisticas-completas`).then(({data:s})=>s.estadisticas).catch(()=>null)),v=(await Promise.all(c)).filter(p=>p!==null);v.length>0&&(this.estadisticas={entrada:{total_viajes:v.reduce((p,s)=>p+(s.entrada?.total_viajes||0),0),kg_transportados:v.reduce((p,s)=>p+(s.entrada?.kg_transportados||0),0),distancia_total_km:v.reduce((p,s)=>p+(s.entrada?.distancia_total_km||0),0),alertas_temperatura:v.reduce((p,s)=>p+(s.entrada?.alertas_temperatura||0),0),alertas_tiempo:v.reduce((p,s)=>p+(s.entrada?.alertas_tiempo||0),0),productores_atendidos:v.reduce((p,s)=>p+(s.entrada?.productores_atendidos||0),0),porcentaje_cumplimiento:v.reduce((p,s)=>p+(s.entrada?.porcentaje_cumplimiento||100),0)/v.length},salida:{total_entregas:v.reduce((p,s)=>p+(s.salida?.total_entregas||0),0),kg_entregados:v.reduce((p,s)=>p+(s.salida?.kg_entregados||0),0),valor_total:v.reduce((p,s)=>p+(s.salida?.valor_total||0),0),clientes_atendidos:v.reduce((p,s)=>p+(s.salida?.clientes_atendidos||0),0)},totales:{total_viajes:v.reduce((p,s)=>p+(s.totales?.total_viajes||0),0),total_kg:v.reduce((p,s)=>p+(s.totales?.total_kg||0),0)}})}catch(c){console.error("Error al cargar estad√≠sticas:",c)}},fetchDebounced:(()=>{let c;return function(){clearTimeout(c),c=setTimeout(()=>this.fetch(),350)}})(),openCreate(){this.dlg={open:!0,mode:"create",row:null},this.form={empresa:"",placa:"",responsable:"",telefono:"",observaciones:""}},openEdit(c){this.dlg={open:!0,mode:"edit",row:c},this.form={empresa:c.empresa||"",placa:c.placa||"",responsable:c.responsable||"",telefono:c.telefono||"",observaciones:c.observaciones||""}},async verDetalle(c){this.dlgDetalle={open:!0,transporte:c,estadisticas:null,tab:"entrada"};try{const{data:a}=await this.$axios.get(`/transportes/${c.id}/estadisticas-completas`);this.dlgDetalle.estadisticas=a.estadisticas}catch(a){console.error("Error al cargar estad√≠sticas:",a),this.$q.notify({type:"warning",message:"No se pudieron cargar las estad√≠sticas completas"})}},async onSubmit(){if(this.canSubmit){this.saving=!0;try{this.dlg.mode==="create"?await this.$axios.post("/transportes",this.form):await this.$axios.put(`/transportes/${this.dlg.row.id}`,this.form),this.$q.notify({type:"positive",message:"Guardado exitosamente",icon:"check_circle"}),this.dlg.open=!1,await this.fetch(),await this.cargarEstadisticas()}catch(c){this.$q.notify({type:"negative",message:c.response?.data?.message||"No se pudo guardar"})}finally{this.saving=!1}}},async onDelete(c){this.$q.dialog({title:"Confirmar Eliminaci√≥n",message:`¬øEst√° seguro de eliminar el transporte ${c.empresa||c.placa}?<br><br><strong>Nota:</strong> Esta acci√≥n no eliminar√° los registros de transporte asociados.`,html:!0,cancel:{label:"Cancelar",flat:!0,color:"grey-7"},ok:{label:"Eliminar",color:"negative"},persistent:!0}).onOk(async()=>{try{await this.$axios.delete(`/transportes/${c.id}`),this.$q.notify({type:"positive",message:"Eliminado exitosamente",icon:"check_circle"}),await this.fetch(),await this.cargarEstadisticas()}catch(a){this.$q.notify({type:"negative",message:a.response?.data?.message||"No se pudo eliminar"})}})},formatNumber(c){return new Intl.NumberFormat("es-BO").format(c||0)}}},W={class:"row q-mb-md items-center"},X={class:"col-12 col-md-6"},Y={class:"row q-gutter-sm justify-end"},Z={class:"row q-col-gutter-md q-mb-md"},$={class:"col-12 col-sm-6 col-md-2"},ee={class:"text-h6"},te={class:"col-12 col-sm-6 col-md-3"},ae={class:"row items-center"},le={class:"text-h6"},se={class:"col-12 col-sm-6 col-md-2"},oe={class:"text-h6"},ie={class:"col-12 col-sm-6 col-md-3"},re={class:"row items-center"},de={class:"text-h6"},ne={class:"col-12 col-sm-6 col-md-2"},ue={class:"text-h6"},ce={class:"text-caption"},me={key:2,class:"text-grey-6"},_e={class:"row q-col-gutter-md"},pe={class:"col-12 col-md-6"},fe={class:"row items-center"},ge={class:"col-12 col-md-6"},ve={class:"row items-center"},be={class:"col-12"},xe={class:"row q-col-gutter-md"},he={class:"col-12 col-md-4"},ye={class:"col-12 col-md-4"},we={class:"col-12 col-md-4"},ke={class:"col-12"},Ve={class:"text-h6"},De={class:"row q-col-gutter-md"},Te={class:"col-12 col-md-6"},qe={class:"col-12 col-md-6"},Ce={class:"col-12 col-md-6"},Qe={class:"col-12 col-md-6"},ze={class:"col-12"},Ne={class:"text-h6"},Ee={class:"row q-col-gutter-md q-mb-md"},je={class:"col-12 col-md-4"},Ae={class:"col-12 col-md-4"},Pe={class:"col-12 col-md-4"},Se={key:0,class:"row q-col-gutter-md"},Ue={class:"col-12 col-sm-6 col-md-4"},Be={class:"text-center"},Re={class:"text-h6"},Ie={class:"col-12 col-sm-6 col-md-4"},Ke={class:"text-center"},Fe={class:"text-h6"},Ge={class:"col-12 col-sm-6 col-md-4"},Le={class:"text-center"},Oe={class:"text-h6"},Me={class:"col-12 col-sm-6 col-md-4"},He={class:"text-center"},Je={class:"text-h6"},We={class:"col-12 col-sm-6 col-md-4"},Xe={class:"text-center"},Ye={class:"text-h6"},Ze={class:"col-12 col-sm-6 col-md-4"},$e={class:"text-center"},et={class:"text-h6"},tt={key:0,class:"row q-col-gutter-md"},at={class:"col-12 col-sm-6 col-md-4"},lt={class:"text-center"},st={class:"text-h6"},ot={class:"col-12 col-sm-6 col-md-4"},it={class:"text-center"},rt={class:"text-h6"},dt={class:"col-12 col-sm-6 col-md-4"},nt={class:"text-center"},ut={class:"text-h6"},ct={class:"col-12 col-sm-6 col-md-4"},mt={class:"text-center"},_t={class:"text-h6"},pt={class:"col-12 col-sm-6 col-md-4"},ft={class:"text-center"},gt={class:"text-h6"},vt={class:"col-12 col-sm-6 col-md-4"},bt={class:"text-center"},xt={class:"text-h6"},ht={key:0,class:"row q-col-gutter-md"},yt={class:"col-12 col-md-6"},wt={class:"text-center"},kt={class:"text-h4 q-mt-sm"},Vt={class:"col-12 col-md-6"},Dt={class:"text-center"},Tt={class:"text-h4 q-mt-sm"},qt={class:"col-12"};function Ct(c,a,v,p,s,m){return b(),x(H,{class:"q-pa-md"},{default:t(()=>[l("div",W,[a[13]||(a[13]=l("div",{class:"col-12 col-md-6"},[l("div",{class:"text-h5 text-weight-bold"},"Gesti√≥n de Transportes"),l("div",{class:"text-caption text-grey-7"},"Control de veh√≠culos y estad√≠sticas de uso")],-1)),l("div",X,[l("div",Y,[e(w,{color:"positive",icon:"add_circle_outline",label:"Nuevo Transporte","no-caps":"",onClick:m.openCreate},null,8,["onClick"]),e(w,{color:"primary",icon:"refresh",label:"Actualizar","no-caps":"",loading:s.loading,onClick:m.fetch},null,8,["loading","onClick"])])])]),l("div",Z,[l("div",$,[e(f,{class:"bg-primary text-white"},{default:t(()=>[e(_,null,{default:t(()=>[l("div",ee,r(s.rows.length),1),a[14]||(a[14]=l("div",{class:"text-caption"},"Total Transportes",-1))]),_:1})]),_:1})]),l("div",te,[e(f,{class:"bg-positive text-white"},{default:t(()=>[e(_,null,{default:t(()=>[l("div",ae,[e(d,{name:"input",size:"sm",class:"q-mr-sm"}),l("div",null,[l("div",le,r(s.estadisticas.entrada?.total_viajes||0),1),a[15]||(a[15]=l("div",{class:"text-caption"}," Viajes Entrada (Acopios)",-1))])])]),_:1})]),_:1})]),l("div",se,[e(f,{class:"bg-teal text-white"},{default:t(()=>[e(_,null,{default:t(()=>[l("div",oe,r(m.formatNumber(s.estadisticas.entrada?.kg_transportados||0))+" kg",1),a[16]||(a[16]=l("div",{class:"text-caption"},"Kg Transportados",-1))]),_:1})]),_:1})]),l("div",ie,[e(f,{class:"bg-info text-white"},{default:t(()=>[e(_,null,{default:t(()=>[l("div",re,[e(d,{name:"output",size:"sm",class:"q-mr-sm"}),l("div",null,[l("div",de,r(s.estadisticas.salida?.total_entregas||0),1),a[17]||(a[17]=l("div",{class:"text-caption"}," Entregas (Ventas)",-1))])])]),_:1})]),_:1})]),l("div",ne,[e(f,{class:"bg-orange text-white"},{default:t(()=>[e(_,null,{default:t(()=>[l("div",ue,r(s.estadisticas.entrada?.alertas_temperatura+s.estadisticas.entrada?.alertas_tiempo||0),1),a[18]||(a[18]=l("div",{class:"text-caption"},"Alertas",-1))]),_:1})]),_:1})])]),e(B,{modelValue:s.tab,"onUpdate:modelValue":a[0]||(a[0]=o=>s.tab=o),class:"text-primary",align:"left",dense:""},{default:t(()=>[e(T,{name:"lista",icon:"list",label:"Lista de Transportes"}),e(T,{name:"estadisticas",icon:"bar_chart",label:"Estad√≠sticas"}),e(T,{name:"alertas",icon:"warning",label:"Alertas"})]),_:1},8,["modelValue"]),e(h),e(R,{modelValue:s.tab,"onUpdate:modelValue":a[2]||(a[2]=o=>s.tab=o),animated:"",class:"q-mt-md"},{default:t(()=>[e(q,{name:"lista"},{default:t(()=>[e(O,{rows:s.rows,columns:s.columns,"row-key":"id",flat:"",bordered:"",dense:"","wrap-cells":"","rows-per-page-options":[10,25,50,0],loading:s.loading,filter:s.filter,"pagination.sync":"pagination"},{"top-right":t(()=>[e(D,{modelValue:s.filter,"onUpdate:modelValue":[a[1]||(a[1]=o=>s.filter=o),m.fetchDebounced],dense:"",outlined:"",placeholder:"Buscar por empresa, placa o responsable",style:{width:"300px"}},{append:t(()=>[e(d,{name:"search"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),"body-cell-estadisticas":t(o=>[e(N,{props:o},{default:t(()=>[l("div",ce,[l("div",null,[a[19]||(a[19]=l("strong",null,"Acopios:",-1)),i(" "+r(o.row.estadisticas_uso?.total_acopios||0),1)]),l("div",null,[a[20]||(a[20]=l("strong",null,"Ventas:",-1)),i(" "+r(o.row.estadisticas_uso?.total_ventas||0),1)])])]),_:2},1032,["props"])]),"body-cell-alertas":t(o=>[e(N,{props:o},{default:t(()=>[o.row.estadisticas_uso?.alertas_temperatura>0?(b(),x(C,{key:0,color:"red",class:"q-mr-xs"},{default:t(()=>[i(" üå°Ô∏è "+r(o.row.estadisticas_uso.alertas_temperatura),1)]),_:2},1024)):y("",!0),o.row.estadisticas_uso?.alertas_tiempo>0?(b(),x(C,{key:1,color:"orange"},{default:t(()=>[i(" ‚è±Ô∏è "+r(o.row.estadisticas_uso.alertas_tiempo),1)]),_:2},1024)):y("",!0),!o.row.estadisticas_uso?.alertas_temperatura&&!o.row.estadisticas_uso?.alertas_tiempo?(b(),V("span",me," Sin alertas ")):y("",!0)]),_:2},1032,["props"])]),"body-cell-actions":t(o=>[e(N,{props:o,class:"text-right"},{default:t(()=>[e(L,{flat:""},{default:t(()=>[e(w,{flat:"",dense:"",color:"info",icon:"info",size:"sm",onClick:k=>m.verDetalle(o.row)},{default:t(()=>[e(Q,null,{default:t(()=>a[21]||(a[21]=[i("Ver detalle")])),_:1})]),_:2},1032,["onClick"]),e(w,{flat:"",dense:"",color:"primary",icon:"edit",size:"sm",onClick:k=>m.openEdit(o.row)},{default:t(()=>[e(Q,null,{default:t(()=>a[22]||(a[22]=[i("Editar")])),_:1})]),_:2},1032,["onClick"]),e(w,{flat:"",dense:"",color:"negative",icon:"delete",size:"sm",onClick:k=>m.onDelete(o.row)},{default:t(()=>[e(Q,null,{default:t(()=>a[23]||(a[23]=[i("Eliminar")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","filter"])]),_:1}),e(q,{name:"estadisticas"},{default:t(()=>[l("div",_e,[l("div",pe,[e(f,null,{default:t(()=>[e(_,{class:"bg-positive text-white"},{default:t(()=>[l("div",fe,[e(d,{name:"input",size:"md",class:"q-mr-sm"}),a[24]||(a[24]=l("div",{class:"text-h6"},"Transportes de Entrada (Acopios)",-1))])]),_:1}),e(h),e(_,null,{default:t(()=>[e(z,{separator:""},{default:t(()=>[e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"local_shipping",color:"positive"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[25]||(a[25]=[i("Total de viajes")])),_:1}),e(u,{caption:""},{default:t(()=>[i(r(m.formatNumber(s.estadisticas.entrada?.total_viajes||0)),1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"scale",color:"teal"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[26]||(a[26]=[i("Kg transportados")])),_:1}),e(u,{caption:""},{default:t(()=>[i(r(m.formatNumber(s.estadisticas.entrada?.kg_transportados||0))+" kg",1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"place",color:"info"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[27]||(a[27]=[i("Distancia total recorrida")])),_:1}),e(u,{caption:""},{default:t(()=>[i(r(m.formatNumber(s.estadisticas.entrada?.distancia_total_km||0))+" km",1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"people",color:"primary"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[28]||(a[28]=[i("Productores atendidos")])),_:1}),e(u,{caption:""},{default:t(()=>[i(r(s.estadisticas.entrada?.productores_atendidos||0),1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"warning",color:"orange"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[29]||(a[29]=[i("Alertas temperatura / tiempo")])),_:1}),e(u,{caption:""},{default:t(()=>[i(" üå°Ô∏è "+r(s.estadisticas.entrada?.alertas_temperatura||0)+" / ‚è±Ô∏è "+r(s.estadisticas.entrada?.alertas_tiempo||0),1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"verified",color:"positive"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[30]||(a[30]=[i("Cumplimiento ")])),_:1}),e(u,{caption:""},{default:t(()=>[i(r((s.estadisticas.entrada?.porcentaje_cumplimiento||100).toFixed(1))+"%",1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),l("div",ge,[e(f,null,{default:t(()=>[e(_,{class:"bg-info text-white"},{default:t(()=>[l("div",ve,[e(d,{name:"output",size:"md",class:"q-mr-sm"}),a[31]||(a[31]=l("div",{class:"text-h6"}," Transportes de Salida (Ventas)",-1))])]),_:1}),e(h),e(_,null,{default:t(()=>[e(z,{separator:""},{default:t(()=>[e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"local_shipping",color:"info"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[32]||(a[32]=[i("Total de entregas")])),_:1}),e(u,{caption:""},{default:t(()=>[i(r(m.formatNumber(s.estadisticas.salida?.total_entregas||0)),1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"scale",color:"teal"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[33]||(a[33]=[i("Kg entregados")])),_:1}),e(u,{caption:""},{default:t(()=>[i(r(m.formatNumber(s.estadisticas.salida?.kg_entregados||0))+" kg",1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"payments",color:"positive"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[34]||(a[34]=[i("Valor total")])),_:1}),e(u,{caption:""},{default:t(()=>[i("Bs. "+r(m.formatNumber(s.estadisticas.salida?.valor_total||0)),1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"business",color:"primary"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[35]||(a[35]=[i("Clientes atendidos")])),_:1}),e(u,{caption:""},{default:t(()=>[i(r(s.estadisticas.salida?.clientes_atendidos||0),1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"check_circle",color:"positive"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[36]||(a[36]=[i("Promedio por entrega")])),_:1}),e(u,{caption:""},{default:t(()=>[i(r(m.formatNumber(s.estadisticas.salida?.kg_promedio||0))+" kg",1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"attach_money",color:"orange"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[37]||(a[37]=[i("Valor promedio")])),_:1}),e(u,{caption:""},{default:t(()=>[i("Bs. "+r(m.formatNumber(s.estadisticas.salida?.valor_promedio||0)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),l("div",be,[e(f,null,{default:t(()=>[e(_,null,{default:t(()=>a[38]||(a[38]=[l("div",{class:"text-h6"},"Totales Generales",-1)])),_:1}),e(h),e(_,null,{default:t(()=>[l("div",xe,[l("div",he,[e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"local_shipping",color:"primary",size:"lg"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[39]||(a[39]=[i("Transportes Registrados")])),_:1}),e(u,{caption:"",class:"text-h6"},{default:t(()=>[i(r(s.rows.length),1)]),_:1})]),_:1})]),_:1})]),l("div",ye,[e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"route",color:"positive",size:"lg"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[40]||(a[40]=[i("Total Viajes (Entrada + Salida)")])),_:1}),e(u,{caption:"",class:"text-h6"},{default:t(()=>[i(r(m.formatNumber(s.estadisticas.totales?.total_viajes||0)),1)]),_:1})]),_:1})]),_:1})]),l("div",we,[e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"scale",color:"teal",size:"lg"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>a[41]||(a[41]=[i("Total Kg Movilizados")])),_:1}),e(u,{caption:"",class:"text-h6"},{default:t(()=>[i(r(m.formatNumber(s.estadisticas.totales?.total_kg||0))+" kg",1)]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1})]),l("div",ke,[e(f,null,{default:t(()=>[e(_,null,{default:t(()=>a[42]||(a[42]=[l("div",{class:"text-h6"},"Transportes M√°s Utilizados",-1)])),_:1}),e(h),e(_,null,{default:t(()=>[e(z,{separator:""},{default:t(()=>[(b(!0),V(E,null,j(m.topTransportes,(o,k)=>(b(),x(g,{key:o.id},{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(A,{color:k===0?"amber":k===1?"grey-5":k===2?"orange-8":"primary","text-color":"white"},{default:t(()=>[i(r(k+1),1)]),_:2},1032,["color"])]),_:2},1024),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>[i(r(o.empresa)+" - "+r(o.placa),1)]),_:2},1024),e(u,{caption:""},{default:t(()=>[i(r(o.responsable),1)]),_:2},1024)]),_:2},1024),e(n,{side:""},{default:t(()=>[e(u,null,{default:t(()=>[i(r(o.estadisticas_uso?.total_viajes||0)+" viajes",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])])]),_:1}),e(q,{name:"alertas"},{default:t(()=>[e(f,null,{default:t(()=>[e(_,null,{default:t(()=>a[43]||(a[43]=[l("div",{class:"text-h6"},"Transportes con Alertas",-1),l("div",{class:"text-caption text-grey-7"},"Veh√≠culos con incidencias en temperatura o tiempo",-1)])),_:1}),e(h),e(_,null,{default:t(()=>[e(z,{separator:""},{default:t(()=>[(b(!0),V(E,null,j(m.transportesConAlertas,o=>(b(),x(g,{key:o.id},{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(A,{color:"red","text-color":"white",icon:"warning"})]),_:1}),e(n,null,{default:t(()=>[e(u,null,{default:t(()=>[i(r(o.empresa)+" - "+r(o.placa),1)]),_:2},1024),e(u,{caption:""},{default:t(()=>[i("Responsable: "+r(o.responsable),1)]),_:2},1024)]),_:2},1024),e(n,{side:""},{default:t(()=>[l("div",null,[o.estadisticas_uso?.alertas_temperatura>0?(b(),x(C,{key:0,color:"red",class:"q-mr-xs"},{default:t(()=>[i(r(o.estadisticas_uso.alertas_temperatura),1)]),_:2},1024)):y("",!0),o.estadisticas_uso?.alertas_tiempo>0?(b(),x(C,{key:1,color:"orange"},{default:t(()=>[i(r(o.estadisticas_uso.alertas_tiempo),1)]),_:2},1024)):y("",!0)])]),_:2},1024),e(n,{side:""},{default:t(()=>[e(w,{flat:"",dense:"",color:"info",icon:"visibility",onClick:k=>m.verDetalle(o)},{default:t(()=>[e(Q,null,{default:t(()=>a[44]||(a[44]=[i("Ver detalle")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),m.transportesConAlertas.length===0?(b(),x(g,{key:0},{default:t(()=>[e(n,null,{default:t(()=>[e(u,{class:"text-center text-grey-6"},{default:t(()=>[e(d,{name:"check_circle",size:"lg",color:"positive"}),a[45]||(a[45]=l("div",null,"No hay transportes con alertas",-1))]),_:1})]),_:1})]),_:1})):y("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(P,{modelValue:s.dlg.open,"onUpdate:modelValue":a[9]||(a[9]=o=>s.dlg.open=o),persistent:""},{default:t(()=>[e(f,{style:{"min-width":"600px","max-width":"900px"}},{default:t(()=>[e(_,{class:"bg-primary text-white"},{default:t(()=>[l("div",Ve,[e(d,{name:"local_shipping",class:"q-mr-sm"}),i(" "+r(s.dlg.mode==="create"?"Nuevo Transporte":"Editar Transporte"),1)])]),_:1}),e(h),e(_,null,{default:t(()=>[e(M,{onSubmit:G(m.onSubmit,["prevent"]),ref:"formRef"},{default:t(()=>[l("div",De,[a[46]||(a[46]=l("div",{class:"col-12"},[l("div",{class:"text-subtitle2 text-weight-bold q-mb-sm"},"Informaci√≥n del Veh√≠culo")],-1)),l("div",Te,[e(D,{modelValue:s.form.empresa,"onUpdate:modelValue":a[3]||(a[3]=o=>s.form.empresa=o),dense:"",outlined:"",label:"Empresa / Raz√≥n social *",rules:[o=>!!o||"Campo requerido"]},{prepend:t(()=>[e(d,{name:"business"})]),_:1},8,["modelValue","rules"])]),l("div",qe,[e(D,{modelValue:s.form.placa,"onUpdate:modelValue":[a[4]||(a[4]=o=>s.form.placa=o),a[5]||(a[5]=o=>s.form.placa=o.toUpperCase())],dense:"",outlined:"",label:"Placa *",rules:[o=>!!o||"Campo requerido"]},{prepend:t(()=>[e(d,{name:"pin"})]),_:1},8,["modelValue","rules"])]),l("div",Ce,[e(D,{modelValue:s.form.responsable,"onUpdate:modelValue":a[6]||(a[6]=o=>s.form.responsable=o),dense:"",outlined:"",label:"Responsable / Conductor *",rules:[o=>!!o||"Campo requerido"]},{prepend:t(()=>[e(d,{name:"person"})]),_:1},8,["modelValue","rules"])]),l("div",Qe,[e(D,{modelValue:s.form.telefono,"onUpdate:modelValue":a[7]||(a[7]=o=>s.form.telefono=o),dense:"",outlined:"",label:"Tel√©fono de Contacto",mask:"####-####"},{prepend:t(()=>[e(d,{name:"phone"})]),_:1},8,["modelValue"])]),l("div",ze,[e(D,{modelValue:s.form.observaciones,"onUpdate:modelValue":a[8]||(a[8]=o=>s.form.observaciones=o),dense:"",outlined:"",type:"textarea",rows:"3",label:"Observaciones"},{prepend:t(()=>[e(d,{name:"notes"})]),_:1},8,["modelValue"])])])]),_:1},8,["onSubmit"])]),_:1}),e(h),e(S,{align:"right",class:"q-pa-md"},{default:t(()=>[U(e(w,{flat:"",label:"Cancelar",color:"grey-7"},null,512),[[K]]),e(w,{unelevated:"",color:"primary",loading:s.saving,disable:!m.canSubmit,label:"Guardar",icon:"save",onClick:m.onSubmit},null,8,["loading","disable","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(P,{modelValue:s.dlgDetalle.open,"onUpdate:modelValue":a[12]||(a[12]=o=>s.dlgDetalle.open=o)},{default:t(()=>[e(f,{style:{"min-width":"800px","max-width":"1200px"}},{default:t(()=>[e(_,{class:"bg-info text-white"},{default:t(()=>[l("div",Ne,[e(d,{name:"info",class:"q-mr-sm"}),a[47]||(a[47]=i(" Detalle del Transporte "))])]),_:1}),e(h),s.dlgDetalle.transporte?(b(),x(_,{key:0},{default:t(()=>[l("div",Ee,[l("div",je,[e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"business",color:"primary",size:"md"})]),_:1}),e(n,null,{default:t(()=>[e(u,{caption:""},{default:t(()=>a[48]||(a[48]=[i("Empresa")])),_:1}),e(u,{class:"text-weight-bold"},{default:t(()=>[i(r(s.dlgDetalle.transporte.empresa),1)]),_:1})]),_:1})]),_:1})]),l("div",Ae,[e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"pin",color:"primary",size:"md"})]),_:1}),e(n,null,{default:t(()=>[e(u,{caption:""},{default:t(()=>a[49]||(a[49]=[i("Placa")])),_:1}),e(u,{class:"text-weight-bold"},{default:t(()=>[i(r(s.dlgDetalle.transporte.placa),1)]),_:1})]),_:1})]),_:1})]),l("div",Pe,[e(g,null,{default:t(()=>[e(n,{avatar:""},{default:t(()=>[e(d,{name:"person",color:"primary",size:"md"})]),_:1}),e(n,null,{default:t(()=>[e(u,{caption:""},{default:t(()=>a[50]||(a[50]=[i("Responsable")])),_:1}),e(u,{class:"text-weight-bold"},{default:t(()=>[i(r(s.dlgDetalle.transporte.responsable),1)]),_:1})]),_:1})]),_:1})])]),e(B,{modelValue:s.dlgDetalle.tab,"onUpdate:modelValue":a[10]||(a[10]=o=>s.dlgDetalle.tab=o),class:"text-primary",dense:""},{default:t(()=>[e(T,{name:"entrada",icon:"input",label:"Entrada (Acopios)"}),e(T,{name:"salida",icon:"output",label:"Salida (Ventas)"}),e(T,{name:"alertas",icon:"warning",label:"Alertas"})]),_:1},8,["modelValue"]),e(h),e(R,{modelValue:s.dlgDetalle.tab,"onUpdate:modelValue":a[11]||(a[11]=o=>s.dlgDetalle.tab=o),animated:""},{default:t(()=>[e(q,{name:"entrada"},{default:t(()=>[s.dlgDetalle.estadisticas?(b(),V("div",Se,[l("div",Ue,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",Be,[e(d,{name:"local_shipping",color:"positive",size:"lg"}),l("div",Re,r(m.formatNumber(s.dlgDetalle.estadisticas.entrada?.total_viajes||0)),1),a[51]||(a[51]=l("div",{class:"text-caption"},"Viajes Realizados",-1))])]),_:1})]),_:1})]),l("div",Ie,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",Ke,[e(d,{name:"scale",color:"teal",size:"lg"}),l("div",Fe,r(m.formatNumber(s.dlgDetalle.estadisticas.entrada?.kg_transportados||0))+" kg ",1),a[52]||(a[52]=l("div",{class:"text-caption"},"Kg Transportados",-1))])]),_:1})]),_:1})]),l("div",Ge,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",Le,[e(d,{name:"place",color:"info",size:"lg"}),l("div",Oe,r(m.formatNumber(s.dlgDetalle.estadisticas.entrada?.distancia_total_km||0))+" km ",1),a[53]||(a[53]=l("div",{class:"text-caption"},"Distancia Total",-1))])]),_:1})]),_:1})]),l("div",Me,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",He,[e(d,{name:"people",color:"primary",size:"lg"}),l("div",Je,r(s.dlgDetalle.estadisticas.entrada?.productores_atendidos||0),1),a[54]||(a[54]=l("div",{class:"text-caption"},"Productores Atendidos",-1))])]),_:1})]),_:1})]),l("div",We,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",Xe,[e(d,{name:"verified",color:"positive",size:"lg"}),l("div",Ye,r((s.dlgDetalle.estadisticas.entrada?.porcentaje_cumplimiento||100).toFixed(1))+"%",1),a[55]||(a[55]=l("div",{class:"text-caption"},"Cumplimiento",-1))])]),_:1})]),_:1})]),l("div",Ze,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",$e,[e(d,{name:"speed",color:"orange",size:"lg"}),l("div",et,r(m.formatNumber(s.dlgDetalle.estadisticas.entrada?.kg_promedio||0))+" kg ",1),a[56]||(a[56]=l("div",{class:"text-caption"},"Promedio por Viaje",-1))])]),_:1})]),_:1})])])):y("",!0)]),_:1}),e(q,{name:"salida"},{default:t(()=>[s.dlgDetalle.estadisticas?(b(),V("div",tt,[l("div",at,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",lt,[e(d,{name:"local_shipping",color:"info",size:"lg"}),l("div",st,r(m.formatNumber(s.dlgDetalle.estadisticas.salida?.total_entregas||0)),1),a[57]||(a[57]=l("div",{class:"text-caption"},"Entregas Realizadas",-1))])]),_:1})]),_:1})]),l("div",ot,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",it,[e(d,{name:"scale",color:"teal",size:"lg"}),l("div",rt,r(m.formatNumber(s.dlgDetalle.estadisticas.salida?.kg_entregados||0))+" kg ",1),a[58]||(a[58]=l("div",{class:"text-caption"},"Kg Entregados",-1))])]),_:1})]),_:1})]),l("div",dt,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",nt,[e(d,{name:"payments",color:"positive",size:"lg"}),l("div",ut,"Bs. "+r(m.formatNumber(s.dlgDetalle.estadisticas.salida?.valor_total||0)),1),a[59]||(a[59]=l("div",{class:"text-caption"},"Valor Total",-1))])]),_:1})]),_:1})]),l("div",ct,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",mt,[e(d,{name:"business",color:"primary",size:"lg"}),l("div",_t,r(s.dlgDetalle.estadisticas.salida?.clientes_atendidos||0),1),a[60]||(a[60]=l("div",{class:"text-caption"},"Clientes Atendidos",-1))])]),_:1})]),_:1})]),l("div",pt,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",ft,[e(d,{name:"check_circle",color:"positive",size:"lg"}),l("div",gt,r(m.formatNumber(s.dlgDetalle.estadisticas.salida?.kg_promedio||0))+" kg ",1),a[61]||(a[61]=l("div",{class:"text-caption"},"Promedio por Entrega",-1))])]),_:1})]),_:1})]),l("div",vt,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",bt,[e(d,{name:"attach_money",color:"orange",size:"lg"}),l("div",xt,"Bs. "+r(m.formatNumber(s.dlgDetalle.estadisticas.salida?.valor_promedio||0)),1),a[62]||(a[62]=l("div",{class:"text-caption"},"Valor Promedio",-1))])]),_:1})]),_:1})])])):y("",!0)]),_:1}),e(q,{name:"alertas"},{default:t(()=>[s.dlgDetalle.estadisticas?(b(),V("div",ht,[l("div",yt,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",wt,[e(d,{name:"warning",color:(s.dlgDetalle.estadisticas.entrada?.alertas_temperatura||0)>0?"red":"positive",size:"xl"},null,8,["color"]),l("div",kt,r(s.dlgDetalle.estadisticas.entrada?.alertas_temperatura||0),1),a[63]||(a[63]=l("div",{class:"text-subtitle1"},"Alertas de Temperatura",-1)),a[64]||(a[64]=l("div",{class:"text-caption text-grey-7 q-mt-sm"}," Transportes que excedieron los l√≠mites de temperatura. ",-1))])]),_:1})]),_:1})]),l("div",Vt,[e(f,{flat:"",bordered:""},{default:t(()=>[e(_,null,{default:t(()=>[l("div",Dt,[e(d,{name:"schedule",color:(s.dlgDetalle.estadisticas.entrada?.alertas_tiempo||0)>0?"orange":"positive",size:"xl"},null,8,["color"]),l("div",Tt,r(s.dlgDetalle.estadisticas.entrada?.alertas_tiempo||0),1),a[65]||(a[65]=l("div",{class:"text-subtitle1"},"Alertas de Tiempo",-1)),a[66]||(a[66]=l("div",{class:"text-caption text-grey-7 q-mt-sm"}," Transportes que excedieron el tiempo m√°ximo de transporte ",-1))])]),_:1})]),_:1})]),l("div",qt,[(s.dlgDetalle.estadisticas.entrada?.alertas_temperatura||0)===0&&(s.dlgDetalle.estadisticas.entrada?.alertas_tiempo||0)===0?(b(),x(I,{key:0,class:"bg-positive text-white"},{avatar:t(()=>[e(d,{name:"check_circle",size:"lg"})]),default:t(()=>[a[67]||(a[67]=l("div",{class:"text-h6"},"Cumplimiento Total",-1)),a[68]||(a[68]=l("div",null,"Este transporte ha cumplido con todos los requisitos de transporte de materia prima.",-1))]),_:1})):(b(),x(I,{key:1,class:"bg-orange text-white"},{avatar:t(()=>[e(d,{name:"warning",size:"lg"})]),default:t(()=>[a[69]||(a[69]=l("div",{class:"text-h6"},"Atenci√≥n Requerida",-1)),a[70]||(a[70]=l("div",null,"Se han detectado alertas en el transporte. Revisar los registros para tomar acciones correctivas. ",-1))]),_:1}))])])):y("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})):y("",!0),e(h),e(S,{align:"right"},{default:t(()=>[U(e(w,{flat:"",label:"Cerrar",color:"primary"},null,512),[[K]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const $t=F(J,[["render",Ct],["__scopeId","data-v-cba1185f"]]);export{$t as default};
