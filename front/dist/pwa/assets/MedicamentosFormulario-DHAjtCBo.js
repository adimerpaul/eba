import{Q as D}from"./QSpace-CWkkK__K.js";import{_ as R,c as _,o as c,w as a,b as e,a as t,f,a9 as h,a8 as E,aa as U,ab as q,t as d,P as y,d as k,a7 as p,ac as I,h as M,Q as N,e as b,O as A,ag as u,a6 as O,ai as B}from"./index-BlKDBvQ5.js";import{Q as w,b as g}from"./position-engine-C6RYylQK.js";import{Q as T}from"./QList-CtW7EQxk.js";import{Q as P}from"./QBtnDropdown-XEBgpxW1.js";import{Q}from"./QChip-CsUcH7aQ.js";import{Q as $}from"./QMarkupTable-Dr0zNr-8.js";import{Q as S,a as x}from"./QSelect-CrufDZ1L.js";import{Q as j}from"./QForm-CPNmOC2s.js";import{C as v}from"./ClosePopup-jQ9viJ4_.js";import{R as Z,y as H,u as J,v as K,i as W,L as F,m as X,a as Y,b as ee}from"./marker-shadow-C5NkAB6O.js";import{Q as oe}from"./QBadge-DjxiqQnk.js";const te={name:"ProductorCertificaciones",props:{productor:{type:Object,required:!0}},emits:["updated"],data(){return{loading:!1,saving:!1,dlg:{open:!1},form:this.emptyForm(),tipoOptions:["ORGANICO","COMERCIO_JUSTO","DENOMINACION_ORIGEN","BUENAS_PRACTICAS"]}},methods:{emptyForm(){return{id:null,productor_id:this.productor?.id||null,tipo_certificacion:null,organismo_certificador:"",fecha_emision:null,fecha_vencimiento:null,certificado_url:"",estado:"VIGENTE"}},chip(l){return l==="VIGENTE"?"green":l==="VENCIDO"?"red":l==="SUSPENDIDO"?"orange":"grey"},shortUrl(l){try{return l&&l.length>40?l.slice(0,40)+"…":l||"-"}catch{return l||"-"}},startCreate(){this.form=this.emptyForm(),this.form.productor_id=this.productor?.id||null,this.dlg.open=!0},startEdit(l){this.form={id:l.id,productor_id:this.productor?.id||l.productor_id,tipo_certificacion:l.tipo_certificacion||null,organismo_certificador:l.organismo_certificador||"",fecha_emision:l.fecha_emision||null,fecha_vencimiento:l.fecha_vencimiento||null,certificado_url:l.certificado_url||"",estado:l.estado||"VIGENTE"},this.dlg.open=!0},async submit(){if(this.productor?.id){this.saving=!0;try{const l={...this.form,productor_id:this.productor.id};l.id?await this.$axios.put(`certificaciones/${l.id}`,l):await this.$axios.post("certificaciones",l),this.$alert?.success?.(l.id?"Certificación actualizada":"Certificación creada"),this.dlg.open=!1,this.$emit("updated")}catch(l){this.$alert?.error?.(l.response?.data?.message||"No se pudo guardar")}finally{this.saving=!1}}},remove(l){this.$alert?.dialog?.("¿Eliminar certificación?")?.onOk(async()=>{try{await this.$axios.delete(`certificaciones/${l.id}`),this.$alert?.success?.("Eliminado"),this.$emit("updated")}catch(o){this.$alert?.error?.(o.response?.data?.message||"No se pudo eliminar")}})},async printPdf(l){this.$axios.get(`certificaciones/${l.id}/print`,{responseType:"blob"}).then(o=>{let m=`certificacion_${l.id}.pdf`;const C=o.headers["content-disposition"];if(C){const s=C.match(/filename="?([^"]+)"?/i);s&&s[1]&&(m=s[1])}const i=new Blob([o.data],{type:"application/pdf"}),r=document.createElement("a");r.href=URL.createObjectURL(i),r.download=m,document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r)}).catch(o=>{this.$alert?.error?.(o.response?.data?.message||"No se pudo generar el PDF")})}}},le={class:"row items-center q-gutter-sm q-mb-sm"},ie=["href"],ae={key:1},se={key:0},ne={class:"text-h6"},re={class:"col-12 col-sm-4"},de={class:"col-12 col-sm-8"},ce={class:"col-6 col-sm-3"},ue={class:"col-6 col-sm-3"},me={class:"col-12 col-sm-3"},pe={class:"col-12"},_e={class:"col-12 text-right q-gutter-sm q-mt-sm"};function fe(l,o,m,C,i,r){return c(),_(b,null,{default:a(()=>[e("div",le,[o[7]||(o[7]=e("div",{class:"text-subtitle1"},"Certificaciones",-1)),t(D),t(f,{dense:"",color:"primary",icon:"add_circle",label:"Nueva",onClick:r.startCreate,disable:i.saving,"no-caps":""},null,8,["onClick","disable"])]),t($,{dense:""},{default:a(()=>[o[12]||(o[12]=e("thead",null,[e("tr",{class:"bg-grey-3"},[e("th",{class:"text-left"},"#"),e("th",{class:"text-left",style:{width:"120px"}},"Opciones"),e("th",{class:"text-left"},"Tipo"),e("th",{class:"text-left"},"Organismo"),e("th",{class:"text-left"},"Emisión"),e("th",{class:"text-left"},"Vencimiento"),e("th",{class:"text-left"},"Estado"),e("th",{class:"text-left"},"URL")])],-1)),e("tbody",null,[(c(!0),h(U,null,q(m.productor?.certificaciones||[],(s,n)=>(c(),h("tr",{key:s.id||n},[e("td",null,d(n+1),1),e("td",null,[t(P,{dense:"",label:"Opciones",color:"primary","no-caps":"",size:"10px"},{default:a(()=>[t(T,null,{default:a(()=>[y((c(),_(w,{clickable:"",onClick:z=>r.startEdit(s)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"edit"})]),_:1}),t(g,null,{default:a(()=>o[8]||(o[8]=[p("Editar")])),_:1})]),_:2},1032,["onClick"])),[[I],[v]]),y((c(),_(w,{clickable:"",onClick:z=>r.remove(s)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"delete",class:"text-negative"})]),_:1}),t(g,{class:"text-negative"},{default:a(()=>o[9]||(o[9]=[p("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[I],[v]]),y((c(),_(w,{clickable:"",onClick:z=>r.printPdf(s)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"picture_as_pdf"})]),_:1}),t(g,null,{default:a(()=>o[10]||(o[10]=[p("Imprimir")])),_:1})]),_:2},1032,["onClick"])),[[I],[v]])]),_:2},1024)]),_:2},1024)]),e("td",null,d(s.tipo_certificacion||"-"),1),e("td",null,d(s.organismo_certificador||"-"),1),e("td",null,d(s.fecha_emision||"-"),1),e("td",null,d(s.fecha_vencimiento||"-"),1),e("td",null,[t(Q,{color:r.chip(s.estado),"text-color":"white",size:"xs",class:"text-bold"},{default:a(()=>[p(d(s.estado),1)]),_:2},1032,["color"])]),e("td",null,[s.certificado_url?(c(),h("a",{key:0,href:s.certificado_url,target:"_blank"},d(r.shortUrl(s.certificado_url)),9,ie)):(c(),h("span",ae,"-"))])]))),128)),!i.loading&&(m.productor?.certificaciones?.length||0)===0?(c(),h("tr",se,o[11]||(o[11]=[e("td",{colspan:"8",class:"text-center text-grey"},"Sin registros",-1)]))):E("",!0)])]),_:1}),t(M,{modelValue:i.dlg.open,"onUpdate:modelValue":o[6]||(o[6]=s=>i.dlg.open=s),persistent:""},{default:a(()=>[t(N,{style:{"min-width":"720px","max-width":"95vw"}},{default:a(()=>[t(b,{class:"row items-center q-gutter-sm"},{default:a(()=>[e("div",ne,d(i.form.id?"Editar certificación":"Nueva certificación"),1),t(D),y(t(f,{flat:"",round:"",dense:"",icon:"close"},null,512),[[v]])]),_:1}),t(A),t(b,null,{default:a(()=>[t(j,{onSubmit:r.submit,class:"row q-col-gutter-sm"},{default:a(()=>[e("div",re,[t(S,{modelValue:i.form.tipo_certificacion,"onUpdate:modelValue":o[0]||(o[0]=s=>i.form.tipo_certificacion=s),options:i.tipoOptions,dense:"",outlined:"",label:"Tipo",rules:[s=>!!s||"Requerido"]},null,8,["modelValue","options","rules"])]),e("div",de,[t(u,{modelValue:i.form.organismo_certificador,"onUpdate:modelValue":o[1]||(o[1]=s=>i.form.organismo_certificador=s),dense:"",outlined:"",label:"Organismo certificador"},null,8,["modelValue"])]),e("div",ce,[t(u,{modelValue:i.form.fecha_emision,"onUpdate:modelValue":o[2]||(o[2]=s=>i.form.fecha_emision=s),type:"date",dense:"",outlined:"",label:"Emisión"},null,8,["modelValue"])]),e("div",ue,[t(u,{modelValue:i.form.fecha_vencimiento,"onUpdate:modelValue":o[3]||(o[3]=s=>i.form.fecha_vencimiento=s),type:"date",dense:"",outlined:"",label:"Vencimiento"},null,8,["modelValue"])]),e("div",me,[t(S,{modelValue:i.form.estado,"onUpdate:modelValue":o[4]||(o[4]=s=>i.form.estado=s),options:["VIGENTE","VENCIDO","SUSPENDIDO"],dense:"",outlined:"",label:"Estado"},null,8,["modelValue"])]),e("div",pe,[t(u,{modelValue:i.form.certificado_url,"onUpdate:modelValue":o[5]||(o[5]=s=>i.form.certificado_url=s),dense:"",outlined:"",label:"URL certificado (opcional)"},null,8,["modelValue"])]),e("div",_e,[y(t(f,{flat:"",color:"grey",label:"Cancelar",disable:i.saving},null,8,["disable"]),[[v]]),t(f,{color:"primary",label:i.form.id?"Guardar cambios":"Crear",type:"submit",loading:i.saving},null,8,["label","loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const kl=R(te,[["render",fe]]);delete F.Icon.Default.prototype._getIconUrl;F.Icon.Default.mergeOptions({iconRetinaUrl:ee,iconUrl:Y,shadowUrl:X});const he={name:"ApiarioMap",components:{LMap:W,LTileLayer:K,LMarker:J,LPopup:H,LControlLayers:Z},props:{modelValue:{type:Object,default:()=>({latitud:null,longitud:null})},center:{type:Array,default:()=>[-16.5,-68.15]},zoomInit:{type:Number,default:14}},emits:["update:modelValue"],data(){return{zoom:this.zoomInit,local:{...this.modelValue},mapOptions:{zoomControl:!0,attributionControl:!1,zoomAnimation:!1,fadeAnimation:!1,markerZoomAnimation:!1}}},computed:{hasLatLng(){const{latitud:l,longitud:o}=this.local;return l!=null&&o!=null&&isFinite(l)&&isFinite(o)},mapCenter(){return this.hasLatLng?[Number(this.local.latitud),Number(this.local.longitud)]:this.center},mapObj(){return this.$refs.map?.leafletObject||null}},watch:{modelValue:{deep:!0,handler(l){l&&(l.latitud!==this.local.latitud||l.longitud!==this.local.longitud)&&(this.local={...l},this.$nextTick(()=>this.refresh()))}},local:{deep:!0,handler(l){const o={...this.modelValue,latitud:l.latitud??null,longitud:l.longitud??null};this.$emit("update:modelValue",o)}}},mounted(){this.$nextTick(()=>this.refresh())},methods:{fix(l){const o=Number(l);return isFinite(o)?o.toFixed(6):"-"},refresh(){const l=this.mapObj;l&&setTimeout(()=>{l.invalidateSize(),this.hasLatLng&&l.setView([Number(this.local.latitud),Number(this.local.longitud)],Math.max(l.getZoom()||this.zoom,15),{animate:!1})},60)},onMapClick(l){const{lat:o,lng:m}=l.latlng||{};o==null||m==null||(this.local.latitud=Number(o.toFixed(7)),this.local.longitud=Number(m.toFixed(7)),this.flyToLatLng())},onDragEnd(l){const o=l?.target?.getLatLng?.();o&&(this.local.latitud=Number(o.lat.toFixed(7)),this.local.longitud=Number(o.lng.toFixed(7)),this.flyToLatLng())},flyToLatLng(){const l=this.mapObj;!l||!this.hasLatLng||l.setView([Number(this.local.latitud),Number(this.local.longitud)],Math.max(l.getZoom()||this.zoom,16),{animate:!1})},locateMe(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(l=>{this.local.latitud=Number(l.coords.latitude.toFixed(7)),this.local.longitud=Number(l.coords.longitude.toFixed(7)),this.$nextTick(()=>this.flyToLatLng())})}}},ge={class:"map-wrapper"},be={class:"row items-center q-col-gutter-sm q-mb-sm"},ye={class:"col-6 col-sm-3"},ve={class:"col-6 col-sm-3"},xe={class:"col-6 col-sm-3"},Ce={class:"col-6 col-sm-3"};function Ae(l,o,m,C,i,r){const s=O("l-control-layers"),n=O("l-tile-layer"),z=O("l-popup"),L=O("l-marker"),G=O("l-map");return c(),h("div",ge,[e("div",be,[e("div",ye,[t(u,{modelValue:i.local.latitud,"onUpdate:modelValue":o[0]||(o[0]=V=>i.local.latitud=V),modelModifiers:{number:!0},dense:"",outlined:"",label:"Latitud"},null,8,["modelValue"])]),e("div",ve,[t(u,{modelValue:i.local.longitud,"onUpdate:modelValue":o[1]||(o[1]=V=>i.local.longitud=V),modelModifiers:{number:!0},dense:"",outlined:"",label:"Longitud"},null,8,["modelValue"])]),e("div",xe,[t(f,{dense:"","no-caps":"",color:"primary",icon:"place",label:"Ir a lat/lng",onClick:r.flyToLatLng,style:{width:"100%"}},null,8,["onClick"])]),e("div",Ce,[t(f,{dense:"","no-caps":"",color:"secondary",icon:"my_location",label:"Mi ubicación",onClick:r.locateMe,style:{width:"100%"}},null,8,["onClick"])])]),t(G,{ref:"map",zoom:i.zoom,center:r.mapCenter,options:i.mapOptions,style:{height:"360px","border-radius":"8px",overflow:"hidden"},onClick:r.onMapClick},{default:a(()=>[t(s,{position:"topright"}),t(n,{"layer-type":"base",name:"OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png","max-zoom":19,visible:!0}),t(n,{"layer-type":"base",name:"Google Calle",url:"https://mt1.google.com/vt/lyrs=r&x={x}&y={y}&z={z}","max-zoom":21,visible:!1}),t(n,{"layer-type":"base",name:"Google Satélite",url:"https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}","max-zoom":21,visible:!1}),t(n,{"layer-type":"base",name:"Google Híbrido",url:"https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}","max-zoom":21,visible:!1}),r.hasLatLng?(c(),_(L,{key:0,"lat-lng":[Number(i.local.latitud),Number(i.local.longitud)],draggable:!0,onDragend:r.onDragEnd},{default:a(()=>[t(z,null,{default:a(()=>[e("div",null,[p("Lat: "+d(r.fix(i.local.latitud)),1),o[2]||(o[2]=e("br",null,null,-1)),p("Lng: "+d(r.fix(i.local.longitud)),1)])]),_:1})]),_:1},8,["lat-lng","onDragend"])):E("",!0)]),_:1},8,["zoom","center","options","onClick"])])}const Ve=R(he,[["render",Ae],["__scopeId","data-v-ec3083c5"]]),ke={name:"ProductorApiarios",components:{ApiarioMap:Ve},props:{productor:{type:Object,required:!0}},emits:["updated"],data(){return{loading:!1,saving:!1,list:[],dlgApiario:{open:!1},formApiario:this.emptyApiario(),dlgColmena:{open:!1},currentApiario:null,colmenas:[],colLoading:!1,formColmena:this.emptyColmena(),tipoMielOptions:[]}},computed:{totalColmenas(){return this.list.reduce((l,o)=>l+(o.numero_colmenas_prod||0),0)},totalCosechas(){return this.list.reduce((l,o)=>l+(o.cosechas_total||0),0)},totalCapacidad(){return this.list.reduce((l,o)=>l+(o.capacidad_productiva||0),0)},rendimientoPromedio(){const l=this.list.reduce((m,C)=>m+(C.total_kg_historico||0),0),o=this.totalColmenas;return o>0?(l/o).toFixed(2):"0.00"}},mounted(){this.hydrateFromProductor()},watch:{productor(){this.hydrateFromProductor()}},methods:{hydrateFromProductor(){this.fetchApiarios()},async fetchApiarios(){this.loading=!0;try{const{data:l}=await this.$axios.get("apiarios",{params:{productor_id:this.productor.id,paginate:!1}});this.list=Array.isArray(l)?l:l?.data||[]}catch(l){this.list=[],this.$alert?.error?.(l.response?.data?.message||"No se pudo cargar apiarios")}finally{this.loading=!1}},emptyApiario(){return{id:null,productor_id:this.productor?.id||null,municipio_id:null,nombre_cip:"",latitud:null,longitud:null,altitud:null,lugar_apiario:"",numero_colmenas_runsa:null,numero_colmenas_prod:0,seleccion:0,rend_programa_nal:0,organizacion_id:0,fecha_instalacion:null,estado:"ACTIVO",fase:"",coordenada:""}},startCreate(){this.formApiario=this.emptyApiario(),this.dlgApiario.open=!0},startEdit(l){this.formApiario={...this.emptyApiario(),...l,productor_id:this.productor?.id||l.productor_id},this.dlgApiario.open=!0},onApiarioDialogShow(){this.$nextTick(()=>this.$refs.apiarioMap?.refresh())},async saveApiario(){this.saving=!0;try{const l={...this.formApiario,productor_id:this.productor.id};l.id?await this.$axios.put(`apiarios/${l.id}`,l):await this.$axios.post("apiarios",l),this.$alert?.success?.(l.id?"Apiario actualizado":"Apiario creado"),this.dlgApiario.open=!1,this.$emit("updated"),await this.fetchApiarios()}catch(l){this.$alert?.error?.(l.response?.data?.message||"No se pudo guardar apiario")}finally{this.saving=!1}},emptyColmena(){return{id:null,apiario_id:null,tipo_miel_id:null,codigo_colmena:"",tipo_colmena:"",fecha_instalacion:null,reina_fecha_nacimiento:null,reina_procedencia:"",estado:"ACTIVA"}},async openColmenas(l){this.currentApiario=l,this.dlgColmena.open=!0,await this.fetchTipoMiel(),await this.fetchColmenas()},async removeApiario(l){this.$alert?.dialog?.("¿Eliminar apiario?")?.onOk(async()=>{try{await this.$axios.delete(`apiarios/${l.id}`),this.$alert?.success?.("Apiario eliminado"),await this.fetchApiarios()}catch(o){this.$alert?.error?.(o.response?.data?.message||"No se pudo eliminar apiario")}})},async fetchTipoMiel(){try{const{data:l}=await this.$axios.get("tipo-miel");this.tipoMielOptions=Array.isArray(l)?l:l?.data||[]}catch{this.tipoMielOptions=[]}},async fetchColmenas(){if(this.currentApiario?.id){this.colLoading=!0;try{const{data:l}=await this.$axios.get("colmenas",{params:{apiario_id:this.currentApiario.id,paginate:!1}});this.colmenas=Array.isArray(l)?l:l?.data||[]}catch(l){this.colmenas=[],this.$alert?.error?.(l.response?.data?.message||"No se pudieron cargar colmenas")}finally{this.colLoading=!1}}},startCreateColmena(){this.formColmena=this.emptyColmena(),this.formColmena.apiario_id=this.currentApiario?.id||null},startEditColmena(l){this.formColmena={...this.emptyColmena(),...l,apiario_id:this.currentApiario?.id||l.apiario_id}},resetColmena(){this.startCreateColmena()},async saveColmena(){this.saving=!0;try{const l={...this.formColmena,apiario_id:this.currentApiario.id};l.id?await this.$axios.put(`colmenas/${l.id}`,l):await this.$axios.post("colmenas",l),this.$alert?.success?.(l.id?"Colmena actualizada":"Colmena creada"),await this.fetchColmenas(),this.$emit("updated")}catch(l){this.$alert?.error?.(l.response?.data?.message||"No se pudo guardar colmena")}finally{this.saving=!1}},removeColmena(l){this.$alert?.dialog?.("¿Eliminar colmena?")?.onOk(async()=>{try{await this.$axios.delete(`colmenas/${l.id}`),this.$alert?.success?.("Eliminado"),await this.fetchColmenas(),this.$emit("updated")}catch(o){this.$alert?.error?.(o.response?.data?.message||"No se pudo eliminar")}})}}},we={class:"row items-center q-gutter-sm q-mb-sm"},Ne={key:0},Ee={key:1},ze={class:"text-center"},Oe={class:"text-center"},Ie={key:0,class:"text-bold text-blue-8"},Le={key:1,class:"text-grey-6"},Ue={class:"text-center"},qe={class:"text-center"},Re={class:"text-bold text-orange-8"},Me={key:0},Te={key:0,class:"row q-mt-md q-gutter-md"},Pe={class:"text-h6 text-primary"},$e={class:"text-h6 text-green"},De={class:"text-h6 text-orange-8"},Se={class:"text-h6 text-blue-8"},Fe={class:"text-h6"},Qe={class:"col-12 col-sm-4"},Ge={class:"col-12 col-sm-8"},je={class:"col-6 col-sm-2"},Be={class:"col-6 col-sm-2"},Ze={class:"col-12 col-sm-2"},He={class:"col-12"},Je={class:"col-6 col-sm-3"},Ke={class:"col-6 col-sm-3"},We={class:"col-6 col-sm-3"},Xe={class:"col-6 col-sm-3"},Ye={class:"col-12 text-right q-gutter-sm q-mt-sm"},eo={class:"text-h6"},oo={key:0},to={class:"text-subtitle2 q-mb-sm"},lo={class:"col-12 col-sm-3"},io={class:"col-12 col-sm-3"},ao={class:"col-12 col-sm-3"},so={class:"col-12 col-sm-3"},no={class:"col-12 col-sm-4"},ro={class:"col-12 col-sm-4"},co={class:"col-12 col-sm-4"},uo={class:"col-12 text-right q-gutter-sm"};function mo(l,o,m,C,i,r){const s=O("ApiarioMap");return c(),_(b,null,{default:a(()=>[e("div",we,[o[19]||(o[19]=e("div",{class:"text-subtitle1"},"Apiarios",-1)),t(D),t(f,{dense:"",color:"primary",icon:"add_circle",label:"Nuevo","no-caps":"",onClick:r.startCreate,disable:i.saving},null,8,["onClick","disable"])]),t($,{dense:""},{default:a(()=>[o[24]||(o[24]=e("thead",null,[e("tr",{class:"bg-grey-3"},[e("th",{class:"text-left"},"#"),e("th",{class:"text-left"},"Opciones"),e("th",{class:"text-left"},"Nombre/CIP"),e("th",{class:"text-left"},"Departamento"),e("th",{class:"text-left"},"Municipio"),e("th",{class:"text-left"},"Comunidad"),e("th",{class:"text-left"},"Asociación"),e("th",{class:"text-left"},"Ubicación"),e("th",{class:"text-center"},[p("Nro."),e("br"),p("Colmenas")]),e("th",{class:"text-center"},[p("Rendimiento"),e("br"),p("Colmenas")]),e("th",{class:"text-center"},[p("Cosechas"),e("br"),p("Total")]),e("th",{class:"text-center"},[p("Capacidad"),e("br"),p("Productiva")])])],-1)),e("tbody",null,[(c(!0),h(U,null,q(i.list,(n,z)=>(c(),h("tr",{key:n.id},[e("td",null,d(z+1),1),e("td",null,[t(P,{dense:"",label:"Opciones","no-caps":"",color:"primary",size:"10px"},{default:a(()=>[t(T,null,{default:a(()=>[y((c(),_(w,{clickable:"",onClick:L=>r.startEdit(n)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"edit"})]),_:1}),t(g,null,{default:a(()=>o[20]||(o[20]=[p("Editar")])),_:1})]),_:2},1032,["onClick"])),[[v]]),y((c(),_(w,{clickable:"",onClick:L=>r.openColmenas(n)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"hive"})]),_:1}),t(g,null,{default:a(()=>o[21]||(o[21]=[p("Colmenas")])),_:1})]),_:2},1032,["onClick"])),[[v]]),y((c(),_(w,{clickable:"",onClick:L=>r.removeApiario(n)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{class:"text-negative",name:"delete"})]),_:1}),t(g,{class:"text-negative"},{default:a(()=>o[22]||(o[22]=[p("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[v]])]),_:2},1024)]),_:2},1024)]),e("td",null,d(n.nombre_cip||"-"),1),e("td",null,d(n.municipio?.departamento?.nombre_departamento||"-"),1),e("td",null,d(n.municipio?.nombre_municipio||"-"),1),e("td",null,d(n.productor?.comunidad||"-"),1),e("td",null,d(n.productor?.organizacion?.asociacion||"-"),1),e("td",null,[n.latitud&&n.longitud?(c(),h("span",Ne,d(n.latitud.toFixed?n.latitud.toFixed(6):n.latitud)+", "+d(n.longitud.toFixed?n.longitud.toFixed(6):n.longitud),1)):(c(),h("span",Ee,"-"))]),e("td",ze,[t(Q,{color:"primary","text-color":"white",size:"sm"},{default:a(()=>[p(d(n.numero_colmenas_prod||0),1)]),_:2},1024)]),e("td",Oe,[n.rendimiento_colmenas>0?(c(),h("span",Ie,d(n.rendimiento_colmenas)+" kg/col ",1)):(c(),h("span",Le,"-"))]),e("td",Ue,[t(Q,{color:n.cosechas_total>0?"green":"grey","text-color":"white",size:"sm"},{default:a(()=>[p(d(n.cosechas_total||0),1)]),_:2},1032,["color"])]),e("td",qe,[e("span",Re,d(n.capacidad_productiva||0)+" kg ",1)])]))),128)),!i.loading&&i.list.length===0?(c(),h("tr",Me,o[23]||(o[23]=[e("td",{colspan:"12",class:"text-center text-grey"},"Sin registros",-1)]))):E("",!0)])]),_:1}),i.list.length>0?(c(),h("div",Te,[t(N,{flat:"",bordered:"",class:"col"},{default:a(()=>[t(b,{class:"text-center"},{default:a(()=>[o[25]||(o[25]=e("div",{class:"text-caption text-grey-6"},"Total Colmenas",-1)),e("div",Pe,d(r.totalColmenas),1)]),_:1})]),_:1}),t(N,{flat:"",bordered:"",class:"col"},{default:a(()=>[t(b,{class:"text-center"},{default:a(()=>[o[26]||(o[26]=e("div",{class:"text-caption text-grey-6"},"Total Cosechas",-1)),e("div",$e,d(r.totalCosechas),1)]),_:1})]),_:1}),t(N,{flat:"",bordered:"",class:"col"},{default:a(()=>[t(b,{class:"text-center"},{default:a(()=>[o[27]||(o[27]=e("div",{class:"text-caption text-grey-6"},"Capacidad Total",-1)),e("div",De,d(r.totalCapacidad)+" kg",1)]),_:1})]),_:1}),t(N,{flat:"",bordered:"",class:"col"},{default:a(()=>[t(b,{class:"text-center"},{default:a(()=>[o[28]||(o[28]=e("div",{class:"text-caption text-grey-6"},"Rendimiento Promedio",-1)),e("div",Se,d(r.rendimientoPromedio)+" kg/col",1)]),_:1})]),_:1})])):E("",!0),t(M,{modelValue:i.dlgApiario.open,"onUpdate:modelValue":o[10]||(o[10]=n=>i.dlgApiario.open=n),persistent:"","transition-show":"none","transition-hide":"none",onShow:r.onApiarioDialogShow},{default:a(()=>[t(N,{style:{"min-width":"900px","max-width":"95vw"}},{default:a(()=>[t(b,{class:"row items-center q-gutter-sm"},{default:a(()=>[e("div",Fe,d(i.formApiario.id?"Editar apiario":"Nuevo apiario"),1),t(D),y(t(f,{flat:"",round:"",dense:"",icon:"close"},null,512),[[v]])]),_:1}),t(A),t(b,null,{default:a(()=>[t(j,{onSubmit:r.saveApiario,class:"row q-col-gutter-sm"},{default:a(()=>[e("div",Qe,[t(u,{modelValue:i.formApiario.nombre_cip,"onUpdate:modelValue":o[0]||(o[0]=n=>i.formApiario.nombre_cip=n),label:"Nombre / CIP",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Ge,[t(u,{modelValue:i.formApiario.lugar_apiario,"onUpdate:modelValue":o[1]||(o[1]=n=>i.formApiario.lugar_apiario=n),label:"Lugar del apiario",dense:"",outlined:""},null,8,["modelValue"])]),e("div",je,[t(u,{modelValue:i.formApiario.altitud,"onUpdate:modelValue":o[2]||(o[2]=n=>i.formApiario.altitud=n),modelModifiers:{number:!0},label:"Altitud (msnm)",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Be,[t(u,{modelValue:i.formApiario.fecha_instalacion,"onUpdate:modelValue":o[3]||(o[3]=n=>i.formApiario.fecha_instalacion=n),type:"date",label:"Instalación",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Ze,[t(S,{modelValue:i.formApiario.estado,"onUpdate:modelValue":o[4]||(o[4]=n=>i.formApiario.estado=n),options:["ACTIVO","INACTIVO"],label:"Estado",dense:"",outlined:""},null,8,["modelValue"])]),e("div",He,[t(s,{ref:"apiarioMap",modelValue:i.formApiario,"onUpdate:modelValue":o[5]||(o[5]=n=>i.formApiario=n),center:[-16.5,-68.15],"zoom-init":14},null,8,["modelValue"])]),e("div",Je,[t(u,{modelValue:i.formApiario.numero_colmenas_runsa,"onUpdate:modelValue":o[6]||(o[6]=n=>i.formApiario.numero_colmenas_runsa=n),modelModifiers:{number:!0},type:"number",label:"Colmenas RUNSA",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Ke,[t(u,{modelValue:i.formApiario.numero_colmenas_prod,"onUpdate:modelValue":o[7]||(o[7]=n=>i.formApiario.numero_colmenas_prod=n),modelModifiers:{number:!0},type:"number",label:"Colmenas PROD.",dense:"",outlined:""},null,8,["modelValue"])]),e("div",We,[t(u,{modelValue:i.formApiario.rend_programa_nal,"onUpdate:modelValue":o[8]||(o[8]=n=>i.formApiario.rend_programa_nal=n),modelModifiers:{number:!0},type:"number",step:"0.01",label:"Rend. prog. nal",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Xe,[t(u,{modelValue:i.formApiario.seleccion,"onUpdate:modelValue":o[9]||(o[9]=n=>i.formApiario.seleccion=n),modelModifiers:{number:!0},type:"number",label:"Selección",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Ye,[y(t(f,{flat:"",color:"grey",label:"Cancelar",disable:i.saving},null,8,["disable"]),[[v]]),t(f,{color:"primary",label:i.formApiario.id?"Guardar cambios":"Crear",type:"submit",loading:i.saving},null,8,["label","loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue","onShow"]),t(M,{modelValue:i.dlgColmena.open,"onUpdate:modelValue":o[18]||(o[18]=n=>i.dlgColmena.open=n),persistent:"","transition-show":"none","transition-hide":"none"},{default:a(()=>[t(N,{style:{"min-width":"900px","max-width":"95vw"}},{default:a(()=>[t(b,{class:"row items-center q-gutter-sm"},{default:a(()=>[e("div",eo,"Colmenas — "+d(i.currentApiario?.nombre_cip||"Apiario #"+i.currentApiario?.id),1),t(D),t(f,{dense:"",color:"primary",icon:"add_circle",label:"Nueva colmena","no-caps":"",onClick:r.startCreateColmena},null,8,["onClick"]),y(t(f,{flat:"",round:"",dense:"",icon:"close"},null,512),[[v]])]),_:1}),t(A),t(b,null,{default:a(()=>[t($,{dense:""},{default:a(()=>[o[32]||(o[32]=e("thead",null,[e("tr",{class:"bg-grey-3"},[e("th",null,"#"),e("th",null,"Opc."),e("th",null,"Código"),e("th",null,"Tipo"),e("th",null,"Tipo miel"),e("th",null,"Instalación"),e("th",null,"Reina nacimiento"),e("th",null,"Estado")])],-1)),e("tbody",null,[(c(!0),h(U,null,q(i.colmenas,(n,z)=>(c(),h("tr",{key:n.id||z},[e("td",null,d(z+1),1),e("td",null,[t(P,{dense:"","no-caps":"",size:"10px",label:"Opciones",color:"primary"},{default:a(()=>[t(T,null,{default:a(()=>[y((c(),_(w,{clickable:"",onClick:L=>r.startEditColmena(n)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"edit"})]),_:1}),t(g,null,{default:a(()=>o[29]||(o[29]=[p("Editar")])),_:1})]),_:2},1032,["onClick"])),[[v]]),y((c(),_(w,{clickable:"",onClick:L=>r.removeColmena(n)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{class:"text-negative",name:"delete"})]),_:1}),t(g,{class:"text-negative"},{default:a(()=>o[30]||(o[30]=[p("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[v]])]),_:2},1024)]),_:2},1024)]),e("td",null,d(n.codigo_colmena||"-"),1),e("td",null,d(n.tipo_colmena||"-"),1),e("td",null,d(n.tipo_miel?.tipo_miel||n.tipoMiel?.tipo_miel||"-"),1),e("td",null,d(n.fecha_instalacion||"-"),1),e("td",null,d(n.reina_fecha_nacimiento||"-"),1),e("td",null,[t(Q,{color:n.estado==="ACTIVA"?"green":"grey","text-color":"white",size:"xs"},{default:a(()=>[p(d(n.estado),1)]),_:2},1032,["color"])])]))),128)),!i.colLoading&&i.colmenas.length===0?(c(),h("tr",oo,o[31]||(o[31]=[e("td",{colspan:"8",class:"text-center text-grey"},"Sin colmenas",-1)]))):E("",!0)])]),_:1}),t(A,{class:"q-my-md"}),e("div",to,d(i.formColmena.id?"Editar colmena":"Nueva colmena"),1),t(j,{onSubmit:r.saveColmena,class:"row q-col-gutter-sm"},{default:a(()=>[e("div",lo,[t(u,{modelValue:i.formColmena.codigo_colmena,"onUpdate:modelValue":o[11]||(o[11]=n=>i.formColmena.codigo_colmena=n),dense:"",outlined:"",label:"Código"},null,8,["modelValue"])]),e("div",io,[t(u,{modelValue:i.formColmena.tipo_colmena,"onUpdate:modelValue":o[12]||(o[12]=n=>i.formColmena.tipo_colmena=n),dense:"",outlined:"",label:"Tipo colmena"},null,8,["modelValue"])]),e("div",ao,[t(S,{modelValue:i.formColmena.tipo_miel_id,"onUpdate:modelValue":o[13]||(o[13]=n=>i.formColmena.tipo_miel_id=n),options:i.tipoMielOptions,"option-value":"id","option-label":"tipo_miel","emit-value":"","map-options":"",dense:"",outlined:"",label:"Tipo de miel"},null,8,["modelValue","options"])]),e("div",so,[t(u,{modelValue:i.formColmena.fecha_instalacion,"onUpdate:modelValue":o[14]||(o[14]=n=>i.formColmena.fecha_instalacion=n),type:"date",dense:"",outlined:"",label:"Instalación"},null,8,["modelValue"])]),e("div",no,[t(u,{modelValue:i.formColmena.reina_fecha_nacimiento,"onUpdate:modelValue":o[15]||(o[15]=n=>i.formColmena.reina_fecha_nacimiento=n),type:"date",dense:"",outlined:"",label:"Reina: nacimiento"},null,8,["modelValue"])]),e("div",ro,[t(u,{modelValue:i.formColmena.reina_procedencia,"onUpdate:modelValue":o[16]||(o[16]=n=>i.formColmena.reina_procedencia=n),dense:"",outlined:"",label:"Reina: procedencia"},null,8,["modelValue"])]),e("div",co,[t(S,{modelValue:i.formColmena.estado,"onUpdate:modelValue":o[17]||(o[17]=n=>i.formColmena.estado=n),options:["ACTIVA","INACTIVA"],dense:"",outlined:"",label:"Estado"},null,8,["modelValue"])]),e("div",uo,[t(f,{flat:"",color:"grey",label:"Limpiar",onClick:r.resetColmena,disable:i.saving},null,8,["onClick","disable"]),t(f,{color:"primary",label:i.formColmena.id?"Guardar cambios":"Agregar colmena",type:"submit",loading:i.saving},null,8,["label","loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const wl=R(ke,[["render",mo],["__scopeId","data-v-e4db6965"]]);delete F.Icon.Default.prototype._getIconUrl;F.Icon.Default.mergeOptions({iconRetinaUrl:ee,iconUrl:Y,shadowUrl:X});const po={name:"ProductorMapa",components:{LMap:W,LTileLayer:K,LMarker:J,LPopup:H,LControlLayers:Z},props:{productor:{type:Object,required:!0},defaultCenter:{type:Array,default:()=>[-16.29,-63.59]},defaultZoom:{type:Number,default:6}},data(){return{zoom:this.defaultZoom,initialCenter:this.defaultCenter,mapOptions:{zoomControl:!0,attributionControl:!1,zoomAnimation:!1,fadeAnimation:!1,markerZoomAnimation:!1}}},computed:{mapObj(){return this.$refs.map?.leafletObject||null},apiariosConLatLng(){return(Array.isArray(this.productor?.apiarios)?this.productor.apiarios:[]).map(o=>{const m=Number(o.latitud),C=Number(o.longitud);return isFinite(m)&&isFinite(C)?{...o,lat:m,lng:C}:null}).filter(Boolean)}},watch:{productor:{deep:!0,handler(){this.$nextTick(()=>this.fitToMarkers())}}},mounted(){this.$nextTick(()=>this.fitToMarkers())},methods:{refresh(){const l=this.mapObj;l&&setTimeout(()=>{l.invalidateSize(),this.fitToMarkers(!0)},60)},fitToMarkers(l=!1){const o=this.mapObj;if(!o)return;const m=this.apiariosConLatLng.map(i=>[i.lat,i.lng]);if(m.length===0){o.setView(this.defaultCenter,this.defaultZoom,{animate:!1});return}if(m.length===1){const i=l?o.getZoom()||this.defaultZoom:Math.max(o.getZoom()||this.defaultZoom,15);o.setView(m[0],i,{animate:!1});return}const C=F.latLngBounds(m);o.fitBounds(C.pad(.2),{animate:!1})}}},_o={style:{height:"580px","border-radius":"8px",overflow:"hidden"}},fo={style:{"min-width":"180px"}},ho={class:"text-bold"},go={class:"text-grey-7",style:{"font-size":"12px"}},bo={key:0,class:"q-mt-xs"};function yo(l,o,m,C,i,r){const s=O("l-control-layers"),n=O("l-tile-layer"),z=O("l-popup"),L=O("l-marker"),G=O("l-map");return c(),_(b,{class:"q-pa-none"},{default:a(()=>[e("div",_o,[t(G,{ref:"map",zoom:i.zoom,center:i.initialCenter,options:i.mapOptions,style:{height:"100%",width:"100%"}},{default:a(()=>[t(s,{position:"topright"}),t(n,{"layer-type":"base",name:"OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png","max-zoom":19,visible:!1}),t(n,{"layer-type":"base",name:"Google Calle",url:"https://mt1.google.com/vt/lyrs=r&x={x}&y={y}&z={z}","max-zoom":21,visible:!1}),t(n,{"layer-type":"base",name:"Google Satélite",url:"https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}","max-zoom":21,visible:!1}),t(n,{"layer-type":"base",name:"Google Híbrido",url:"https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}","max-zoom":21,visible:!0}),(c(!0),h(U,null,q(r.apiariosConLatLng,V=>(c(),_(L,{key:V.id,"lat-lng":[V.lat,V.lng]},{default:a(()=>[t(z,null,{default:a(()=>[e("div",fo,[e("div",ho,d(V.nombre_cip||"Apiario #"+V.id),1),e("div",null,d(V.lugar_apiario||"-"),1),e("div",go,[p(" Lat: "+d(V.lat.toFixed(6)),1),o[0]||(o[0]=e("br",null,null,-1)),p(" Lng: "+d(V.lng.toFixed(6)),1)]),V.estado?(c(),h("div",bo,[o[1]||(o[1]=p(" Estado: ")),t(oe,{color:V.estado==="ACTIVO"?"green":"grey","text-color":"white",rounded:""},{default:a(()=>[p(d(V.estado),1)]),_:2},1032,["color"])])):E("",!0)])]),_:2},1024)]),_:2},1032,["lat-lng"]))),128))]),_:1},8,["zoom","center","options"])])]),_:1})}const Nl=R(po,[["render",yo],["__scopeId","data-v-2167aab4"]]),vo={name:"PlagasFormulario",props:{cosecha:{type:Object,required:!0},readOnly:{type:Boolean,default:!1}},data(){return{loading:!1,saving:!1,rows:[],dlg:{open:!1,modo:"crear",id:null},form:{acopio_cosecha_id:null,fecha:null,numero_colmenas_apiario:"",nombre_plaga:"",plaga_presente:"",daño_visible_apiario:"",medidas_control_celdilla:"",observaciones:""}}},computed:{datosEncabezado(){if(!this.cosecha?.apiario?.productor)return null;const l=this.cosecha.apiario.productor,o=l.municipio||{},m=o.provincia||{},C=o.departamento||{},i=this.cosecha.apiario||{};return{registro_sanitario:l.runsa||l.codigo_runsa||"N/A",departamento:C.nombre_departamento||"N/A",nombre_apicultor:`${l.nombre||""} ${l.apellidos||""}`.trim()||l.nombre_apellido||"N/A",nombre_apiario:i.nombre_apiario||i.codigo_apiario||"N/A",provincia:m.nombre_provincia||"N/A",municipio:o.nombre_municipio||"N/A",georeferenciacion:`${i.latitud||""}, ${i.longitud||""}`.trim().replace(/^,\s*|,\s*$/g,"")||"N/A",localidad:l.direccion||"N/A"}}},mounted(){this.fetchRows()},methods:{resetForm(){const l=new Date().toISOString().split("T")[0],o=this.cosecha?.apiario||{},m=o.nombre_apiario||o.codigo_apiario||"",C=o.numero_colmenas||o.cant_colmenas||"";this.form={acopio_cosecha_id:this.cosecha?.id||null,fecha:l,numero_colmenas_apiario:C,nombre_plaga:m,plaga_presente:"",daño_visible_apiario:"",medidas_control_celdilla:"",observaciones:""}},async fetchRows(){try{this.loading=!0;const{data:l}=await this.$axios.get("/plagas",{params:{cosecha_id:this.cosecha?.id}});this.rows=Array.isArray(l)?l:l?.data||[]}catch{this.$q.notify({type:"negative",message:"No se pudieron cargar los registros"})}finally{this.loading=!1}},onNuevo(){this.dlg.modo="crear",this.dlg.id=null,this.resetForm(),this.form.acopio_cosecha_id=this.cosecha?.id||null,this.dlg.open=!0},onEditar(l){this.dlg.modo="editar",this.dlg.id=l.id,this.form={...l,acopio_cosecha_id:this.cosecha?.id||l.acopio_cosecha_id},this.dlg.open=!0},async onGuardar(){try{this.saving=!0,this.dlg.modo==="crear"?(await this.$axios.post("/plagas",this.form),this.$q.notify({type:"positive",message:"Registro creado"})):(await this.$axios.put(`/plagas/${this.dlg.id}`,this.form),this.$q.notify({type:"positive",message:"Registro actualizado"})),this.dlg.open=!1,this.fetchRows()}catch{this.$q.notify({type:"negative",message:"Error al guardar"})}finally{this.saving=!1}},async onEliminar(l){this.$q.dialog({title:"Eliminar",message:"¿Desea eliminar este registro?",cancel:!0,persistent:!0}).onOk(async()=>{try{await this.$axios.delete(`/plagas/${l.id}`),this.$q.notify({type:"positive",message:"Eliminado"}),this.fetchRows()}catch{this.$q.notify({type:"negative",message:"No se pudo eliminar"})}})},onImprimir(){if(!this.cosecha?.id)return;const l=this.$axios.defaults.baseURL+`/plagas/${this.cosecha.id}/imprimir`;window.open(l,"_blank")}}},xo={class:"q-gutter-sm"},Co={class:"row q-col-gutter-sm"},Ao={class:"col-12 col-md-6"},Vo={class:"row q-col-gutter-xs"},ko={class:"col-6"},wo={class:"self-center full-width no-outline text-weight-medium"},No={class:"col-6"},Eo={class:"self-center full-width no-outline text-weight-medium"},zo={class:"col-12"},Oo={class:"self-center full-width no-outline text-weight-medium"},Io={class:"col-12"},Lo={class:"self-center full-width no-outline text-weight-medium"},Uo={class:"col-12 col-md-6"},qo={class:"row q-col-gutter-xs"},Ro={class:"col-12"},Mo={class:"self-center full-width no-outline text-weight-medium"},To={class:"col-12"},Po={class:"self-center full-width no-outline text-weight-medium"},$o={class:"col-12"},Do={class:"self-center full-width no-outline text-weight-medium"},So={class:"col-12"},Fo={class:"self-center full-width no-outline text-weight-medium"},Qo={class:"text-right"},Go={key:1},jo={class:"text-subtitle1"},Bo={class:"row q-col-gutter-md"},Zo={class:"col-12 col-md-4"},Ho={class:"col-12 col-md-6"},Jo={class:"col-12 col-md-6"},Ko={class:"col-12"},Wo={class:"col-12"};function Xo(l,o,m,C,i,r){return c(),_(N,{flat:"",bordered:""},{default:a(()=>[t(b,{class:"row items-center justify-between"},{default:a(()=>[o[6]||(o[6]=e("div",{class:"text-subtitle1"},"Control de Plagas",-1)),e("div",xo,[m.readOnly?E("",!0):(c(),_(f,{key:0,color:"primary",icon:"add",label:"Nuevo","no-caps":"",onClick:r.onNuevo},null,8,["onClick"])),t(f,{color:"green",icon:"print",label:"Imprimir","no-caps":"",onClick:r.onImprimir},null,8,["onClick"])])]),_:1}),t(A),r.datosEncabezado?(c(),_(b,{key:0,class:"bg-grey-2"},{default:a(()=>[o[7]||(o[7]=e("div",{class:"text-h6 text-center q-mb-md text-primary"}," Registro de Control de Plagas en Colmenas ",-1)),e("div",Co,[e("div",Ao,[e("div",Vo,[e("div",ko,[t(x,{dense:"",borderless:"",label:"REGISTRO SANITARIO:","stack-label":""},{control:a(()=>[e("div",wo,d(r.datosEncabezado.registro_sanitario||"N/A"),1)]),_:1})]),e("div",No,[t(x,{dense:"",borderless:"",label:"DEPARTAMENTO:","stack-label":""},{control:a(()=>[e("div",Eo,d(r.datosEncabezado.departamento||"N/A"),1)]),_:1})]),e("div",zo,[t(x,{dense:"",borderless:"",label:"NOMBRE DEL APICULTOR O RESPONSABLE:","stack-label":""},{control:a(()=>[e("div",Oo,d(r.datosEncabezado.nombre_apicultor||"N/A"),1)]),_:1})]),e("div",Io,[t(x,{dense:"",borderless:"",label:"NOMBRE DEL APIARIO:","stack-label":""},{control:a(()=>[e("div",Lo,d(r.datosEncabezado.nombre_apiario||"N/A"),1)]),_:1})])])]),e("div",Uo,[e("div",qo,[e("div",Ro,[t(x,{dense:"",borderless:"",label:"PROVINCIA:","stack-label":""},{control:a(()=>[e("div",Mo,d(r.datosEncabezado.provincia||"N/A"),1)]),_:1})]),e("div",To,[t(x,{dense:"",borderless:"",label:"MUNICIPIO:","stack-label":""},{control:a(()=>[e("div",Po,d(r.datosEncabezado.municipio||"N/A"),1)]),_:1})]),e("div",$o,[t(x,{dense:"",borderless:"",label:"GEOREFERENCIACIÓN:","stack-label":""},{control:a(()=>[e("div",Do,d(r.datosEncabezado.georeferenciacion||"N/A"),1)]),_:1})]),e("div",So,[t(x,{dense:"",borderless:"",label:"LOCALIDAD:","stack-label":""},{control:a(()=>[e("div",Fo,d(r.datosEncabezado.localidad||"N/A"),1)]),_:1})])])])])]),_:1})):E("",!0),t(A),t(b,null,{default:a(()=>[t($,{dense:"","wrap-cells":"",bordered:"",flat:""},{default:a(()=>[o[10]||(o[10]=e("thead",null,[e("tr",{class:"bg-primary text-white"},[e("th",null,"Acciones"),e("th",null,"Fecha"),e("th",null,"Nombre o Código del Apiario"),e("th",null,"Plaga Presente"),e("th",null,"Daño Visible"),e("th",null,"Método de Control")])],-1)),e("tbody",null,[(c(!0),h(U,null,q(i.rows,s=>(c(),h("tr",{key:s.id},[e("td",Qo,[m.readOnly?(c(),h("span",Go,"—")):(c(),_(P,{key:0,dense:"","no-caps":"",label:"Acciones",color:"primary",size:"10px"},{default:a(()=>[t(T,null,{default:a(()=>[y((c(),_(w,{clickable:"",onClick:n=>r.onEditar(s)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"edit"})]),_:1}),t(g,null,{default:a(()=>o[8]||(o[8]=[p("Editar")])),_:1})]),_:2},1032,["onClick"])),[[I],[v]]),y((c(),_(w,{clickable:"",onClick:n=>r.onEliminar(s)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"delete",color:"negative"})]),_:1}),t(g,null,{default:a(()=>o[9]||(o[9]=[p("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[I],[v]])]),_:2},1024)]),_:2},1024))]),e("td",null,d(s.fecha),1),e("td",null,d(s.nombre_plaga),1),e("td",null,d(s.plaga_presente),1),e("td",null,d(s.daño_visible_apiario),1),e("td",null,d(s.medidas_control_celdilla),1)]))),128))])]),_:1})]),_:1}),t(M,{modelValue:i.dlg.open,"onUpdate:modelValue":o[5]||(o[5]=s=>i.dlg.open=s),persistent:""},{default:a(()=>[t(N,{style:{"max-width":"90vw"}},{default:a(()=>[t(b,{class:"row items-center justify-between"},{default:a(()=>[e("div",jo,d(i.dlg.modo==="crear"?"Nuevo registro":"Editar registro"),1),y(t(f,{flat:"",round:"",dense:"",icon:"close"},null,512),[[v]])]),_:1}),t(A),t(b,{class:""},{default:a(()=>[e("div",Bo,[e("div",Zo,[t(u,{modelValue:i.form.fecha,"onUpdate:modelValue":o[0]||(o[0]=s=>i.form.fecha=s),type:"date",label:"Fecha",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Ho,[t(u,{modelValue:i.form.plaga_presente,"onUpdate:modelValue":o[1]||(o[1]=s=>i.form.plaga_presente=s),label:"Plaga Presente en el Apiario",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Jo,[t(u,{modelValue:i.form.daño_visible_apiario,"onUpdate:modelValue":o[2]||(o[2]=s=>i.form.daño_visible_apiario=s),label:"Daño Visible en el Apiario",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Ko,[t(u,{modelValue:i.form.medidas_control_celdilla,"onUpdate:modelValue":o[3]||(o[3]=s=>i.form.medidas_control_celdilla=s),label:"Método de Control Utilizado",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Wo,[t(u,{modelValue:i.form.observaciones,"onUpdate:modelValue":o[4]||(o[4]=s=>i.form.observaciones=s),type:"textarea",autogrow:"",label:"Observaciones",dense:"",outlined:""},null,8,["modelValue"])])])]),_:1}),t(A),t(B,{align:"right"},{default:a(()=>[y(t(f,{flat:"",label:"Cancelar"},null,512),[[v]]),t(f,{color:"primary",label:i.dlg.modo==="crear"?"Guardar":"Actualizar",onClick:r.onGuardar,loading:i.saving},null,8,["label","onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const El=R(vo,[["render",Xo]]),Yo={name:"LimpiezasFormulario",props:{cosecha:{type:Object,required:!0},readOnly:{type:Boolean,default:!1}},data(){return{loading:!1,saving:!1,rows:[],dlg:{open:!1,modo:"crear",id:null},form:{acopio_cosecha_id:null,equipo_herramienta_material:"",material_recubrimiento:"",metodo_limpieza_utilizado:"",producto_quimico_desinfeccion:"",fecha_aplicacion:null}}},computed:{datosEncabezado(){if(!this.cosecha?.apiario?.productor)return null;const l=this.cosecha.apiario.productor,o=l.municipio||{},m=o.provincia||{},C=o.departamento||{},i=this.cosecha.apiario||{};return{registro_sanitario:l.runsa||l.codigo_runsa||"N/A",departamento:C.nombre_departamento||"N/A",nombre_responsable:`${l.nombre||""} ${l.apellidos||""}`.trim()||l.nombre_apellido||"N/A",provincia:m.nombre_provincia||"N/A",ubicacion_upa:i.lugar_apiario||"N/A",municipio:o.nombre_municipio||"N/A",telefono:l.num_celular||l.celular||"N/A",localidad:l.direccion||"N/A",comunidad:l.comunidad||"N/A"}}},mounted(){this.fetchRows()},methods:{resetForm(){const l=new Date().toISOString().split("T")[0];this.form={acopio_cosecha_id:this.cosecha?.id||null,equipo_herramienta_material:"",material_recubrimiento:"",metodo_limpieza_utilizado:"",producto_quimico_desinfeccion:"",fecha_aplicacion:l}},async fetchRows(){try{this.loading=!0;const{data:l}=await this.$axios.get("/limpiezas",{params:{cosecha_id:this.cosecha?.id}});this.rows=Array.isArray(l)?l:l?.data||[]}catch{this.$q.notify({type:"negative",message:"No se pudieron cargar los registros"})}finally{this.loading=!1}},onNuevo(){this.dlg.modo="crear",this.dlg.id=null,this.resetForm(),this.form.acopio_cosecha_id=this.cosecha?.id||null,this.dlg.open=!0},onEditar(l){this.dlg.modo="editar",this.dlg.id=l.id,this.form={...l,acopio_cosecha_id:this.cosecha?.id||l.acopio_cosecha_id},this.dlg.open=!0},async onGuardar(){try{this.saving=!0,this.dlg.modo==="crear"?(await this.$axios.post("/limpiezas",this.form),this.$q.notify({type:"positive",message:"Registro creado"})):(await this.$axios.put(`/limpiezas/${this.dlg.id}`,this.form),this.$q.notify({type:"positive",message:"Registro actualizado"})),this.dlg.open=!1,this.fetchRows()}catch{this.$q.notify({type:"negative",message:"Error al guardar"})}finally{this.saving=!1}},async onEliminar(l){this.$q.dialog({title:"Eliminar",message:"¿Desea eliminar este registro?",cancel:!0,persistent:!0}).onOk(async()=>{try{await this.$axios.delete(`/limpiezas/${l.id}`),this.$q.notify({type:"positive",message:"Eliminado"}),this.fetchRows()}catch{this.$q.notify({type:"negative",message:"No se pudo eliminar"})}})},onImprimir(){if(!this.cosecha?.id)return;const l=this.$axios.defaults.baseURL+`/limpiezas/${this.cosecha.id}/imprimir`;window.open(l,"_blank")}}},et={class:"q-gutter-sm"},ot={class:"row q-col-gutter-sm"},tt={class:"col-12 col-md-6"},lt={class:"row q-col-gutter-xs"},it={class:"col-6"},at={class:"self-center full-width no-outline text-weight-medium"},st={class:"col-6"},nt={class:"self-center full-width no-outline text-weight-medium"},rt={class:"col-12"},dt={class:"self-center full-width no-outline text-weight-medium"},ct={class:"col-12"},ut={class:"self-center full-width no-outline text-weight-medium"},mt={class:"col-12"},pt={class:"self-center full-width no-outline text-weight-medium"},_t={class:"col-12 col-md-6"},ft={class:"row q-col-gutter-xs"},ht={class:"col-12"},gt={class:"self-center full-width no-outline text-weight-medium"},bt={class:"col-12"},yt={class:"self-center full-width no-outline text-weight-medium"},vt={class:"col-12"},xt={class:"self-center full-width no-outline text-weight-medium"},Ct={class:"col-12"},At={class:"self-center full-width no-outline text-weight-medium"},Vt={class:"text-right"},kt={key:1},wt={class:"text-subtitle1"},Nt={class:"row q-col-gutter-md"},Et={class:"col-12 col-md-6"},zt={class:"col-12 col-md-6"},Ot={class:"col-12 col-md-6"},It={class:"col-12 col-md-6"},Lt={class:"col-12 col-md-6"};function Ut(l,o,m,C,i,r){return c(),_(N,{flat:"",bordered:""},{default:a(()=>[t(b,{class:"row items-center justify-between"},{default:a(()=>[o[6]||(o[6]=e("div",{class:"text-subtitle1"},"Limpieza y Desinfección",-1)),e("div",et,[m.readOnly?E("",!0):(c(),_(f,{key:0,color:"primary",icon:"add",label:"Nuevo","no-caps":"",onClick:r.onNuevo},null,8,["onClick"])),t(f,{color:"green",icon:"print",label:"Imprimir","no-caps":"",onClick:r.onImprimir},null,8,["onClick"])])]),_:1}),t(A),r.datosEncabezado?(c(),_(b,{key:0,class:"bg-grey-2"},{default:a(()=>[o[7]||(o[7]=e("div",{class:"text-h6 text-center q-mb-md text-primary"}," Registro de limpieza y desinfección de equipos y herramienta apícolas ",-1)),e("div",ot,[e("div",tt,[e("div",lt,[e("div",it,[t(x,{dense:"",borderless:"",label:"REGISTRO SANITARIO:","stack-label":""},{control:a(()=>[e("div",at,d(r.datosEncabezado.registro_sanitario||"N/A"),1)]),_:1})]),e("div",st,[t(x,{dense:"",borderless:"",label:"DPTO.:","stack-label":""},{control:a(()=>[e("div",nt,d(r.datosEncabezado.departamento||"N/A"),1)]),_:1})]),e("div",rt,[t(x,{dense:"",borderless:"",label:"NOMBRE DEL RESPONSABLE:","stack-label":""},{control:a(()=>[e("div",dt,d(r.datosEncabezado.nombre_responsable||"N/A"),1)]),_:1})]),e("div",ct,[t(x,{dense:"",borderless:"",label:"UBICACIÓN DE LA UPA:","stack-label":""},{control:a(()=>[e("div",ut,d(r.datosEncabezado.ubicacion_upa||"N/A"),1)]),_:1})]),e("div",mt,[t(x,{dense:"",borderless:"",label:"TELÉFONO:","stack-label":""},{control:a(()=>[e("div",pt,d(r.datosEncabezado.telefono||"N/A"),1)]),_:1})])])]),e("div",_t,[e("div",ft,[e("div",ht,[t(x,{dense:"",borderless:"",label:"PROVINCIA:","stack-label":""},{control:a(()=>[e("div",gt,d(r.datosEncabezado.provincia||"N/A"),1)]),_:1})]),e("div",bt,[t(x,{dense:"",borderless:"",label:"MUNICIPIO:","stack-label":""},{control:a(()=>[e("div",yt,d(r.datosEncabezado.municipio||"N/A"),1)]),_:1})]),e("div",vt,[t(x,{dense:"",borderless:"",label:"LOCALIDAD:","stack-label":""},{control:a(()=>[e("div",xt,d(r.datosEncabezado.localidad||"N/A"),1)]),_:1})]),e("div",Ct,[t(x,{dense:"",borderless:"",label:"COMUNIDAD:","stack-label":""},{control:a(()=>[e("div",At,d(r.datosEncabezado.comunidad||"N/A"),1)]),_:1})])])])])]),_:1})):E("",!0),t(A),t(b,null,{default:a(()=>[t($,{dense:"","wrap-cells":"",bordered:"",flat:""},{default:a(()=>[o[10]||(o[10]=e("thead",null,[e("tr",{class:"bg-primary text-white"},[e("th",null,"Acciones"),e("th",null,"Equipo/Herramienta"),e("th",null,"Material Recubrimiento"),e("th",null,"Método Limpieza"),e("th",null,"Producto Químico"),e("th",null,"Fecha Aplicación")])],-1)),e("tbody",null,[(c(!0),h(U,null,q(i.rows,s=>(c(),h("tr",{key:s.id},[e("td",Vt,[m.readOnly?(c(),h("span",kt,"—")):(c(),_(P,{key:0,dense:"","no-caps":"",label:"Acciones",color:"primary",size:"10px"},{default:a(()=>[t(T,null,{default:a(()=>[y((c(),_(w,{clickable:"",onClick:n=>r.onEditar(s)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"edit"})]),_:1}),t(g,null,{default:a(()=>o[8]||(o[8]=[p("Editar")])),_:1})]),_:2},1032,["onClick"])),[[I],[v]]),y((c(),_(w,{clickable:"",onClick:n=>r.onEliminar(s)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"delete",color:"negative"})]),_:1}),t(g,null,{default:a(()=>o[9]||(o[9]=[p("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[I],[v]])]),_:2},1024)]),_:2},1024))]),e("td",null,d(s.equipo_herramienta_material),1),e("td",null,d(s.material_recubrimiento),1),e("td",null,d(s.metodo_limpieza_utilizado),1),e("td",null,d(s.producto_quimico_desinfeccion),1),e("td",null,d(s.fecha_aplicacion),1)]))),128))])]),_:1})]),_:1}),t(M,{modelValue:i.dlg.open,"onUpdate:modelValue":o[5]||(o[5]=s=>i.dlg.open=s),persistent:""},{default:a(()=>[t(N,{style:{"max-width":"90vw"}},{default:a(()=>[t(b,{class:"row items-center justify-between"},{default:a(()=>[e("div",wt,d(i.dlg.modo==="crear"?"Nuevo registro":"Editar registro"),1),y(t(f,{flat:"",round:"",dense:"",icon:"close"},null,512),[[v]])]),_:1}),t(A),t(b,{class:""},{default:a(()=>[e("div",Nt,[e("div",Et,[t(u,{modelValue:i.form.equipo_herramienta_material,"onUpdate:modelValue":o[0]||(o[0]=s=>i.form.equipo_herramienta_material=s),label:"Equipo, Herramienta o Material Apícola",dense:"",outlined:""},null,8,["modelValue"])]),e("div",zt,[t(u,{modelValue:i.form.material_recubrimiento,"onUpdate:modelValue":o[1]||(o[1]=s=>i.form.material_recubrimiento=s),label:"Material de Recubrimiento",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Ot,[t(u,{modelValue:i.form.metodo_limpieza_utilizado,"onUpdate:modelValue":o[2]||(o[2]=s=>i.form.metodo_limpieza_utilizado=s),label:"Método de Limpieza Utilizado",dense:"",outlined:""},null,8,["modelValue"])]),e("div",It,[t(u,{modelValue:i.form.producto_quimico_desinfeccion,"onUpdate:modelValue":o[3]||(o[3]=s=>i.form.producto_quimico_desinfeccion=s),label:"Producto Químico o Desinfección",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Lt,[t(u,{modelValue:i.form.fecha_aplicacion,"onUpdate:modelValue":o[4]||(o[4]=s=>i.form.fecha_aplicacion=s),type:"date",label:"Fecha de Aplicación",dense:"",outlined:""},null,8,["modelValue"])])])]),_:1}),t(A),t(B,{align:"right"},{default:a(()=>[y(t(f,{flat:"",label:"Cancelar"},null,512),[[v]]),t(f,{color:"primary",label:i.dlg.modo==="crear"?"Guardar":"Actualizar",onClick:r.onGuardar,loading:i.saving},null,8,["label","onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const zl=R(Yo,[["render",Ut]]),qt={name:"MedicamentosFormulario",props:{cosecha:{type:Object,required:!0},readOnly:{type:Boolean,default:!1}},data(){return{loading:!1,saving:!1,rows:[],dlg:{open:!1,modo:"crear",id:null},form:{acopio_cosecha_id:null,fecha:null,nombre_producto:"",principio_activo:"",dosis_recomendada:"",dosis_aplicada:"",plagas_controladas:"",periodo_espera_cosecha:"",nombre_encargado:"",firma:""}}},computed:{datosEncabezado(){if(!this.cosecha?.apiario?.productor)return null;const l=this.cosecha.apiario.productor,o=this.cosecha.apiario||{};return{nombre_apiario:o.nombre_apiario||o.codigo_apiario||"N/A",registro_sanitario:l.runsa||l.codigo_runsa||"N/A",nombre_responsable:`${l.nombre||""} ${l.apellidos||""}`.trim()||l.nombre_apellido||"N/A",ubicacion:l.direccion||"N/A",georeferenciacion:`${o.latitud||""}, ${o.longitud||""}`.trim().replace(/^,\s*|,\s*$/g,"")||"N/A",tipo_manejo:o.tipo_manejo||"N/A"}}},mounted(){this.fetchRows()},methods:{resetForm(){const l=new Date().toISOString().split("T")[0];this.form={acopio_cosecha_id:this.cosecha?.id||null,fecha:l,nombre_producto:"",principio_activo:"",dosis_recomendada:"",dosis_aplicada:"",plagas_controladas:"",periodo_espera_cosecha:"",nombre_encargado:"",firma:""}},async fetchRows(){try{this.loading=!0;const{data:l}=await this.$axios.get("/medicamentos",{params:{cosecha_id:this.cosecha?.id}});this.rows=Array.isArray(l)?l:l?.data||[]}catch{this.$q.notify({type:"negative",message:"No se pudieron cargar los registros"})}finally{this.loading=!1}},onNuevo(){this.dlg.modo="crear",this.dlg.id=null,this.resetForm(),this.form.acopio_cosecha_id=this.cosecha?.id||null,this.dlg.open=!0},onEditar(l){this.dlg.modo="editar",this.dlg.id=l.id,this.form={...l,acopio_cosecha_id:this.cosecha?.id||l.acopio_cosecha_id},this.dlg.open=!0},async onGuardar(){try{this.saving=!0,this.dlg.modo==="crear"?(await this.$axios.post("/medicamentos",this.form),this.$q.notify({type:"positive",message:"Registro creado"})):(await this.$axios.put(`/medicamentos/${this.dlg.id}`,this.form),this.$q.notify({type:"positive",message:"Registro actualizado"})),this.dlg.open=!1,this.fetchRows()}catch{this.$q.notify({type:"negative",message:"Error al guardar"})}finally{this.saving=!1}},async onEliminar(l){this.$q.dialog({title:"Eliminar",message:"¿Desea eliminar este registro?",cancel:!0,persistent:!0}).onOk(async()=>{try{await this.$axios.delete(`/medicamentos/${l.id}`),this.$q.notify({type:"positive",message:"Eliminado"}),this.fetchRows()}catch{this.$q.notify({type:"negative",message:"No se pudo eliminar"})}})},onImprimir(){if(!this.cosecha?.id)return;const l=this.$axios.defaults.baseURL+`/medicamentos/${this.cosecha.id}/imprimir`;window.open(l,"_blank")}}},Rt={class:"q-gutter-sm"},Mt={class:"row q-col-gutter-sm"},Tt={class:"col-12 col-md-6"},Pt={class:"row q-col-gutter-xs"},$t={class:"col-12"},Dt={class:"self-center full-width no-outline text-weight-medium"},St={class:"col-12"},Ft={class:"self-center full-width no-outline text-weight-medium"},Qt={class:"col-12"},Gt={class:"self-center full-width no-outline text-weight-medium"},jt={class:"col-12 col-md-6"},Bt={class:"row q-col-gutter-xs"},Zt={class:"col-12"},Ht={class:"self-center full-width no-outline text-weight-medium"},Jt={class:"col-12"},Kt={class:"self-center full-width no-outline text-weight-medium"},Wt={class:"col-12"},Xt={class:"self-center full-width no-outline text-weight-medium"},Yt={class:"text-right"},el={key:1},ol={class:"text-subtitle1"},tl={class:"row q-col-gutter-md"},ll={class:"col-12 col-md-3"},il={class:"col-12 col-md-9"},al={class:"col-12 col-md-6"},sl={class:"col-12 col-md-3"},nl={class:"col-12 col-md-3"},rl={class:"col-12 col-md-6"},dl={class:"col-12 col-md-6"},cl={class:"col-12 col-md-6"},ul={class:"col-12 col-md-6"};function ml(l,o,m,C,i,r){return c(),_(N,{flat:"",bordered:""},{default:a(()=>[t(b,{class:"row items-center justify-between"},{default:a(()=>[o[10]||(o[10]=e("div",{class:"text-subtitle1"},"Aplicación de Medicamentos",-1)),e("div",Rt,[m.readOnly?E("",!0):(c(),_(f,{key:0,color:"primary",icon:"add",label:"Nuevo","no-caps":"",onClick:r.onNuevo},null,8,["onClick"])),t(f,{color:"green",icon:"print",label:"Imprimir","no-caps":"",onClick:r.onImprimir},null,8,["onClick"])])]),_:1}),t(A),r.datosEncabezado?(c(),_(b,{key:0,class:"bg-grey-2"},{default:a(()=>[o[11]||(o[11]=e("div",{class:"text-h6 text-center q-mb-md text-primary"}," Registro de Aplicación de Medicamentos ",-1)),e("div",Mt,[e("div",Tt,[e("div",Pt,[e("div",$t,[t(x,{dense:"",borderless:"",label:"NOMBRE DEL APIARIO:","stack-label":""},{control:a(()=>[e("div",Dt,d(r.datosEncabezado.nombre_apiario||"N/A"),1)]),_:1})]),e("div",St,[t(x,{dense:"",borderless:"",label:"NOMBRE DEL RESPONSABLE:","stack-label":""},{control:a(()=>[e("div",Ft,d(r.datosEncabezado.nombre_responsable||"N/A"),1)]),_:1})]),e("div",Qt,[t(x,{dense:"",borderless:"",label:"UBICACIÓN GEOREFERENCIAL:","stack-label":""},{control:a(()=>[e("div",Gt,d(r.datosEncabezado.georeferenciacion||"N/A"),1)]),_:1})])])]),e("div",jt,[e("div",Bt,[e("div",Zt,[t(x,{dense:"",borderless:"",label:"REGISTRO SANITARIO:","stack-label":""},{control:a(()=>[e("div",Ht,d(r.datosEncabezado.registro_sanitario||"N/A"),1)]),_:1})]),e("div",Jt,[t(x,{dense:"",borderless:"",label:"UBICACIÓN:","stack-label":""},{control:a(()=>[e("div",Kt,d(r.datosEncabezado.ubicacion||"N/A"),1)]),_:1})]),e("div",Wt,[t(x,{dense:"",borderless:"",label:"TIPO DE MANEJO:","stack-label":""},{control:a(()=>[e("div",Xt,d(r.datosEncabezado.tipo_manejo||"N/A"),1)]),_:1})])])])])]),_:1})):E("",!0),t(A),t(b,null,{default:a(()=>[t($,{dense:"","wrap-cells":"",bordered:"",flat:""},{default:a(()=>[o[14]||(o[14]=e("thead",null,[e("tr",{class:"bg-primary text-white"},[e("th",null,"Acciones"),e("th",null,"Fecha"),e("th",null,"Nombre Producto"),e("th",null,"Principio Activo"),e("th",null,"Dosis Recomendada"),e("th",null,"Dosis Aplicada"),e("th",null,"Plagas Controladas")])],-1)),e("tbody",null,[(c(!0),h(U,null,q(i.rows,s=>(c(),h("tr",{key:s.id},[e("td",Yt,[m.readOnly?(c(),h("span",el,"—")):(c(),_(P,{key:0,dense:"","no-caps":"",label:"Acciones",color:"primary",size:"10px"},{default:a(()=>[t(T,null,{default:a(()=>[y((c(),_(w,{clickable:"",onClick:n=>r.onEditar(s)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"edit"})]),_:1}),t(g,null,{default:a(()=>o[12]||(o[12]=[p("Editar")])),_:1})]),_:2},1032,["onClick"])),[[I],[v]]),y((c(),_(w,{clickable:"",onClick:n=>r.onEliminar(s)},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(k,{name:"delete",color:"negative"})]),_:1}),t(g,null,{default:a(()=>o[13]||(o[13]=[p("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[I],[v]])]),_:2},1024)]),_:2},1024))]),e("td",null,d(s.fecha),1),e("td",null,d(s.nombre_producto),1),e("td",null,d(s.principio_activo),1),e("td",null,d(s.dosis_recomendada),1),e("td",null,d(s.dosis_aplicada),1),e("td",null,d(s.plagas_controladas),1)]))),128))])]),_:1})]),_:1}),t(M,{modelValue:i.dlg.open,"onUpdate:modelValue":o[9]||(o[9]=s=>i.dlg.open=s),persistent:""},{default:a(()=>[t(N,{style:{"max-width":"90vw"}},{default:a(()=>[t(b,{class:"row items-center justify-between"},{default:a(()=>[e("div",ol,d(i.dlg.modo==="crear"?"Nuevo registro":"Editar registro"),1),y(t(f,{flat:"",round:"",dense:"",icon:"close"},null,512),[[v]])]),_:1}),t(A),t(b,{class:""},{default:a(()=>[e("div",tl,[e("div",ll,[t(u,{modelValue:i.form.fecha,"onUpdate:modelValue":o[0]||(o[0]=s=>i.form.fecha=s),type:"date",label:"Fecha",dense:"",outlined:""},null,8,["modelValue"])]),e("div",il,[t(u,{modelValue:i.form.nombre_producto,"onUpdate:modelValue":o[1]||(o[1]=s=>i.form.nombre_producto=s),label:"Nombre del Producto",dense:"",outlined:""},null,8,["modelValue"])]),e("div",al,[t(u,{modelValue:i.form.principio_activo,"onUpdate:modelValue":o[2]||(o[2]=s=>i.form.principio_activo=s),label:"Principio Activo",dense:"",outlined:""},null,8,["modelValue"])]),e("div",sl,[t(u,{modelValue:i.form.dosis_recomendada,"onUpdate:modelValue":o[3]||(o[3]=s=>i.form.dosis_recomendada=s),label:"Dosis Recomendada",dense:"",outlined:""},null,8,["modelValue"])]),e("div",nl,[t(u,{modelValue:i.form.dosis_aplicada,"onUpdate:modelValue":o[4]||(o[4]=s=>i.form.dosis_aplicada=s),label:"Dosis Aplicada",dense:"",outlined:""},null,8,["modelValue"])]),e("div",rl,[t(u,{modelValue:i.form.plagas_controladas,"onUpdate:modelValue":o[5]||(o[5]=s=>i.form.plagas_controladas=s),label:"Plagas Controladas",dense:"",outlined:""},null,8,["modelValue"])]),e("div",dl,[t(u,{modelValue:i.form.periodo_espera_cosecha,"onUpdate:modelValue":o[6]||(o[6]=s=>i.form.periodo_espera_cosecha=s),label:"Periodo de Espera para Cosecha",dense:"",outlined:""},null,8,["modelValue"])]),e("div",cl,[t(u,{modelValue:i.form.nombre_encargado,"onUpdate:modelValue":o[7]||(o[7]=s=>i.form.nombre_encargado=s),label:"Nombre del Encargado",dense:"",outlined:""},null,8,["modelValue"])]),e("div",ul,[t(u,{modelValue:i.form.firma,"onUpdate:modelValue":o[8]||(o[8]=s=>i.form.firma=s),label:"Firma",dense:"",outlined:"",hint:"Texto o ruta de imagen"},null,8,["modelValue"])])])]),_:1}),t(A),t(B,{align:"right"},{default:a(()=>[y(t(f,{flat:"",label:"Cancelar"},null,512),[[v]]),t(f,{color:"primary",label:i.dlg.modo==="crear"?"Guardar":"Actualizar",onClick:r.onGuardar,loading:i.saving},null,8,["label","onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const Ol=R(qt,[["render",ml]]);export{zl as L,Ol as M,El as P,kl as a,wl as b,Nl as c};
