import{Q as O}from"./QSpace-BKqyzHD1.js";import{Q as A}from"./QSelect-pyB2onRy.js";import{Q as G}from"./QTooltip-C1UXaS9U.js";import{_ as N,c as v,o as u,w as i,b as r,a9 as B,a,f as F,a8 as d,t as p,Q as m,O as J,aa as f,ab as k,ac as P,e as b,d as _,ae as S}from"./index-C57aArx_.js";import{d as K,Q as q,b as y,a as w}from"./format-Doy9yArQ.js";import{Q}from"./QBanner-BuQ3eScg.js";import{Q as L,a as C,b as Z,c as D}from"./QTabPanels-BCyyStCI.js";import{Q as h}from"./QInnerLoading-DirCchJ5.js";import{Q as I}from"./QList-Dipks2eP.js";import{Q as M}from"./QLinearProgress-DRkO5Xzi.js";import{Q as E}from"./QTd-BUsSsO5t.js";import{Q as T}from"./QTable-B7MqMvKF.js";import{Q as j}from"./QBadge-WE79iHux.js";import{Q as W}from"./QPage-B7bQxfky.js";import{C as z}from"./auto-DHENdVy-.js";import{h as U}from"./moment-C5S46NFB.js";import"./selection-BLLKP77D.js";import"./QResizeObserver-DRN598g6.js";import"./use-panel-DieZm8VA.js";import"./touch-BjYP5sR0.js";import"./QMarkupTable-Bcow09FE.js";import"./use-fullscreen-B-fySJzt.js";const H={name:"DashboardAcopios",data(){return{tabActiva:"resumen",gestionSeleccionada:U().year(),productoSeleccionado:null,gestiones:[],productos:[],departamentos:[],municipios:[],listaOrganizaciones:[],loadingActualizar:!1,loadingKpis:!1,loadingGraficos:!1,loadingTablas:!1,indicadoresGlobales:null,kpisResumen:[],datosEvolucionAnual:[],topDepartamentos:[],topMunicipios:[],topOrganizaciones:[],filtroDepartamento:null,filtroMunicipio:null,datosGeograficos:[],tablaGeografica:[],paginacionGeo:{rowsPerPage:10,sortBy:"totalKg",descending:!0},columnasGeograficas:[{name:"ubicacion",label:"Ubicación",field:"ubicacion",align:"left",sortable:!0},{name:"productores",label:"Productores",field:"productores",align:"center",sortable:!0},{name:"totalKg",label:"Total Kg",field:"totalKg",align:"right",sortable:!0,format:t=>t?.toFixed(2)},{name:"promedio",label:"Promedio Kg/Productor",field:"promedio",align:"right",sortable:!0,format:t=>t?.toFixed(2)},{name:"porcentaje",label:"% del Total",field:"porcentaje",align:"center",sortable:!0}],datosProductos:[],tablaDistribucionProducto:[],columnasDistribucionProducto:[{name:"ubicacion",label:"Ubicación",field:"ubicacion",align:"left"},{name:"kg",label:"Kg",field:"kg",align:"right",format:t=>t?.toFixed(2)},{name:"porcentaje",label:"% del Producto",field:"porcentaje",align:"center",format:t=>t?.toFixed(2)+"%"},{name:"productores",label:"Productores",field:"productores",align:"center"}],gestionesComparar:[],tablaEstacionalidad:[],tablaComparativa:[],columnasEstacionalidad:[{name:"mes",label:"Mes",field:"mes",align:"left"},{name:"totalKg",label:"Total Kg",field:"totalKg",align:"right",format:t=>t?.toFixed(2)},{name:"porcentaje",label:"% del Año",field:"porcentaje",align:"center",format:t=>t?.toFixed(2)+"%"},{name:"ranking",label:"Ranking",field:"ranking",align:"center"},{name:"tendencia",label:"Tendencia",field:"tendencia",align:"center"}],columnasComparativa:[{name:"mes",label:"Mes",field:"mes",align:"left"},{name:"anioActual",label:"Año Actual (Kg)",field:"anioActual",align:"right",format:t=>t?.toFixed(2)},{name:"anioAnterior",label:"Año Anterior (Kg)",field:"anioAnterior",align:"right",format:t=>t?.toFixed(2)},{name:"diferencia",label:"Diferencia (Kg)",field:"diferencia",align:"right",format:t=>t?.toFixed(2)},{name:"variacion",label:"Variación %",field:"variacion",align:"center"}],tablaOrganizaciones:[],orgSeleccionada:null,tablaContribucion:[],columnasOrganizaciones:[{name:"posicion",label:"#",field:"posicion",align:"center"},{name:"asociacion",label:"Asociación",field:"asociacion",align:"left",sortable:!0},{name:"totalKg",label:"Total Kg",field:"totalKg",align:"right",sortable:!0,format:t=>t?.toFixed(2)},{name:"productores",label:"Productores",field:"productores",align:"center",sortable:!0},{name:"promedio",label:"Promedio Kg/Productor",field:"promedio",align:"right",sortable:!0,format:t=>t?.toFixed(2)},{name:"porcentaje",label:"% del Total",field:"porcentaje",align:"center",sortable:!0,format:t=>t?.toFixed(2)+"%"}],chartInstances:[]}},watch:{tabActiva(t){this.cargarDatosTab(t)}},mounted(){this.cargarDatosIniciales()},beforeUnmount(){this.destruirCharts()},methods:{cargarDatosIniciales(){this.generarGestiones(),this.cargarProductos(),this.cargarDepartamentos(),this.gestionesComparar=[this.gestionSeleccionada],this.cargarDatosDashboard()},generarGestiones(){const t=U().year();this.gestiones=[];for(let e=2020;e<=t+1;e++)this.gestiones.push(e)},async cargarProductos(){try{const{data:t}=await this.$axios.get("/productos/tipo/1");this.productos=t?.data||t||[],this.productos.length>0&&(this.productoSeleccionado=this.productos[0].id)}catch{this.$alert?.error?.("Error al cargar productos")}},async cargarDepartamentos(){try{const{data:t}=await this.$axios.get("/departamentos");this.departamentos=t?.data||t||[]}catch{this.$alert?.error?.("Error al cargar departamentos")}},cambioFiltroGlobal(){this.actualizarIndicadoresGlobales(),this.cargarDatosTab(this.tabActiva)},actualizarDatos(){this.loadingActualizar=!0,this.cargarDatosTab(this.tabActiva),setTimeout(()=>{this.loadingActualizar=!1,this.$q.notify({type:"positive",message:"Datos actualizados"})},1e3)},cargarDatosDashboard(){this.actualizarIndicadoresGlobales(),this.cargarDatosTab(this.tabActiva)},cargarDatosTab(t){switch(t){case"resumen":this.cargarKpisResumen(),this.generarGraficoEvolucionAnual(),this.cargarTop3();break;case"geografico":this.filtroDepartamento&&this.aplicarFiltroGeografico();break;case"productos":this.generarGraficoProductos(),this.cargarDistribucionProducto();break;case"temporal":this.generarGraficoTemporal(),this.cargarEstacionalidad(),this.cargarComparativaAnual();break;case"organizacional":this.cargarRankingOrganizaciones(),this.cargarMapaContribucion();break}},async actualizarIndicadoresGlobales(){try{const{data:t}=await this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada}}),e=t?.data?.reduce((l,s)=>l+parseFloat(s||0),0)||0,n=(await this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada-1}}))?.data?.data?.reduce((l,s)=>l+parseFloat(s||0),0)||0,o=n>0?(e-n)/n*100:0;this.indicadoresGlobales={totalKg:e,totalProductores:0,promedioKg:0,crecimiento:o}}catch{this.indicadoresGlobales={totalKg:0,totalProductores:0,promedioKg:0,crecimiento:0}}},async cargarKpisResumen(){this.loadingKpis=!0;try{const{data:t}=await this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada}}),e=t?.data?.reduce((c,n)=>c+parseFloat(n||0),0)||0;this.kpisResumen=[{label:"Total Kg Acopiados",value:e.toFixed(2),icon:"inbox",color:"primary"},{label:"Productores Activos",value:"0",icon:"people",color:"green"},{label:"Organizaciones",value:"0",icon:"apartment",color:"orange"},{label:"Crecimiento",value:this.indicadoresGlobales?.crecimiento?.toFixed(2)+"%",icon:this.indicadoresGlobales?.crecimiento>=0?"trending_up":"trending_down",color:this.indicadoresGlobales?.crecimiento>=0?"positive":"negative"}]}catch{this.$alert?.error?.("Error al cargar KPIs")}finally{this.loadingKpis=!1}},async generarGraficoEvolucionAnual(){this.loadingGraficos=!0;try{const{data:t}=await this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada}});this.datosEvolucionAnual=t?.data||[],await this.$nextTick();const e=this.$refs.chartEvolucionAnual;if(!e)return;const c=this.chartInstances.find(l=>l.canvas===e);c&&(c.destroy(),this.chartInstances=this.chartInstances.filter(l=>l.canvas!==e));const n=e.getContext("2d"),o=new z(n,{type:"line",data:{labels:t?.labels||[],datasets:[{label:`Acopio ${this.gestionSeleccionada} (Kg)`,data:this.datosEvolucionAnual,borderColor:"rgb(25, 118, 210)",backgroundColor:"rgba(25, 118, 210, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!0,position:"top"}},scales:{y:{beginAtZero:!0}}}});this.chartInstances.push(o)}catch{this.$alert?.error?.("Error al generar gráfico de evolución")}finally{this.loadingGraficos=!1}},async cargarTop3(){this.loadingTablas=!0;try{const{data:t}=await this.$axios.post("/reporteAcopioProveedorDep",{producto_id:this.productoSeleccionado,inicio:`${this.gestionSeleccionada}-01-01`,fin:`${this.gestionSeleccionada}-12-31`}),e=(t?.data||t||[]).map(c=>({nombre:c.departamento,kg:parseFloat(c.total||0)})).sort((c,n)=>n.kg-c.kg);this.topDepartamentos=e.slice(0,3),this.topMunicipios=[],this.topOrganizaciones=[]}catch{this.topDepartamentos=[],this.topMunicipios=[],this.topOrganizaciones=[]}finally{this.loadingTablas=!1}},async onDepartamentoChange(){this.filtroMunicipio=null,this.filtroDepartamento&&await this.cargarMunicipios()},async cargarMunicipios(){if(this.filtroDepartamento)try{const{data:t}=await this.$axios.get("/municipios",{params:{departamento_id:this.filtroDepartamento}});this.municipios=t?.data||t||[]}catch{this.$alert?.error?.("Error al cargar municipios")}},async aplicarFiltroGeografico(){this.loadingGraficos=!0,this.loadingTablas=!0;try{const t=this.filtroMunicipio?"/reporteAcopioProveedorMun":"/reporteAcopioProveedorDep",{data:e}=await this.$axios.post(t,{producto_id:this.productoSeleccionado,inicio:`${this.gestionSeleccionada}-01-01`,fin:`${this.gestionSeleccionada}-12-31`}),c=e?.data||e||[];this.datosGeograficos=c;const n=c.reduce((o,l)=>o+parseFloat(l.total||0),0);this.tablaGeografica=c.map(o=>{const l=parseFloat(o.total||0),s=parseInt(o.productores||0);return{ubicacion:o.departamento||o.municipio,productores:s,totalKg:l,promedio:s>0?l/s:0,porcentaje:n>0?(l/n*100).toFixed(2):0}}),await this.generarGraficoGeografico()}catch{this.$alert?.error?.("Error al cargar datos geográficos")}finally{this.loadingGraficos=!1,this.loadingTablas=!1}},async generarGraficoGeografico(){await this.$nextTick();const t=this.$refs.chartGeografico;if(!t||this.datosGeograficos.length===0)return;const e=this.chartInstances.find(o=>o.canvas===t);e&&(e.destroy(),this.chartInstances=this.chartInstances.filter(o=>o.canvas!==t));const c=t.getContext("2d"),n=new z(c,{type:"bar",data:{labels:this.datosGeograficos.map(o=>o.departamento||o.municipio),datasets:[{label:"Acopio (Kg)",data:this.datosGeograficos.map(o=>parseFloat(o.total||0)),backgroundColor:"rgba(25, 118, 210, 0.7)",borderColor:"rgb(25, 118, 210)",borderWidth:1}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0}}}});this.chartInstances.push(n)},async generarGraficoProductos(){this.loadingGraficos=!0;try{const{data:t}=await this.$axios.get("/acopiore1",{params:{year:this.gestionSeleccionada}});this.datosProductos=t?.data||[],await this.$nextTick();const e=this.$refs.chartProductos;if(!e)return;const c=this.chartInstances.find(l=>l.canvas===e);c&&(c.destroy(),this.chartInstances=this.chartInstances.filter(l=>l.canvas!==e));const n=e.getContext("2d"),o=new z(n,{type:"doughnut",data:{labels:this.datosProductos.map(l=>l.producto),datasets:[{data:this.datosProductos.map(l=>parseFloat(l.total_kg||0)),backgroundColor:["rgba(255, 99, 132, 0.7)","rgba(54, 162, 235, 0.7)","rgba(255, 206, 86, 0.7)","rgba(75, 192, 192, 0.7)","rgba(153, 102, 255, 0.7)"],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"bottom"}}}});this.chartInstances.push(o)}catch{this.$alert?.error?.("Error al generar gráfico de productos")}finally{this.loadingGraficos=!1}},async cargarDistribucionProducto(){this.loadingTablas=!0;try{const{data:t}=await this.$axios.post("/reporteAcopioProveedorDep",{producto_id:this.productoSeleccionado,inicio:`${this.gestionSeleccionada}-01-01`,fin:`${this.gestionSeleccionada}-12-31`}),e=t?.data||t||[],c=e.reduce((n,o)=>n+parseFloat(o.total||0),0);this.tablaDistribucionProducto=e.slice(0,5).map(n=>({ubicacion:n.departamento,kg:parseFloat(n.total||0),porcentaje:c>0?parseFloat(n.total||0)/c*100:0,productores:parseInt(n.productores||0)}))}catch{this.tablaDistribucionProducto=[]}finally{this.loadingTablas=!1}},async generarGraficoTemporal(){this.loadingGraficos=!0;try{const t=[],e=["rgb(25, 118, 210)","rgb(76, 175, 80)","rgb(255, 152, 0)"];for(let s=0;s<this.gestionesComparar.length&&s<3;s++){const g=this.gestionesComparar[s],{data:x}=await this.$axios.get("/acopiore2",{params:{year:g}});t.push({label:`Gestión ${g}`,data:x?.data||[],borderColor:e[s],backgroundColor:e[s].replace("rgb","rgba").replace(")",", 0.1)"),tension:.4})}await this.$nextTick();const c=this.$refs.chartTemporal;if(!c)return;const n=this.chartInstances.find(s=>s.canvas===c);n&&(n.destroy(),this.chartInstances=this.chartInstances.filter(s=>s.canvas!==c));const o=c.getContext("2d"),l=new z(o,{type:"line",data:{labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],datasets:t},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!0,position:"top"}},scales:{y:{beginAtZero:!0}}}});this.chartInstances.push(l)}catch{this.$alert?.error?.("Error al generar gráfico temporal")}finally{this.loadingGraficos=!1}},async cargarEstacionalidad(){this.loadingTablas=!0;try{const{data:t}=await this.$axios.post("/reportePorcentual",{producto_id:this.productoSeleccionado,inicio:`${this.gestionSeleccionada}-01-01`,fin:`${this.gestionSeleccionada}-12-31`}),c=(t?.data||t||[]).map((n,o)=>({mes:n.nombre_mes||`Mes ${o+1}`,totalKg:parseFloat(n.acopio_kg||0),porcentaje:parseFloat(n.porcentaje||0),ranking:0})).sort((n,o)=>o.totalKg-n.totalKg);c.forEach((n,o)=>{n.ranking=o+1}),this.tablaEstacionalidad=c.sort((n,o)=>n.mes.localeCompare(o.mes))}catch{this.tablaEstacionalidad=[]}finally{this.loadingTablas=!1}},async cargarComparativaAnual(){this.loadingTablas=!0;try{const[t,e]=await Promise.all([this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada}}),this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada-1}})]),c=t?.data?.data||[],n=e?.data?.data||[],o=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];this.tablaComparativa=o.map((l,s)=>{const g=parseFloat(c[s]||0),x=parseFloat(n[s]||0),V=g-x,R=x>0?V/x*100:0;return{mes:l,anioActual:g,anioAnterior:x,diferencia:V,variacion:R}})}catch{this.tablaComparativa=[]}finally{this.loadingTablas=!1}},async cargarRankingOrganizaciones(){this.loadingTablas=!0;try{const{data:t}=await this.$axios.post("/reportAcopioOrg",{gestion:this.gestionSeleccionada,producto_id:this.productoSeleccionado}),e=t?.data||t||[],c=e.reduce((n,o)=>{const l=Object.keys(o).filter(s=>s!=="asociacion").reduce((s,g)=>s+parseFloat(o[g]||0),0);return n+l},0);this.listaOrganizaciones=e,this.tablaOrganizaciones=e.map(n=>{const o=Object.keys(n).filter(l=>l!=="asociacion").reduce((l,s)=>l+parseFloat(n[s]||0),0);return{asociacion:n.asociacion,totalKg:o,productores:0,promedio:0,porcentaje:c>0?o/c*100:0}}).sort((n,o)=>o.totalKg-n.totalKg).map((n,o)=>({...n,posicion:o+1}))}catch{this.tablaOrganizaciones=[],this.listaOrganizaciones=[]}finally{this.loadingTablas=!1}},async generarGraficoPerformanceOrg(){if(this.orgSeleccionada){this.loadingGraficos=!0;try{await this.$nextTick();const t=this.$refs.chartPerformance;if(!t)return;const e=this.chartInstances.find(s=>s.canvas===t);e&&(e.destroy(),this.chartInstances=this.chartInstances.filter(s=>s.canvas!==t));const n=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"].map(s=>parseFloat(this.orgSeleccionada[s]||0)),o=t.getContext("2d"),l=new z(o,{type:"bar",data:{labels:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],datasets:[{label:this.orgSeleccionada.asociacion,data:n,backgroundColor:"rgba(25, 118, 210, 0.7)",borderColor:"rgb(25, 118, 210)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!0}},scales:{y:{beginAtZero:!0}}}});this.chartInstances.push(l)}catch{this.$alert?.error?.("Error al generar gráfico de performance")}finally{this.loadingGraficos=!1}}},cargarMapaContribucion(){this.tablaContribucion=this.tablaOrganizaciones.map(t=>({asociacion:t.asociacion,porcentaje:t.porcentaje}))},exportarDashboard(t){this.$q.notify({type:"info",message:"Funcionalidad de exportación en desarrollo"})},destruirCharts(){this.chartInstances.forEach(t=>{t&&typeof t.destroy=="function"&&t.destroy()}),this.chartInstances=[]}}},X={class:"row items-center q-mb-md"},Y={class:"col-12 col-md-4 q-gutter-sm"},$={class:"row q-gutter-sm"},aa={class:"col"},oa={class:"col"},ea={class:"col-auto"},ta={class:"row q-gutter-sm"},ia={class:"row q-col-gutter-md q-mb-md"},sa={class:"row items-center"},ra={class:"text-caption text-grey-7"},na={class:"text-h5 text-weight-bold"},la={class:"text-subtitle1 q-mb-md"},ca={key:0},da={key:1,ref:"chartEvolucionAnual",height:"80"},ua={class:"row q-col-gutter-md"},ga={class:"col-12 col-md-4"},pa={key:1,class:"text-center text-grey-6 q-pa-md"},ma={class:"col-12 col-md-4"},fa={key:1,class:"text-center text-grey-6 q-pa-md"},ba={class:"col-12 col-md-4"},ha={key:1,class:"text-center text-grey-6 q-pa-md"},va={class:"row q-col-gutter-md q-mb-md"},_a={class:"col-12 col-md-4"},ya={class:"col-12 col-md-4"},wa={class:"col-12 col-md-4"},xa={class:"text-subtitle1 q-mb-md"},Aa={key:0},Ga={key:1,ref:"chartGeografico",height:"100"},ka={class:"row items-center q-mb-md"},Pa={class:"text-caption"},Ca={class:"row q-col-gutter-md"},Da={class:"col-12 col-md-6"},Ta={class:"text-subtitle1 q-mb-md"},za={key:0},Fa={key:1,ref:"chartProductos",height:"200"},Sa={class:"col-12 col-md-6"},Ka={class:"row q-col-gutter-md q-mb-md"},qa={class:"col-12 col-md-6"},Qa={class:"text-subtitle1 q-mb-md"},Ia={ref:"chartTemporal",height:"80"},Ea={class:"row q-col-gutter-md"},Oa={class:"col-12 col-md-6"},Va={class:"col-12 col-md-6"},Ma={class:"row items-center q-mb-md"},ja={class:"row q-col-gutter-md"},Ua={class:"col-12 col-md-6"},Ra={class:"text-subtitle1 q-mb-md"},Na={ref:"chartPerformance",height:"150"},Ba={class:"col-12 col-md-6"};function Ja(t,e,c,n,o,l){return u(),v(W,{class:"q-pa-md"},{default:i(()=>[r("div",X,[e[11]||(e[11]=r("div",{class:"col-12 col-md-4"},[r("div",{class:"text-h5"},"Dashboard de Acopios"),r("div",{class:"text-caption text-grey-7"},"Análisis multidimensional de producción")],-1)),a(O),r("div",Y,[r("div",$,[r("div",aa,[a(A,{modelValue:o.gestionSeleccionada,"onUpdate:modelValue":[e[0]||(e[0]=s=>o.gestionSeleccionada=s),l.cambioFiltroGlobal],options:o.gestiones,label:"Gestión",dense:"",outlined:""},null,8,["modelValue","options","onUpdate:modelValue"])]),r("div",oa,[a(A,{modelValue:o.productoSeleccionado,"onUpdate:modelValue":[e[1]||(e[1]=s=>o.productoSeleccionado=s),l.cambioFiltroGlobal],options:o.productos,"option-label":"nombre_producto","option-value":"id",label:"Producto",dense:"",outlined:"","emit-value":"","map-options":""},null,8,["modelValue","options","onUpdate:modelValue"])])])]),r("div",ea,[a(F,{flat:"",round:"",icon:"refresh",color:"primary",loading:o.loadingActualizar,onClick:l.actualizarDatos},{default:i(()=>[a(G,null,{default:i(()=>e[10]||(e[10]=[d("Actualizar datos")])),_:1})]),_:1},8,["loading","onClick"])])]),o.indicadoresGlobales?(u(),v(Q,{key:0,class:"bg-blue-grey-1 q-mb-md",rounded:""},{default:i(()=>[r("div",ta,[a(K,{color:"primary","text-color":"white",icon:"inbox",dense:""},{default:i(()=>[d(" Total Kg: "+p(o.indicadoresGlobales.totalKg?.toFixed(2)||"0.00"),1)]),_:1}),a(K,{color:"green","text-color":"white",icon:"people",dense:""},{default:i(()=>[d(" Productores: "+p(o.indicadoresGlobales.totalProductores||0),1)]),_:1}),a(K,{color:"orange","text-color":"white",icon:"analytics",dense:""},{default:i(()=>[d(" Promedio: "+p(o.indicadoresGlobales.promedioKg?.toFixed(2)||"0.00")+" Kg/Productor ",1)]),_:1}),a(K,{color:o.indicadoresGlobales.crecimiento>=0?"positive":"negative","text-color":"white",icon:o.indicadoresGlobales.crecimiento>=0?"trending_up":"trending_down",dense:""},{default:i(()=>[d(" Crecimiento: "+p(o.indicadoresGlobales.crecimiento?.toFixed(2)||"0.00")+"% ",1)]),_:1},8,["color","icon"])])]),_:1})):B("",!0),a(m,{flat:"",bordered:""},{default:i(()=>[a(L,{modelValue:o.tabActiva,"onUpdate:modelValue":e[2]||(e[2]=s=>o.tabActiva=s),dense:"",align:"left","active-color":"primary","indicator-color":"primary",class:"text-grey"},{default:i(()=>[a(C,{name:"resumen",icon:"dashboard",label:"Resumen General","no-caps":""}),a(C,{name:"geografico",icon:"location_on",label:"Análisis Geográfico","no-caps":""}),a(C,{name:"productos",icon:"inventory",label:"Análisis por Producto","no-caps":""}),a(C,{name:"temporal",icon:"schedule",label:"Análisis Temporal","no-caps":""}),a(C,{name:"organizacional",icon:"apartment",label:"Análisis Organizacional","no-caps":""})]),_:1},8,["modelValue"]),a(J),a(Z,{modelValue:o.tabActiva,"onUpdate:modelValue":e[9]||(e[9]=s=>o.tabActiva=s),animated:""},{default:i(()=>[a(D,{name:"resumen"},{default:i(()=>[r("div",ia,[(u(!0),f(k,null,P(o.kpisResumen,s=>(u(),f("div",{class:"col-12 col-md-6 col-lg-3",key:s.label},[a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingKpis},null,8,["showing"]),r("div",sa,[a(_,{name:s.icon,color:s.color,size:"md",class:"q-mr-sm"},null,8,["name","color"]),r("div",null,[r("div",ra,p(s.label),1),r("div",na,p(s.value),1)])])]),_:2},1024)]),_:2},1024)]))),128))]),a(m,{flat:"",bordered:"",class:"q-mb-md"},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingGraficos},null,8,["showing"]),r("div",la,[e[13]||(e[13]=d(" Evolución Mensual de Acopios ")),a(_,{name:"info",size:"xs",color:"grey-6"},{default:i(()=>[a(G,null,{default:i(()=>e[12]||(e[12]=[d("Muestra la tendencia de acopio a lo largo del año")])),_:1})]),_:1})]),!o.loadingGraficos&&o.datosEvolucionAnual.length===0?(u(),f("div",ca,[a(Q,{class:"bg-info text-white",rounded:"",dense:""},{avatar:i(()=>[a(_,{name:"info"})]),default:i(()=>[e[14]||(e[14]=d(" No hay datos disponibles para la gestión seleccionada "))]),_:1})])):(u(),f("canvas",da,null,512))]),_:1})]),_:1}),r("div",ua,[r("div",ga,[a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingTablas},null,8,["showing"]),e[15]||(e[15]=r("div",{class:"text-subtitle1 q-mb-md"},"Top 3 Departamentos",-1)),o.topDepartamentos.length>0?(u(),v(I,{key:0,dense:""},{default:i(()=>[(u(!0),f(k,null,P(o.topDepartamentos,(s,g)=>(u(),v(q,{key:g},{default:i(()=>[a(y,{avatar:""},{default:i(()=>[a(S,{color:["primary","secondary","accent"][g],"text-color":"white"},{default:i(()=>[d(p(g+1),1)]),_:2},1032,["color"])]),_:2},1024),a(y,null,{default:i(()=>[a(w,null,{default:i(()=>[d(p(s.nombre),1)]),_:2},1024),a(w,{caption:""},{default:i(()=>[d(p(s.kg)+" Kg",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(u(),f("div",pa,"Sin datos"))]),_:1})]),_:1})]),r("div",ma,[a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingTablas},null,8,["showing"]),e[16]||(e[16]=r("div",{class:"text-subtitle1 q-mb-md"},"Top 3 Municipios",-1)),o.topMunicipios.length>0?(u(),v(I,{key:0,dense:""},{default:i(()=>[(u(!0),f(k,null,P(o.topMunicipios,(s,g)=>(u(),v(q,{key:g},{default:i(()=>[a(y,{avatar:""},{default:i(()=>[a(S,{color:["primary","secondary","accent"][g],"text-color":"white"},{default:i(()=>[d(p(g+1),1)]),_:2},1032,["color"])]),_:2},1024),a(y,null,{default:i(()=>[a(w,null,{default:i(()=>[d(p(s.nombre),1)]),_:2},1024),a(w,{caption:""},{default:i(()=>[d(p(s.kg)+" Kg",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(u(),f("div",fa,"Sin datos"))]),_:1})]),_:1})]),r("div",ba,[a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingTablas},null,8,["showing"]),e[17]||(e[17]=r("div",{class:"text-subtitle1 q-mb-md"},"Top 3 Organizaciones",-1)),o.topOrganizaciones.length>0?(u(),v(I,{key:0,dense:""},{default:i(()=>[(u(!0),f(k,null,P(o.topOrganizaciones,(s,g)=>(u(),v(q,{key:g},{default:i(()=>[a(y,{avatar:""},{default:i(()=>[a(S,{color:["primary","secondary","accent"][g],"text-color":"white"},{default:i(()=>[d(p(g+1),1)]),_:2},1032,["color"])]),_:2},1024),a(y,null,{default:i(()=>[a(w,null,{default:i(()=>[d(p(s.nombre),1)]),_:2},1024),a(w,{caption:""},{default:i(()=>[d(p(s.kg)+" Kg",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(u(),f("div",ha,"Sin datos"))]),_:1})]),_:1})])])]),_:1}),a(D,{name:"geografico"},{default:i(()=>[r("div",va,[r("div",_a,[a(A,{modelValue:o.filtroDepartamento,"onUpdate:modelValue":[e[3]||(e[3]=s=>o.filtroDepartamento=s),l.onDepartamentoChange],options:o.departamentos,"option-label":"nombre_departamento","option-value":"id",label:"Departamento",dense:"",outlined:"",clearable:"","emit-value":"","map-options":""},null,8,["modelValue","options","onUpdate:modelValue"])]),r("div",ya,[a(A,{modelValue:o.filtroMunicipio,"onUpdate:modelValue":[e[4]||(e[4]=s=>o.filtroMunicipio=s),l.aplicarFiltroGeografico],options:o.municipios,"option-label":"nombre_municipio","option-value":"id",label:"Municipio",dense:"",outlined:"",clearable:"","emit-value":"","map-options":"",disable:!o.filtroDepartamento},null,8,["modelValue","options","disable","onUpdate:modelValue"])]),r("div",wa,[a(F,{color:"primary",label:"Aplicar Filtros",icon:"filter_alt",onClick:l.aplicarFiltroGeografico,disable:!o.filtroDepartamento,"no-caps":""},null,8,["onClick","disable"])])]),a(m,{flat:"",bordered:"",class:"q-mb-md"},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingGraficos},null,8,["showing"]),r("div",xa,[e[19]||(e[19]=d(" Distribución Geográfica de Acopios ")),a(_,{name:"info",size:"xs",color:"grey-6"},{default:i(()=>[a(G,null,{default:i(()=>e[18]||(e[18]=[d("Comparativa de acopio por ubicación geográfica")])),_:1})]),_:1})]),!o.loadingGraficos&&o.datosGeograficos.length===0?(u(),f("div",Aa,[a(Q,{class:"bg-info text-white",rounded:"",dense:""},{avatar:i(()=>[a(_,{name:"info"})]),default:i(()=>[e[20]||(e[20]=d(" Seleccione un departamento para visualizar datos "))]),_:1})])):(u(),f("canvas",Ga,null,512))]),_:1})]),_:1}),a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[r("div",ka,[e[21]||(e[21]=r("div",{class:"text-subtitle1"},"Detalle por Ubicación",-1)),a(O),a(F,{flat:"",dense:"",icon:"download",color:"primary",label:"Exportar",onClick:e[5]||(e[5]=s=>l.exportarDashboard("geografico")),disable:o.tablaGeografica.length===0,"no-caps":""},null,8,["disable"])]),a(T,{rows:o.tablaGeografica,columns:o.columnasGeograficas,"row-key":"ubicacion",dense:"",flat:"",loading:o.loadingTablas,pagination:o.paginacionGeo,"binary-state-sort":""},{"body-cell-porcentaje":i(s=>[a(E,{props:s},{default:i(()=>[a(M,{value:s.row.porcentaje/100,color:"primary",size:"md",class:"q-mb-xs"},null,8,["value"]),r("div",Pa,p(s.row.porcentaje)+"%",1)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","pagination"])]),_:1})]),_:1})]),_:1}),a(D,{name:"productos"},{default:i(()=>[r("div",Ca,[r("div",Da,[a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingGraficos},null,8,["showing"]),r("div",Ta,[e[23]||(e[23]=d(" Distribución por Tipo de Producto ")),a(_,{name:"info",size:"xs",color:"grey-6"},{default:i(()=>[a(G,null,{default:i(()=>e[22]||(e[22]=[d("Proporción de acopio por cada tipo de producto")])),_:1})]),_:1})]),!o.loadingGraficos&&o.datosProductos.length===0?(u(),f("div",za,[a(Q,{class:"bg-info text-white",rounded:"",dense:""},{avatar:i(()=>[a(_,{name:"info"})]),default:i(()=>[e[24]||(e[24]=d(" No hay datos disponibles para los filtros seleccionados "))]),_:1})])):(u(),f("canvas",Fa,null,512))]),_:1})]),_:1})]),r("div",Sa,[a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingTablas},null,8,["showing"]),e[25]||(e[25]=r("div",{class:"text-subtitle1 q-mb-md"},"Distribución Geográfica",-1)),a(T,{rows:o.tablaDistribucionProducto,columns:o.columnasDistribucionProducto,"row-key":"ubicacion",dense:"",flat:"",pagination:{rowsPerPage:5}},null,8,["rows","columns"])]),_:1})]),_:1})])])]),_:1}),a(D,{name:"temporal"},{default:i(()=>[r("div",Ka,[r("div",qa,[a(A,{modelValue:o.gestionesComparar,"onUpdate:modelValue":[e[6]||(e[6]=s=>o.gestionesComparar=s),l.generarGraficoTemporal],options:o.gestiones,label:"Gestiones a Comparar (máx. 3)",dense:"",outlined:"",multiple:"","use-chips":"","max-values":"3"},null,8,["modelValue","options","onUpdate:modelValue"])])]),a(m,{flat:"",bordered:"",class:"q-mb-md"},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingGraficos},null,8,["showing"]),r("div",Qa,[e[27]||(e[27]=d(" Evolución Mensual Comparativa ")),a(_,{name:"info",size:"xs",color:"grey-6"},{default:i(()=>[a(G,null,{default:i(()=>e[26]||(e[26]=[d("Comparación de acopio mensual entre gestiones")])),_:1})]),_:1})]),r("canvas",Ia,null,512)]),_:1})]),_:1}),r("div",Ea,[r("div",Oa,[a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingTablas},null,8,["showing"]),e[28]||(e[28]=r("div",{class:"text-subtitle1 q-mb-md"},"Análisis de Estacionalidad",-1)),a(T,{rows:o.tablaEstacionalidad,columns:o.columnasEstacionalidad,"row-key":"mes",dense:"",flat:"",pagination:{rowsPerPage:12}},{"body-cell-tendencia":i(s=>[a(E,{props:s},{default:i(()=>[a(j,{color:s.row.ranking<=3?"positive":s.row.ranking>=10?"negative":"grey",label:s.row.ranking<=3?"Alto":s.row.ranking>=10?"Bajo":"Medio"},null,8,["color","label"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})]),r("div",Va,[a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingTablas},null,8,["showing"]),e[29]||(e[29]=r("div",{class:"text-subtitle1 q-mb-md"},"Comparativa Año vs Año",-1)),a(T,{rows:o.tablaComparativa,columns:o.columnasComparativa,"row-key":"mes",dense:"",flat:"",pagination:{rowsPerPage:12}},{"body-cell-variacion":i(s=>[a(E,{props:s},{default:i(()=>[a(j,{color:s.row.variacion>=0?"positive":"negative",icon:s.row.variacion>=0?"trending_up":"trending_down",label:s.row.variacion.toFixed(2)+"%"},null,8,["color","icon","label"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})])])]),_:1}),a(D,{name:"organizacional"},{default:i(()=>[a(m,{flat:"",bordered:"",class:"q-mb-md"},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingTablas},null,8,["showing"]),r("div",Ma,[e[30]||(e[30]=r("div",{class:"text-subtitle1"},"Ranking de Organizaciones",-1)),a(O),a(F,{flat:"",dense:"",icon:"download",color:"primary",label:"Exportar",onClick:e[7]||(e[7]=s=>l.exportarDashboard("organizacional")),disable:o.tablaOrganizaciones.length===0,"no-caps":""},null,8,["disable"])]),a(T,{rows:o.tablaOrganizaciones,columns:o.columnasOrganizaciones,"row-key":"asociacion",dense:"",flat:"",pagination:{rowsPerPage:10}},{"body-cell-posicion":i(s=>[a(E,{props:s},{default:i(()=>[a(S,{color:s.row.posicion<=3?"primary":"grey","text-color":"white",size:"sm"},{default:i(()=>[d(p(s.row.posicion),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1}),r("div",ja,[r("div",Ua,[a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingGraficos},null,8,["showing"]),r("div",Ra,[e[32]||(e[32]=d(" Performance por Organización ")),a(_,{name:"info",size:"xs",color:"grey-6"},{default:i(()=>[a(G,null,{default:i(()=>e[31]||(e[31]=[d("Acopio mensual de organización seleccionada")])),_:1})]),_:1})]),a(A,{modelValue:o.orgSeleccionada,"onUpdate:modelValue":[e[8]||(e[8]=s=>o.orgSeleccionada=s),l.generarGraficoPerformanceOrg],options:o.listaOrganizaciones,"option-label":"asociacion",label:"Seleccionar Organización",dense:"",outlined:"",class:"q-mb-md"},null,8,["modelValue","options","onUpdate:modelValue"]),r("canvas",Na,null,512)]),_:1})]),_:1})]),r("div",Ba,[a(m,{flat:"",bordered:""},{default:i(()=>[a(b,null,{default:i(()=>[a(h,{showing:o.loadingTablas},null,8,["showing"]),e[33]||(e[33]=r("div",{class:"text-subtitle1 q-mb-md"},"Mapa de Contribución Nacional",-1)),a(I,{dense:""},{default:i(()=>[(u(!0),f(k,null,P(o.tablaContribucion,s=>(u(),v(q,{key:s.asociacion},{default:i(()=>[a(y,null,{default:i(()=>[a(w,null,{default:i(()=>[d(p(s.asociacion),1)]),_:2},1024),a(M,{value:s.porcentaje/100,color:"primary",size:"lg",class:"q-mt-xs"},null,8,["value"])]),_:2},1024),a(y,{side:""},{default:i(()=>[a(w,{caption:""},{default:i(()=>[d(p(s.porcentaje)+"%",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}const bo=N(H,[["render",Ja],["__scopeId","data-v-fc72f3b9"]]);export{bo as default};
