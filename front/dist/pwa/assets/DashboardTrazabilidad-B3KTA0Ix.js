import{Q as K}from"./QSelect-CE_gFS-5.js";import{a as M,Q as O,c as S,b as U}from"./QTabPanels-COuTR9Jx.js";import{_ as V,a9 as g,o as n,a as e,c as b,a8 as k,b as t,w as s,e as c,O as y,ae as Y,Q as m,d as h,t as i,a7 as u,aa as T,ab as C,v as G,z as Z,A as F,aN as $,x as Q,C as J,j as v,y as j,G as W,J as X,g as tt,aO as et,a6 as P,ag as st,ak as at,f as L}from"./index-BYmx5CNZ.js";import{Q as ot}from"./QPage-p00VibaV.js";import{Q as z}from"./QBadge-XCEdf9Kh.js";import{Q as R}from"./QMarkupTable-CxD-gDWx.js";import{Q as q,b as x,a as p}from"./position-engine-WcV6P5pk.js";import{Q as A}from"./QList-BvaTzhwT.js";import{Q as B}from"./QBanner-DRdTdlhT.js";import{h as H}from"./moment-C5S46NFB.js";import"./auto-fljMw0yZ.js";import{C as I}from"./chart-DihOV3X-.js";import it from"./DashboardVentas-CNCaD5Y3.js";import"./QChip-BFVaIQP4.js";import"./format-WFf_bcNU.js";import"./QResizeObserver-CpmGT2BI.js";import"./use-panel-DWGxyhPB.js";import"./touch-BjYP5sR0.js";import"./selection-BcgxACWv.js";import"./use-render-cache-DLxPkVnQ.js";import"./QTooltip-BGE4xi2l.js";import"./QBtnGroup-CGN2IjQ1.js";import"./ClosePopup-DF6m3UZZ.js";const rt={name:"TrazabilidadAtras",props:{gestion:{type:Number,required:!0}},data(){return{loading:!1,capacidad:null,alertas:[],senasag:null,transporte:null}},mounted(){this.cargarDatos()},methods:{formatNumber(r){return Number(r||0).toLocaleString("es-BO",{minimumFractionDigits:2,maximumFractionDigits:2})},formatFecha(r){return H(r).format("DD/MM/YYYY HH:mm")},async cargarDatos(){this.loading=!0;try{await Promise.all([this.cargarCapacidad(),this.cargarAlertas(),this.cargarSenasag(),this.cargarTransporte()])}finally{this.loading=!1}},async cargarCapacidad(){try{const{data:r}=await this.$axios.get("/dashboard-trazabilidad/capacidad-productiva",{params:{gestion:this.gestion}});this.capacidad=r.resumen}catch{this.$q.notify({type:"negative",message:"Error al cargar capacidad productiva"})}},async cargarAlertas(){try{const{data:r}=await this.$axios.get("/dashboard-trazabilidad/alertas-sobreproduccion",{params:{gestion:this.gestion,limit:10}});this.alertas=r.alertas}catch{this.$q.notify({type:"negative",message:"Error al cargar alertas"})}},async cargarSenasag(){try{const{data:r}=await this.$axios.get("/dashboard-trazabilidad/senasag",{params:{gestion:this.gestion}});this.senasag=r}catch{this.$q.notify({type:"negative",message:"Error al cargar datos SENASAG"})}},async cargarTransporte(){try{const{data:r}=await this.$axios.get("/dashboard-trazabilidad/transporte-apiarios",{params:{gestion:this.gestion,limit:20}});this.transporte=r.resumen,this.transporte.ultimos_transportes=r.ultimos_transportes}catch{this.$q.notify({type:"negative",message:"Error al cargar transporte"})}}},watch:{gestion(){this.cargarDatos()}}},lt={class:"q-gutter-md"},nt={class:"text-center"},dt={class:"row q-col-gutter-md"},ct={class:"col-12 col-sm-6 col-md-3"},ut={class:"text-h4 text-primary q-mt-sm"},mt={class:"text-body2 q-mt-xs"},_t={class:"col-12 col-sm-6 col-md-3"},ft={class:"text-h4 text-orange q-mt-sm"},pt={class:"col-12 col-sm-6 col-md-3"},gt={class:"text-h4 text-positive q-mt-sm"},ht={class:"text-body2 q-mt-xs"},bt={class:"col-12 col-sm-6 col-md-3"},xt={class:"text-h4 text-info q-mt-sm"},vt={class:"text-body2 q-mt-xs"},yt={class:"row items-center"},qt={class:"col-auto"},kt={class:"text-left"},zt={class:"text-left"},Tt={class:"text-right"},Ct={class:"text-right"},wt={class:"text-right text-warning text-weight-bold"},Nt={class:"text-right"},At={class:"row q-col-gutter-md"},Dt={class:"col-12 col-md-6"},Mt={class:"q-mb-md"},St={class:"row q-col-gutter-sm"},Et={class:"col-6"},Qt={class:"text-h5"},Pt={class:"col-6"},Rt={class:"text-h5 text-warning"},Vt={class:"text-caption"},Ft={class:"col-12 col-md-6"},It={class:"text-h5 q-mb-md"},jt={class:"row q-col-gutter-md q-mb-md"},Bt={class:"col-4"},Lt={class:"text-h5"},Ot={class:"col-4"},Ut={class:"text-h5"},Yt={class:"col-4"},Gt={class:"text-h5 text-warning"},$t={class:"text-caption"},Ht={class:"text-left"},Kt={class:"text-left"},Zt={class:"text-right"},Jt={class:"text-center"},Wt={class:"text-center"},Xt={class:"row items-center"},te={class:"col-auto"};function ee(r,a,_,N,o,d){return n(),g("div",lt,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>a[0]||(a[0]=[t("div",{class:"text-h6"},"Capacidad Productiva vs Producción Real",-1),t("div",{class:"text-caption text-grey-7"}," Análisis de capacidad teórica y producción efectiva ",-1)])),_:1}),e(y),o.loading?(n(),b(c,{key:0},{default:s(()=>[t("div",nt,[e(Y,{color:"primary",size:"3em"})])]),_:1})):o.capacidad?(n(),b(c,{key:1},{default:s(()=>[t("div",dt,[t("div",ct,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"people",size:"md",color:"primary"}),t("div",ut,i(o.capacidad.total_productores),1),a[1]||(a[1]=t("div",{class:"text-caption text-grey-7"},"Productores Activos",-1)),t("div",mt,i(o.capacidad.total_colmenas)+" colmenas",1)]),_:1})]),_:1})]),t("div",_t,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"trending_up",size:"md",color:"orange"}),t("div",ft,i(d.formatNumber(o.capacidad.capacidad_teorica)),1),a[2]||(a[2]=t("div",{class:"text-caption text-grey-7"},"Capacidad Teórica (kg)",-1)),a[3]||(a[3]=t("div",{class:"text-body2 q-mt-xs"},"25 kg/colmena",-1))]),_:1})]),_:1})]),t("div",pt,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"check_circle",size:"md",color:"positive"}),t("div",gt,i(d.formatNumber(o.capacidad.produccion_real)),1),a[4]||(a[4]=t("div",{class:"text-caption text-grey-7"},"Producción Real (kg)",-1)),t("div",ht,i(o.capacidad.eficiencia)+"% eficiencia",1)]),_:1})]),_:1})]),t("div",bt,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"hourglass_empty",size:"md",color:"info"}),t("div",xt,i(d.formatNumber(o.capacidad.produccion_esperada_restante)),1),a[5]||(a[5]=t("div",{class:"text-caption text-grey-7"},"Restante Esperado (kg)",-1)),t("div",vt,i(o.capacidad.meta_mensual)+" kg/mes",1)]),_:1})]),_:1})])])]),_:1})):k("",!0)]),_:1}),o.alertas&&o.alertas.length>0?(n(),b(m,{key:0,flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>[t("div",yt,[a[6]||(a[6]=t("div",{class:"col"},[t("div",{class:"text-h6"},"Alertas de Sobreproducción"),t("div",{class:"text-caption text-grey-7"}," Productores con producción superior a su capacidad teórica ")],-1)),t("div",qt,[e(z,{color:"warning",outline:""},{default:s(()=>[u(i(o.alertas.length)+" alertas ",1)]),_:1})])])]),_:1}),e(y),e(c,null,{default:s(()=>[e(R,{dense:"",flat:""},{default:s(()=>[a[7]||(a[7]=t("thead",null,[t("tr",null,[t("th",{class:"text-left"},"Productor"),t("th",{class:"text-left"},"RUNSA"),t("th",{class:"text-right"},"Capacidad (kg)"),t("th",{class:"text-right"},"Producción (kg)"),t("th",{class:"text-right"},"Diferencia (kg)"),t("th",{class:"text-right"},"Exceso (%)")])],-1)),t("tbody",null,[(n(!0),g(T,null,C(o.alertas,l=>(n(),g("tr",{key:l.productor_id},[t("td",kt,i(l.productor),1),t("td",zt,i(l.runsa||"N/A"),1),t("td",Tt,i(d.formatNumber(l.capacidad_teorica)),1),t("td",Ct,i(d.formatNumber(l.produccion_real)),1),t("td",wt,"+"+i(d.formatNumber(l.diferencia)),1),t("td",Nt,[e(z,{color:"warning"},{default:s(()=>[u(i(l.porcentaje_sobre_capacidad)+"%",1)]),_:2},1024)])]))),128))])]),_:1})]),_:1})]),_:1})):k("",!0),t("div",At,[t("div",Dt,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>a[8]||(a[8]=[t("div",{class:"text-h6"},"Control de Plagas",-1),t("div",{class:"text-caption text-grey-7"}," Registros SENASAG de control fitosanitario ",-1)])),_:1}),e(y),o.senasag&&o.senasag.plagas?(n(),b(c,{key:0},{default:s(()=>[t("div",Mt,[t("div",St,[t("div",Et,[a[9]||(a[9]=t("div",{class:"text-caption text-grey-7"},"Total Registros",-1)),t("div",Qt,i(o.senasag.plagas.total_registros),1)]),t("div",Pt,[a[10]||(a[10]=t("div",{class:"text-caption text-grey-7"},"Colmenas Afectadas",-1)),t("div",Rt,[u(i(o.senasag.plagas.colmenas_afectadas)+" ",1),t("span",Vt,"("+i(o.senasag.plagas.porcentaje_afectacion)+"%)",1)])])])]),a[11]||(a[11]=t("div",{class:"text-subtitle2 q-mb-sm"},"Plagas Más Comunes",-1)),e(A,{bordered:"",separator:"",dense:""},{default:s(()=>[(n(!0),g(T,null,C(o.senasag.plagas.mas_comunes,l=>(n(),b(q,{key:l.nombre},{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>[u(i(l.nombre),1)]),_:2},1024),e(p,{caption:""},{default:s(()=>[u(i(l.casos)+" casos",1)]),_:2},1024)]),_:2},1024),e(x,{side:""},{default:s(()=>[e(z,{color:"orange"},{default:s(()=>[u(i(l.colmenas_afectadas)+" colmenas",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):k("",!0)]),_:1})]),t("div",Ft,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>a[12]||(a[12]=[t("div",{class:"text-h6"},"Aplicación de Medicamentos",-1),t("div",{class:"text-caption text-grey-7"}," Tratamientos farmacológicos aplicados ",-1)])),_:1}),e(y),o.senasag&&o.senasag.medicamentos?(n(),b(c,{key:0},{default:s(()=>[t("div",It,i(o.senasag.medicamentos.total_registros)+" aplicaciones",1),a[13]||(a[13]=t("div",{class:"text-subtitle2 q-mb-sm"},"Productos Más Usados",-1)),e(A,{bordered:"",separator:"",dense:""},{default:s(()=>[(n(!0),g(T,null,C(o.senasag.medicamentos.mas_usados,l=>(n(),b(q,{key:l.producto},{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>[u(i(l.producto),1)]),_:2},1024),e(p,{caption:""},{default:s(()=>[u(i(l.principio_activo),1)]),_:2},1024)]),_:2},1024),e(x,{side:""},{default:s(()=>[e(z,{color:"primary"},{default:s(()=>[u(i(l.aplicaciones)+" veces",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):k("",!0)]),_:1})])]),o.transporte?(n(),b(m,{key:1,flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>a[14]||(a[14]=[t("div",{class:"text-h6"},"Transporte desde Apiarios",-1),t("div",{class:"text-caption text-grey-7"}," Control de condiciones de transporte de materia prima ",-1)])),_:1}),e(y),e(c,null,{default:s(()=>[t("div",jt,[t("div",Bt,[a[15]||(a[15]=t("div",{class:"text-caption text-grey-7"},"Total Transportes",-1)),t("div",Lt,i(o.transporte.total_transportes),1)]),t("div",Ot,[a[16]||(a[16]=t("div",{class:"text-caption text-grey-7"},"Temperatura Promedio",-1)),t("div",Ut,i(o.transporte.temperatura_promedio)+"°C",1)]),t("div",Yt,[a[17]||(a[17]=t("div",{class:"text-caption text-grey-7"},"Fuera de Rango",-1)),t("div",Gt,[u(i(o.transporte.transportes_fuera_rango)+" ",1),t("span",$t,"("+i(o.transporte.porcentaje_fuera_rango)+"%)",1)])])]),a[19]||(a[19]=t("div",{class:"text-subtitle2 q-mb-sm"},"Últimos Transportes",-1)),e(R,{dense:"",flat:""},{default:s(()=>[a[18]||(a[18]=t("thead",null,[t("tr",null,[t("th",{class:"text-left"},"Fecha"),t("th",{class:"text-left"},"Apiario"),t("th",{class:"text-right"},"Cantidad (kg)"),t("th",{class:"text-center"},"Temperatura"),t("th",{class:"text-center"},"Estado")])],-1)),t("tbody",null,[(n(!0),g(T,null,C(o.transporte.ultimos_transportes.slice(0,10),(l,f)=>(n(),g("tr",{key:f},[t("td",Ht,i(d.formatFecha(l.fecha)),1),t("td",Kt,i(l.apiario),1),t("td",Zt,i(d.formatNumber(l.cantidad_kg)),1),t("td",Jt,i(l.temperatura)+"°C",1),t("td",Wt,[e(z,{color:l.estado_temperatura==="CONFORME"?"positive":"warning"},{default:s(()=>[u(i(l.estado_temperatura==="CONFORME"?"Conforme":"Alerta"),1)]),_:2},1032,["color"])])]))),128))])]),_:1})]),_:1})]),_:1})):k("",!0),e(m,{flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>[t("div",Xt,[a[21]||(a[21]=t("div",{class:"col"},[t("div",{class:"text-h6"},"Mortandad de Colmenas"),t("div",{class:"text-caption text-grey-7"}," Registro de pérdidas y causas ")],-1)),t("div",te,[e(z,{color:"grey",outline:""},{default:s(()=>a[20]||(a[20]=[u("Funcionalidad Pendiente")])),_:1})])])]),_:1}),e(y),e(c,null,{default:s(()=>[e(B,{class:"bg-grey-2"},{avatar:s(()=>[e(h,{name:"info",color:"info"})]),default:s(()=>[a[22]||(a[22]=u(" Esta sección estará disponible una vez implementado el formulario de captura de mortandad de colmenas. Se registrarán datos como: fecha, número de colmenas muertas, causa, pérdida estimada y acciones correctivas. "))]),_:1})]),_:1})]),_:1})])}const se=V(rt,[["render",ee]]),ae={name:"TrazabilidadProceso",props:{gestion:{type:Number,required:!0}},data(){return{loading:!1,recepcion:null,procesamiento:null,lotes:null,metodos:null,chartRecepcionInstance:null,chartMermaInstance:null,chartMetodosInstance:null}},mounted(){this.cargarDatos()},beforeUnmount(){this.chartRecepcionInstance&&this.chartRecepcionInstance.destroy(),this.chartMermaInstance&&this.chartMermaInstance.destroy(),this.chartMetodosInstance&&this.chartMetodosInstance.destroy()},methods:{formatNumber(r){return Number(r||0).toLocaleString("es-BO",{minimumFractionDigits:2,maximumFractionDigits:2})},getEstadoTanque(r){return r>80?"Crítico":r>60?"Medio":"Normal"},async cargarDatos(){this.loading=!0;try{await Promise.all([this.cargarRecepcion(),this.cargarProcesamiento(),this.cargarLotes(),this.cargarMetodos()])}finally{this.loading=!1}},async cargarRecepcion(){try{const{data:r}=await this.$axios.get("/dashboard-trazabilidad/recepcion-rechazos",{params:{gestion:this.gestion}});this.recepcion=r.resumen,this.recepcion.motivos_rechazo=r.motivos_rechazo,this.recepcion.evolucion_mensual=r.evolucion_mensual,this.$nextTick(()=>{this.renderChartRecepcion()})}catch{this.$q.notify({type:"negative",message:"Error al cargar recepción"})}},async cargarProcesamiento(){try{const{data:r}=await this.$axios.get("/dashboard-trazabilidad/procesamiento-merma",{params:{gestion:this.gestion}});this.procesamiento=r.resumen,this.procesamiento.eficiencia_tanques=r.eficiencia_tanques,this.$nextTick(()=>{this.renderChartMerma()})}catch{this.$q.notify({type:"negative",message:"Error al cargar procesamiento"})}},async cargarLotes(){try{const{data:r}=await this.$axios.get("/dashboard-trazabilidad/lotes-almacenamiento",{params:{gestion:this.gestion}});this.lotes=r.resumen,this.lotes.detalle_tanques=r.detalle_tanques}catch{this.$q.notify({type:"negative",message:"Error al cargar lotes"})}},async cargarMetodos(){try{const{data:r}=await this.$axios.get("/dashboard-trazabilidad/metodos-procesamiento",{params:{gestion:this.gestion}});this.metodos=r,this.$nextTick(()=>{this.renderChartMetodos()})}catch{this.$q.notify({type:"negative",message:"Error al cargar métodos"})}},renderChartRecepcion(){if(!this.recepcion||!this.recepcion.evolucion_mensual)return;this.chartRecepcionInstance&&this.chartRecepcionInstance.destroy();const r=this.$refs.chartRecepcion;if(!r)return;const a=this.recepcion.evolucion_mensual;this.chartRecepcionInstance=new I(r,{type:"line",data:{labels:a.map(_=>`${_.mes}/${this.gestion}`),datasets:[{label:"Validados",data:a.map(_=>_.validados),borderColor:"#21BA45",backgroundColor:"rgba(33, 186, 69, 0.1)",tension:.4},{label:"Rechazados",data:a.map(_=>_.rechazados),borderColor:"#C10015",backgroundColor:"rgba(193, 0, 21, 0.1)",tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}},scales:{y:{beginAtZero:!0}}}})},renderChartMerma(){if(!this.procesamiento||!this.procesamiento.eficiencia_tanques)return;this.chartMermaInstance&&this.chartMermaInstance.destroy();const r=this.$refs.chartMerma;if(!r)return;const a=this.procesamiento.eficiencia_tanques;this.chartMermaInstance=new I(r,{type:"bar",data:{labels:a.map(_=>_.tanque),datasets:[{label:"Merma %",data:a.map(_=>_.merma_porcentaje),backgroundColor:a.map(_=>_.merma_porcentaje>5?"#F2C037":"#21BA45")}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Porcentaje de Merma"}}}}})},renderChartMetodos(){if(!this.metodos||!this.metodos.metodos_usados)return;this.chartMetodosInstance&&this.chartMetodosInstance.destroy();const r=this.$refs.chartMetodos;if(!r)return;const a=this.metodos.metodos_usados;this.chartMetodosInstance=new I(r,{type:"scatter",data:{datasets:a.map(_=>({label:_.metodo,data:[{x:_.usos,y:_.eficiencia_promedio}],backgroundColor:_.eficiencia_promedio>95?"#21BA45":"#F2C037"}))},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}},scales:{x:{title:{display:!0,text:"Número de Usos"}},y:{title:{display:!0,text:"Eficiencia %"},min:90,max:100}}}})}},watch:{gestion(){this.cargarDatos()}}},oe={class:"q-gutter-md"},ie={class:"text-center"},re={class:"row q-col-gutter-md q-mb-md"},le={class:"col-12 col-sm-6 col-md-3"},ne={class:"text-h4 text-primary q-mt-sm"},de={class:"text-body2 q-mt-xs"},ce={class:"col-12 col-sm-6 col-md-3"},ue={class:"text-h4 text-positive q-mt-sm"},me={class:"text-body2 q-mt-xs"},_e={class:"col-12 col-sm-6 col-md-3"},fe={class:"text-h4 text-negative q-mt-sm"},pe={class:"text-body2 q-mt-xs"},ge={class:"col-12 col-sm-6 col-md-3"},he={class:"text-h4 text-info q-mt-sm"},be={class:"row q-col-gutter-md"},xe={class:"col-12 col-md-6"},ve={class:"col-12 col-md-6"},ye={style:{height:"300px"}},qe={ref:"chartRecepcion"},ke={class:"row q-col-gutter-md q-mb-md"},ze={class:"col-12 col-md-3"},Te={class:"text-h4 text-primary q-mt-sm"},Ce={class:"col-12 col-md-3"},we={class:"text-h4 text-blue q-mt-sm"},Ne={class:"col-12 col-md-3"},Ae={class:"text-h4 text-positive q-mt-sm"},De={class:"col-12 col-md-3"},Me={class:"text-h4 text-warning q-mt-sm"},Se={class:"text-body2 q-mt-xs"},Ee={class:"row q-col-gutter-md"},Qe={class:"col-12 col-md-6"},Pe={class:"text-left"},Re={class:"text-right"},Ve={class:"text-right"},Fe={class:"text-right"},Ie={class:"text-right"},je={class:"col-12 col-md-6"},Be={style:{height:"300px"}},Le={ref:"chartMerma"},Oe={class:"row q-col-gutter-md q-mb-md"},Ue={class:"col-12 col-md-3"},Ye={class:"text-h4 text-primary q-mt-sm"},Ge={class:"col-12 col-md-3"},$e={class:"text-h4 text-positive q-mt-sm"},He={class:"col-12 col-md-3"},Ke={class:"text-h4 text-info q-mt-sm"},Ze={class:"col-12 col-md-3"},Je={class:"text-h4 text-warning q-mt-sm"},We={class:"text-left"},Xe={class:"text-left"},ts={class:"text-right"},es={class:"text-right"},ss={class:"text-right"},as={class:"text-center"},os={class:"row q-col-gutter-md"},is={class:"col-12 col-md-6"},rs={class:"col-12 col-md-6"},ls={style:{height:"300px"}},ns={ref:"chartMetodos"};function ds(r,a,_,N,o,d){return n(),g("div",oe,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>a[0]||(a[0]=[t("div",{class:"text-h6"},"Recepción y Rechazos",-1),t("div",{class:"text-caption text-grey-7"}," Control de acopio, validación y motivos de rechazo ",-1)])),_:1}),e(y),o.loading?(n(),b(c,{key:0},{default:s(()=>[t("div",ie,[e(Y,{color:"primary",size:"3em"})])]),_:1})):o.recepcion?(n(),b(c,{key:1},{default:s(()=>[t("div",re,[t("div",le,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"inbox",size:"md",color:"primary"}),t("div",ne,i(o.recepcion.total_acopios),1),a[1]||(a[1]=t("div",{class:"text-caption text-grey-7"},"Total Acopios",-1)),t("div",de,i(d.formatNumber(o.recepcion.cantidad_total))+" kg",1)]),_:1})]),_:1})]),t("div",ce,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"check_circle",size:"md",color:"positive"}),t("div",ue,i(o.recepcion.acopios_validados),1),a[2]||(a[2]=t("div",{class:"text-caption text-grey-7"},"Validados",-1)),t("div",me,i(d.formatNumber(o.recepcion.cantidad_validada))+" kg",1)]),_:1})]),_:1})]),t("div",_e,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"cancel",size:"md",color:"negative"}),t("div",fe,i(o.recepcion.acopios_rechazados),1),a[3]||(a[3]=t("div",{class:"text-caption text-grey-7"},"Rechazados",-1)),t("div",pe,i(d.formatNumber(o.recepcion.cantidad_rechazada))+" kg ("+i(o.recepcion.porcentaje_rechazo)+"%)",1)]),_:1})]),_:1})]),t("div",ge,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"compare",size:"md",color:"info"}),t("div",he,i(o.recepcion.tasa_validacion)+"%",1),a[4]||(a[4]=t("div",{class:"text-caption text-grey-7"},"Tasa de Validación",-1)),a[5]||(a[5]=t("div",{class:"text-body2 q-mt-xs"},"Calidad promedio",-1))]),_:1})]),_:1})])]),t("div",be,[t("div",xe,[a[6]||(a[6]=t("div",{class:"text-subtitle2 q-mb-sm"},"Motivos de Rechazo",-1)),e(A,{bordered:"",separator:""},{default:s(()=>[(n(!0),g(T,null,C(o.recepcion.motivos_rechazo,l=>(n(),b(q,{key:l.motivo},{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>[u(i(l.motivo),1)]),_:2},1024),e(p,{caption:""},{default:s(()=>[u(i(l.casos)+" casos - "+i(d.formatNumber(l.cantidad_kg))+" kg",1)]),_:2},1024)]),_:2},1024),e(x,{side:""},{default:s(()=>[e(z,{color:"negative"},{default:s(()=>[u(i(l.porcentaje)+"%",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t("div",ve,[a[7]||(a[7]=t("div",{class:"text-subtitle2 q-mb-sm"},"Evolución Mensual",-1)),t("div",ye,[t("canvas",qe,null,512)])])])]),_:1})):k("",!0)]),_:1}),o.procesamiento?(n(),b(m,{key:0,flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>a[8]||(a[8]=[t("div",{class:"text-h6"},"Procesamiento y Merma",-1),t("div",{class:"text-caption text-grey-7"}," Eficiencia del procesamiento y análisis de pérdidas ",-1)])),_:1}),e(y),e(c,null,{default:s(()=>[t("div",ke,[t("div",ze,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"factory",size:"md",color:"primary"}),t("div",Te,i(o.procesamiento.procesos_finalizados),1),a[9]||(a[9]=t("div",{class:"text-caption text-grey-7"},"Procesos Finalizados",-1))]),_:1})]),_:1})]),t("div",Ce,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"input",size:"md",color:"blue"}),t("div",we,i(d.formatNumber(o.procesamiento.entrada_total)),1),a[10]||(a[10]=t("div",{class:"text-caption text-grey-7"},"Entrada Total (kg)",-1))]),_:1})]),_:1})]),t("div",Ne,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"output",size:"md",color:"positive"}),t("div",Ae,i(d.formatNumber(o.procesamiento.salida_total)),1),a[11]||(a[11]=t("div",{class:"text-caption text-grey-7"},"Salida Total (kg)",-1))]),_:1})]),_:1})]),t("div",De,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"trending_down",size:"md",color:"warning"}),t("div",Me,i(o.procesamiento.merma_promedio)+"%",1),a[12]||(a[12]=t("div",{class:"text-caption text-grey-7"},"Merma Promedio",-1)),t("div",Se,i(d.formatNumber(o.procesamiento.merma_total))+" kg",1)]),_:1})]),_:1})])]),t("div",Ee,[t("div",Qe,[a[14]||(a[14]=t("div",{class:"text-subtitle2 q-mb-sm"},"Eficiencia por Tanque",-1)),e(R,{dense:"",flat:""},{default:s(()=>[a[13]||(a[13]=t("thead",null,[t("tr",null,[t("th",{class:"text-left"},"Tanque"),t("th",{class:"text-right"},"Procesos"),t("th",{class:"text-right"},"Entrada (kg)"),t("th",{class:"text-right"},"Salida (kg)"),t("th",{class:"text-right"},"Merma %")])],-1)),t("tbody",null,[(n(!0),g(T,null,C(o.procesamiento.eficiencia_tanques,l=>(n(),g("tr",{key:l.tanque},[t("td",Pe,i(l.tanque),1),t("td",Re,i(l.procesos),1),t("td",Ve,i(d.formatNumber(l.entrada_kg)),1),t("td",Fe,i(d.formatNumber(l.salida_kg)),1),t("td",Ie,[e(z,{color:l.merma_porcentaje>5?"warning":"positive"},{default:s(()=>[u(i(l.merma_porcentaje)+"% ",1)]),_:2},1032,["color"])])]))),128))])]),_:1})]),t("div",je,[a[15]||(a[15]=t("div",{class:"text-subtitle2 q-mb-sm"},"Distribución de Merma",-1)),t("div",Be,[t("canvas",Le,null,512)])])])]),_:1})]),_:1})):k("",!0),o.lotes?(n(),b(m,{key:1,flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>a[16]||(a[16]=[t("div",{class:"text-h6"},"Lotes y Almacenamiento",-1),t("div",{class:"text-caption text-grey-7"}," Control de stock y ocupación de tanques ",-1)])),_:1}),e(y),e(c,null,{default:s(()=>[t("div",Oe,[t("div",Ue,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"inventory_2",size:"md",color:"primary"}),t("div",Ye,i(o.lotes.lotes_generados),1),a[17]||(a[17]=t("div",{class:"text-caption text-grey-7"},"Lotes Generados",-1))]),_:1})]),_:1})]),t("div",Ge,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"scale",size:"md",color:"positive"}),t("div",$e,i(d.formatNumber(o.lotes.stock_actual)),1),a[18]||(a[18]=t("div",{class:"text-caption text-grey-7"},"Stock Actual (kg)",-1))]),_:1})]),_:1})]),t("div",He,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"water_drop",size:"md",color:"info"}),t("div",Ke,i(o.lotes.ocupacion_tanques)+"%",1),a[19]||(a[19]=t("div",{class:"text-caption text-grey-7"},"Ocupación Tanques",-1))]),_:1})]),_:1})]),t("div",Ze,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,{class:"text-center"},{default:s(()=>[e(h,{name:"warning",size:"md",color:"warning"}),t("div",Je,i(o.lotes.tanques_criticos),1),a[20]||(a[20]=t("div",{class:"text-caption text-grey-7"},"Tanques Críticos",-1)),a[21]||(a[21]=t("div",{class:"text-body2 q-mt-xs"},"> 80% ocupación",-1))]),_:1})]),_:1})])]),a[23]||(a[23]=t("div",{class:"text-subtitle2 q-mb-sm"},"Estado de Tanques",-1)),e(R,{dense:"",flat:""},{default:s(()=>[a[22]||(a[22]=t("thead",null,[t("tr",null,[t("th",{class:"text-left"},"Tanque"),t("th",{class:"text-left"},"Tipo"),t("th",{class:"text-right"},"Capacidad (kg)"),t("th",{class:"text-right"},"Stock (kg)"),t("th",{class:"text-right"},"Ocupación %"),t("th",{class:"text-center"},"Estado")])],-1)),t("tbody",null,[(n(!0),g(T,null,C(o.lotes.detalle_tanques,l=>(n(),g("tr",{key:l.tanque},[t("td",We,i(l.tanque),1),t("td",Xe,i(l.tipo),1),t("td",ts,i(d.formatNumber(l.capacidad_kg)),1),t("td",es,i(d.formatNumber(l.stock_actual)),1),t("td",ss,i(l.ocupacion_porcentaje)+"%",1),t("td",as,[e(z,{color:l.ocupacion_porcentaje>80?"warning":l.ocupacion_porcentaje>60?"orange":"positive"},{default:s(()=>[u(i(d.getEstadoTanque(l.ocupacion_porcentaje)),1)]),_:2},1032,["color"])])]))),128))])]),_:1})]),_:1})]),_:1})):k("",!0),o.metodos?(n(),b(m,{key:2,flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>a[24]||(a[24]=[t("div",{class:"text-h6"},"Métodos de Procesamiento",-1),t("div",{class:"text-caption text-grey-7"}," Análisis de eficiencia por método aplicado ",-1)])),_:1}),e(y),e(c,null,{default:s(()=>[t("div",os,[t("div",is,[e(A,{bordered:"",separator:""},{default:s(()=>[(n(!0),g(T,null,C(o.metodos.metodos_usados,l=>(n(),b(q,{key:l.metodo},{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>[u(i(l.metodo),1)]),_:2},1024),e(p,{caption:""},{default:s(()=>[u(i(l.usos)+" usos - Temp: "+i(l.temperatura_promedio)+"°C - Tiempo: "+i(l.tiempo_promedio)+"h ",1)]),_:2},1024)]),_:2},1024),e(x,{side:""},{default:s(()=>[e(z,{color:l.eficiencia_promedio>95?"positive":"orange"},{default:s(()=>[u(i(l.eficiencia_promedio)+"% eficiencia ",1)]),_:2},1032,["color"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t("div",rs,[a[25]||(a[25]=t("div",{class:"text-subtitle2 q-mb-sm"},"Eficiencia vs Uso",-1)),t("div",ls,[t("canvas",ns,null,512)])])])]),_:1})]),_:1})):k("",!0)])}const cs=V(ae,[["render",ds]]),D=G({name:"QTimelineEntry",props:{heading:Boolean,tag:{type:String,default:"h3"},side:{type:String,default:"right",validator:r=>["left","right"].includes(r)},icon:String,avatar:String,color:String,title:String,subtitle:String,body:String},setup(r,{slots:a}){const _=Z($,F);if(_===F)return console.error("QTimelineEntry needs to be child of QTimeline"),F;const N=Q(()=>`q-timeline__entry q-timeline__entry--${r.side}`+(r.icon!==void 0||r.avatar!==void 0?" q-timeline__entry--icon":"")),o=Q(()=>`q-timeline__dot text-${r.color||_.color}`),d=Q(()=>_.layout==="comfortable"&&_.side==="left");return()=>{const l=J(a.default,[]);if(r.body!==void 0&&l.unshift(r.body),r.heading===!0){const w=[v("div"),v("div"),v(r.tag,{class:"q-timeline__heading-title"},l)];return v("div",{class:"q-timeline__heading"},d.value===!0?w.reverse():w)}let f;r.icon!==void 0?f=[v(h,{class:"row items-center justify-center",name:r.icon})]:r.avatar!==void 0&&(f=[v("img",{class:"q-timeline__dot-img",src:r.avatar})]);const E=[v("div",{class:"q-timeline__subtitle"},[v("span",{},j(a.subtitle,[r.subtitle]))]),v("div",{class:o.value},f),v("div",{class:"q-timeline__content"},[v("h6",{class:"q-timeline__title"},j(a.title,[r.title]))].concat(l))];return v("li",{class:N.value},d.value===!0?E.reverse():E)}}}),us=G({name:"QTimeline",props:{...W,color:{type:String,default:"primary"},side:{type:String,default:"right",validator:r=>["left","right"].includes(r)},layout:{type:String,default:"dense",validator:r=>["dense","comfortable","loose"].includes(r)}},setup(r,{slots:a}){const _=tt(),N=X(r,_.proxy.$q);et($,r);const o=Q(()=>`q-timeline q-timeline--${r.layout} q-timeline--${r.layout}--${r.side}`+(N.value===!0?" q-timeline--dark":""));return()=>v("ul",{class:o.value},j(a.default))}}),ms={name:"TrazabilidadAdelante",components:{DashboardVentas:it},props:{gestion:{type:Number,required:!0}},data(){return{subTab:"ventas",busqueda:{codigo_lote:""},buscando:!1,lote:null,mensajeBusqueda:null}},methods:{formatNumber(r){return Number(r||0).toLocaleString("es-BO",{minimumFractionDigits:2,maximumFractionDigits:2})},formatFecha(r){return r?H(r).format("DD/MM/YYYY"):"N/A"},cargarDatos(){this.$refs.dashboardVentas&&this.subTab==="ventas"&&this.$refs.dashboardVentas.cargarDatos()},async buscarLote(){if(!this.busqueda.codigo_lote.trim()){this.$q.notify({type:"warning",message:"Ingrese un código de lote"});return}this.buscando=!0,this.lote=null,this.mensajeBusqueda=null;try{const{data:r}=await this.$axios.get("/lotes/trazabilidad",{params:{codigo_lote:this.busqueda.codigo_lote.trim()}});r?this.lote=r:this.mensajeBusqueda="No se encontró el lote especificado"}catch(r){r.response&&r.response.status===404?this.mensajeBusqueda="No se encontró el lote especificado":this.$q.notify({type:"negative",message:"Error al buscar el lote"})}finally{this.buscando=!1}},limpiarBusqueda(){this.busqueda.codigo_lote="",this.lote=null,this.mensajeBusqueda=null},escanearQR(){this.$q.notify({type:"info",message:"Funcionalidad de escaneo QR en desarrollo"})}},watch:{gestion(){this.cargarDatos()},subTab(){this.subTab==="ventas"&&this.$nextTick(()=>{this.cargarDatos()})}}},_s={class:"q-gutter-md"},fs={class:"row q-col-gutter-md q-mb-md"},ps={class:"col-12 col-md-6"},gs={class:"col-12 col-md-6"},hs={key:0},bs={class:"text-h6 q-mb-md"},xs={class:"row q-col-gutter-md q-mb-md"},vs={class:"col-12 col-md-4"},ys={class:"text-h6"},qs={class:"col-12 col-md-4"},ks={class:"text-h6"},zs={class:"col-12 col-md-4"},Ts={class:"text-h6"},Cs={key:0},ws={key:1,class:"text-grey-7"},Ns={key:0},As={key:1,class:"text-grey-7"},Ds={class:"text-body1"},Ms={class:"text-body2 text-grey-7 q-mt-xs"},Ss={key:1,class:"text-center q-pa-md"},Es={class:"text-h6 text-grey-6 q-mt-md"};function Qs(r,a,_,N,o,d){const l=P("dashboard-ventas");return n(),g("div",_s,[e(O,{modelValue:o.subTab,"onUpdate:modelValue":a[0]||(a[0]=f=>o.subTab=f),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:s(()=>[e(M,{name:"ventas",label:"Ventas y Distribución",icon:"point_of_sale"}),e(M,{name:"busqueda",label:"Buscador de Lotes",icon:"search"})]),_:1},8,["modelValue"]),e(y),e(U,{modelValue:o.subTab,"onUpdate:modelValue":a[2]||(a[2]=f=>o.subTab=f),animated:""},{default:s(()=>[e(S,{name:"ventas"},{default:s(()=>[e(l,{ref:"dashboardVentas","gestion-prop":_.gestion},null,8,["gestion-prop"]),e(m,{flat:"",bordered:"",class:"q-mt-md"},{default:s(()=>[e(c,null,{default:s(()=>[e(B,{class:"bg-grey-2"},{avatar:s(()=>[e(h,{name:"info",color:"info"})]),default:s(()=>[a[3]||(a[3]=t("div",{class:"text-subtitle1"},"Trazabilidad Hacia Adelante",-1)),a[4]||(a[4]=u(" El sistema actual registra ventas y destinos finales. El tracking GPS post-venta no está implementado. La trazabilidad se completa con el registro del comprador y lugar de destino en cada venta. "))]),_:1})]),_:1})]),_:1})]),_:1}),e(S,{name:"busqueda"},{default:s(()=>[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>[a[19]||(a[19]=t("div",{class:"text-h6 q-mb-md"},"Búsqueda de Lotes y Trazabilidad Completa",-1)),t("div",fs,[t("div",ps,[e(st,{modelValue:o.busqueda.codigo_lote,"onUpdate:modelValue":a[1]||(a[1]=f=>o.busqueda.codigo_lote=f),label:"Código de Lote",outlined:"",dense:"",onKeyup:at(d.buscarLote,["enter"])},{append:s(()=>[e(h,{name:"qr_code_scanner",class:"cursor-pointer",onClick:d.escanearQR},null,8,["onClick"])]),_:1},8,["modelValue","onKeyup"])]),t("div",gs,[e(L,{label:"Buscar",icon:"search",color:"primary",onClick:d.buscarLote,loading:o.buscando},null,8,["onClick","loading"]),e(L,{label:"Limpiar",icon:"clear",color:"grey",flat:"",class:"q-ml-sm",onClick:d.limpiarBusqueda},null,8,["onClick"])])]),e(y,{class:"q-my-md"}),o.lote?(n(),g("div",hs,[t("div",bs,"Información del Lote: "+i(o.lote.codigo_lote),1),t("div",xs,[t("div",vs,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>[a[5]||(a[5]=t("div",{class:"text-caption text-grey-7"},"Fecha Envasado",-1)),t("div",ys,i(d.formatFecha(o.lote.fecha_envasado)),1)]),_:1})]),_:1})]),t("div",qs,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>[a[6]||(a[6]=t("div",{class:"text-caption text-grey-7"},"Producto",-1)),t("div",ks,i(o.lote.producto),1)]),_:1})]),_:1})]),t("div",zs,[e(m,{flat:"",bordered:""},{default:s(()=>[e(c,null,{default:s(()=>[a[7]||(a[7]=t("div",{class:"text-caption text-grey-7"},"Cantidad Original",-1)),t("div",Ts,i(d.formatNumber(o.lote.cantidad_kg))+" kg",1)]),_:1})]),_:1})])]),e(us,{color:"primary",layout:"comfortable"},{default:s(()=>[e(D,{title:"Cosecha y Recepción",subtitle:"Origen de la materia prima",icon:"agriculture",color:"positive"},{default:s(()=>[o.lote.productores&&o.lote.productores.length>0?(n(),g("div",Cs,[a[8]||(a[8]=t("div",{class:"text-subtitle2 q-mb-sm"},"Productores Origen:",-1)),e(A,{dense:"",bordered:"",separator:""},{default:s(()=>[(n(!0),g(T,null,C(o.lote.productores,f=>(n(),b(q,{key:f.nombre},{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>[u(i(f.nombre),1)]),_:2},1024),e(p,{caption:""},{default:s(()=>[u(" Apiarios: "+i(f.apiarios)+" | Fecha cosecha: "+i(d.formatFecha(f.fecha_cosecha))+" | Cantidad: "+i(d.formatNumber(f.cantidad_kg))+" kg ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):(n(),g("div",ws,"No hay información de productores"))]),_:1}),e(D,{title:"Procesamiento",subtitle:"Transformación y control de calidad",icon:"factory",color:"primary"},{default:s(()=>[o.lote.proceso?(n(),g("div",Ns,[e(A,{dense:"",bordered:""},{default:s(()=>[e(q,null,{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>a[9]||(a[9]=[u("Tanque")])),_:1}),e(p,{caption:""},{default:s(()=>[u(i(o.lote.proceso.tanque),1)]),_:1})]),_:1})]),_:1}),e(q,null,{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>a[10]||(a[10]=[u("Método")])),_:1}),e(p,{caption:""},{default:s(()=>[u(i(o.lote.proceso.metodo_proceso),1)]),_:1})]),_:1})]),_:1}),e(q,null,{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>a[11]||(a[11]=[u("Fecha Inicio")])),_:1}),e(p,{caption:""},{default:s(()=>[u(i(d.formatFecha(o.lote.proceso.fecha_inicio)),1)]),_:1})]),_:1})]),_:1}),e(q,null,{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>a[12]||(a[12]=[u("Fecha Finalización")])),_:1}),e(p,{caption:""},{default:s(()=>[u(i(d.formatFecha(o.lote.proceso.fecha_fin)),1)]),_:1})]),_:1})]),_:1}),e(q,null,{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>a[13]||(a[13]=[u("Temperatura")])),_:1}),e(p,{caption:""},{default:s(()=>[u(i(o.lote.proceso.temperatura)+"°C",1)]),_:1})]),_:1})]),_:1}),e(q,null,{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>a[14]||(a[14]=[u("Merma")])),_:1}),e(p,{caption:""},{default:s(()=>[u(i(o.lote.proceso.merma_porcentaje)+"%",1)]),_:1})]),_:1})]),_:1})]),_:1})])):(n(),g("div",As,"No hay información de procesamiento"))]),_:1}),e(D,{title:"Almacenamiento",subtitle:"Stock disponible",icon:"inventory_2",color:"info"},{default:s(()=>[t("div",null,[t("div",Ds,[a[15]||(a[15]=t("strong",null,"Stock Actual:",-1)),u(" "+i(d.formatNumber(o.lote.stock_actual))+" kg ",1)]),t("div",Ms," Vendido: "+i(d.formatNumber(o.lote.cantidad_vendida))+" kg ",1)])]),_:1}),o.lote.ventas&&o.lote.ventas.length>0?(n(),b(D,{key:0,title:"Ventas y Distribución",subtitle:"Destino final",icon:"local_shipping",color:"orange"},{default:s(()=>[a[17]||(a[17]=t("div",{class:"text-subtitle2 q-mb-sm"},"Registro de Ventas:",-1)),e(A,{dense:"",bordered:"",separator:""},{default:s(()=>[(n(!0),g(T,null,C(o.lote.ventas,f=>(n(),b(q,{key:f.venta_id},{default:s(()=>[e(x,null,{default:s(()=>[e(p,null,{default:s(()=>[u(i(f.comprador),1)]),_:2},1024),e(p,{caption:""},{default:s(()=>[u(" Fecha: "+i(d.formatFecha(f.fecha_venta))+" | Cantidad: "+i(d.formatNumber(f.cantidad_kg))+" kg | Monto: Bs. "+i(d.formatNumber(f.monto_total)),1)]),_:2},1024),f.lugar_destino?(n(),b(p,{key:0,caption:""},{default:s(()=>[u(" Destino: "+i(f.lugar_destino),1)]),_:2},1024)):k("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(B,{class:"bg-blue-1 q-mt-md"},{avatar:s(()=>[e(h,{name:"info",color:"info"})]),default:s(()=>[a[16]||(a[16]=u(" El tracking GPS post-venta no está implementado. La trazabilidad finaliza con el registro del destino. "))]),_:1})]),_:1})):(n(),b(D,{key:1,title:"Sin Ventas Registradas",subtitle:"Lote disponible en stock",icon:"pending",color:"grey"},{default:s(()=>a[18]||(a[18]=[t("div",{class:"text-grey-7"},"Este lote no tiene ventas registradas aún",-1)])),_:1}))]),_:1})])):o.mensajeBusqueda?(n(),g("div",Ss,[e(h,{name:"search_off",size:"4em",color:"grey-5"}),t("div",Es,i(o.mensajeBusqueda),1)])):k("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Ps=V(ms,[["render",Qs]]),Rs={name:"DashboardTrazabilidad",components:{TrazabilidadAtras:se,TrazabilidadProceso:cs,TrazabilidadAdelante:Ps},data(){return{tab:"atras",gestion:new Date().getFullYear(),gestionesDisponibles:[]}},mounted(){this.generarGestiones(),this.cargarDatos()},methods:{generarGestiones(){const r=new Date().getFullYear();this.gestionesDisponibles=[];for(let a=r;a>=r-5;a--)this.gestionesDisponibles.push(a)},cargarDatos(){this.$nextTick(()=>{this.tab==="atras"&&this.$refs.tabAtras?this.$refs.tabAtras.cargarDatos():this.tab==="proceso"&&this.$refs.tabProceso?this.$refs.tabProceso.cargarDatos():this.tab==="adelante"&&this.$refs.tabAdelante&&this.$refs.tabAdelante.cargarDatos()})}},watch:{tab(){this.cargarDatos()}}},Vs={class:"row items-center q-mb-md"},Fs={class:"col-auto"};function Is(r,a,_,N,o,d){const l=P("trazabilidad-atras"),f=P("trazabilidad-proceso"),E=P("trazabilidad-adelante");return n(),b(ot,{class:"q-pa-md"},{default:s(()=>[t("div",Vs,[a[3]||(a[3]=t("div",{class:"col"},[t("div",{class:"text-h5"},"Dashboard de Trazabilidad Integral"),t("div",{class:"text-caption text-grey-7"},"Sistema completo de seguimiento de producción apícola")],-1)),t("div",Fs,[e(K,{modelValue:o.gestion,"onUpdate:modelValue":[a[0]||(a[0]=w=>o.gestion=w),d.cargarDatos],options:o.gestionesDisponibles,label:"Gestión",dense:"",outlined:"",style:{"min-width":"120px"}},null,8,["modelValue","options","onUpdate:modelValue"])])]),e(O,{modelValue:o.tab,"onUpdate:modelValue":a[1]||(a[1]=w=>o.tab=w),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:s(()=>[e(M,{name:"atras",icon:"agriculture",label:"Trazabilidad Hacia Atrás","no-caps":""}),e(M,{name:"proceso",icon:"factory",label:"Trazabilidad En Proceso","no-caps":""}),e(M,{name:"adelante",icon:"local_shipping",label:"Trazabilidad Hacia Adelante","no-caps":""})]),_:1},8,["modelValue"]),e(y),e(U,{modelValue:o.tab,"onUpdate:modelValue":a[2]||(a[2]=w=>o.tab=w),animated:""},{default:s(()=>[e(S,{name:"atras"},{default:s(()=>[e(l,{gestion:o.gestion,ref:"tabAtras"},null,8,["gestion"])]),_:1}),e(S,{name:"proceso"},{default:s(()=>[e(f,{gestion:o.gestion,ref:"tabProceso"},null,8,["gestion"])]),_:1}),e(S,{name:"adelante"},{default:s(()=>[e(E,{gestion:o.gestion,ref:"tabAdelante"},null,8,["gestion"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}const da=V(Rs,[["render",Is]]);export{da as default};
