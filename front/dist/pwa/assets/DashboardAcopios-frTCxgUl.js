import{Q as M}from"./QSpace-yjffq0IW.js";import{Q as A}from"./QSelect-CE_gFS-5.js";import{Q as G}from"./QTooltip-BGE4xi2l.js";import{_ as N,c as _,o as g,w as i,b as s,a8 as B,a,f as F,a7 as u,t as p,Q as m,O as J,a9 as f,aa as k,ab as D,e as h,d as y,ad as K}from"./index-BYmx5CNZ.js";import{Q as q}from"./QChip-BFVaIQP4.js";import{Q as E}from"./QBanner-DRdTdlhT.js";import{Q as L,a as P,b as Z,c as C}from"./QTabPanels-COuTR9Jx.js";import{Q as v}from"./QInnerLoading-C2gi1RYI.js";import{Q,b as w,a as x}from"./position-engine-WcV6P5pk.js";import{Q as I}from"./QList-BvaTzhwT.js";import{Q as j}from"./QLinearProgress--ydnym95.js";import{Q as O}from"./QTd-yQQsgtLk.js";import{Q as T}from"./QTable-ijz60Nei.js";import{Q as U}from"./QBadge-XCEdf9Kh.js";import{Q as W}from"./QPage-p00VibaV.js";import"./auto-fljMw0yZ.js";import{h as R}from"./moment-C5S46NFB.js";import{C as z}from"./chart-DihOV3X-.js";import"./format-WFf_bcNU.js";import"./selection-BcgxACWv.js";import"./QResizeObserver-CpmGT2BI.js";import"./use-panel-DWGxyhPB.js";import"./touch-BjYP5sR0.js";import"./use-render-cache-DLxPkVnQ.js";import"./QMarkupTable-CxD-gDWx.js";import"./use-fullscreen-CPEUUBlp.js";const H={name:"DashboardAcopios",data(){return{tabActiva:"resumen",gestionSeleccionada:R().year(),productoSeleccionado:null,gestiones:[],productos:[],departamentos:[],municipios:[],listaOrganizaciones:[],loadingActualizar:!1,loadingKpis:!1,loadingGraficos:!1,loadingTablas:!1,loadingTop3:!1,indicadoresGlobales:null,kpisResumen:[],datosEvolucionAnual:[],topDepartamentos:[],topMunicipios:[],topOrganizaciones:[],filtroDepartamento:null,filtroMunicipio:null,datosGeograficos:[],tablaGeografica:[],paginacionGeo:{rowsPerPage:10,sortBy:"totalKg",descending:!0},columnasGeograficas:[{name:"ubicacion",label:"Ubicación",field:"ubicacion",align:"left",sortable:!0},{name:"productores",label:"Productores",field:"productores",align:"center",sortable:!0},{name:"totalKg",label:"Total Kg",field:"totalKg",align:"right",sortable:!0,format:e=>e?.toFixed(2)},{name:"promedio",label:"Promedio Kg/Productor",field:"promedio",align:"right",sortable:!0,format:e=>e?.toFixed(2)},{name:"porcentaje",label:"% del Total",field:"porcentaje",align:"center",sortable:!0}],datosProductos:[],tablaDistribucionProducto:[],columnasDistribucionProducto:[{name:"ubicacion",label:"Ubicación",field:"ubicacion",align:"left"},{name:"kg",label:"Kg",field:"kg",align:"right",format:e=>e?.toFixed(2)},{name:"porcentaje",label:"% del Producto",field:"porcentaje",align:"center",format:e=>e?.toFixed(2)+"%"},{name:"productores",label:"Productores",field:"productores",align:"center"}],gestionesComparar:[],tablaEstacionalidad:[],tablaComparativa:[],columnasEstacionalidad:[{name:"mes",label:"Mes",field:"mes",align:"left"},{name:"totalKg",label:"Total Kg",field:"totalKg",align:"right",format:e=>e?.toFixed(2)},{name:"porcentaje",label:"% del Año",field:"porcentaje",align:"center",format:e=>e?.toFixed(2)+"%"},{name:"ranking",label:"Ranking",field:"ranking",align:"center"},{name:"tendencia",label:"Tendencia",field:"tendencia",align:"center"}],columnasComparativa:[{name:"mes",label:"Mes",field:"mes",align:"left"},{name:"anioActual",label:"Año Actual (Kg)",field:"anioActual",align:"right",format:e=>e?.toFixed(2)},{name:"anioAnterior",label:"Año Anterior (Kg)",field:"anioAnterior",align:"right",format:e=>e?.toFixed(2)},{name:"diferencia",label:"Diferencia (Kg)",field:"diferencia",align:"right",format:e=>e?.toFixed(2)},{name:"variacion",label:"Variación %",field:"variacion",align:"center"}],tablaOrganizaciones:[],orgSeleccionada:null,tablaContribucion:[],columnasOrganizaciones:[{name:"posicion",label:"#",field:"posicion",align:"center"},{name:"asociacion",label:"Asociación",field:"asociacion",align:"left",sortable:!0},{name:"totalKg",label:"Total Kg",field:"totalKg",align:"right",sortable:!0,format:e=>e?.toFixed(2)},{name:"productores",label:"Productores",field:"productores",align:"center",sortable:!0},{name:"promedio",label:"Promedio Kg/Productor",field:"promedio",align:"right",sortable:!0,format:e=>e?.toFixed(2)},{name:"porcentaje",label:"% del Total",field:"porcentaje",align:"center",sortable:!0,format:e=>e?.toFixed(2)+"%"}],chartInstances:[]}},watch:{tabActiva(e){this.cargarDatosTab(e)}},mounted(){this.cargarDatosIniciales()},beforeUnmount(){this.destruirCharts()},methods:{async cargarDatosIniciales(){this.generarGestiones(),await this.cargarProductos(),await this.cargarDepartamentos(),this.gestionesComparar=[this.gestionSeleccionada],await this.actualizarIndicadoresGlobales(),this.cargarDatosDashboard()},generarGestiones(){const e=R().year();this.gestiones=[];for(let t=2020;t<=e+1;t++)this.gestiones.push(t)},async cargarProductos(){try{const{data:e}=await this.$axios.get("/productos/tipo/1");this.productos=e?.data||e||[],this.productos.length>0&&(this.productoSeleccionado=this.productos[0].id)}catch{this.$alert?.error?.("Error al cargar productos")}},async cargarDepartamentos(){try{const{data:e}=await this.$axios.get("/departamentos");this.departamentos=e?.data||e||[]}catch{this.$alert?.error?.("Error al cargar departamentos")}},cambioFiltroGlobal(){this.actualizarIndicadoresGlobales(),this.cargarDatosTab(this.tabActiva)},async actualizarDatos(){this.loadingActualizar=!0,await this.actualizarIndicadoresGlobales(),await this.cargarDatosTab(this.tabActiva),this.loadingActualizar=!1,this.$q.notify({type:"positive",message:"Datos actualizados"})},cargarDatosDashboard(){this.cargarDatosTab(this.tabActiva)},async cargarDatosTab(e){switch(e){case"resumen":try{await this.cargarTop3()}catch(t){console.error("Error en cargarTop3:",t)}try{await this.cargarKpisResumen()}catch(t){console.error("Error en cargarKpisResumen:",t)}try{await this.generarGraficoEvolucionAnual()}catch(t){console.error("Error en generarGraficoEvolucionAnual:",t)}break;case"geografico":this.filtroDepartamento&&await this.aplicarFiltroGeografico();break;case"productos":await this.generarGraficoProductos(),await this.cargarDistribucionProducto();break;case"temporal":await this.generarGraficoTemporal(),await this.cargarEstacionalidad(),await this.cargarComparativaAnual();break;case"organizacional":await this.cargarRankingOrganizaciones(),this.cargarMapaContribucion();break}},async actualizarIndicadoresGlobales(){try{const{data:e}=await this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada}}),t=e?.data?.reduce((l,r)=>l+parseFloat(r||0),0)||0,n=(await this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada-1}}))?.data?.data?.reduce((l,r)=>l+parseFloat(r||0),0)||0,o=n>0?(t-n)/n*100:0;this.indicadoresGlobales={totalKg:t,totalProductores:0,promedioKg:0,crecimiento:o}}catch{this.indicadoresGlobales={totalKg:0,totalProductores:0,promedioKg:0,crecimiento:0}}},async cargarKpisResumen(){this.loadingKpis=!0;try{const{data:e}=await this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada}}),t=e?.data?.reduce((d,n)=>d+parseFloat(n||0),0)||0;this.kpisResumen=[{label:"Total Kg Acopiados",value:t.toFixed(2),icon:"inbox",color:"primary"},{label:"Productores Activos",value:"0",icon:"people",color:"green"},{label:"Organizaciones",value:"0",icon:"apartment",color:"orange"},{label:"Crecimiento",value:this.indicadoresGlobales?.crecimiento?.toFixed(2)+"%",icon:this.indicadoresGlobales?.crecimiento>=0?"trending_up":"trending_down",color:this.indicadoresGlobales?.crecimiento>=0?"positive":"negative"}]}catch{this.$alert?.error?.("Error al cargar KPIs")}finally{this.loadingKpis=!1}},async generarGraficoEvolucionAnual(){this.loadingGraficos=!0;try{const{data:e}=await this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada}});this.datosEvolucionAnual=e?.data||[],await this.$nextTick();const t=this.$refs.chartEvolucionAnual;if(!t)return;const d=this.chartInstances.find(l=>l.canvas===t);d&&(d.destroy(),this.chartInstances=this.chartInstances.filter(l=>l.canvas!==t));const n=t.getContext("2d"),o=new z(n,{type:"line",data:{labels:e?.labels||[],datasets:[{label:`Acopio ${this.gestionSeleccionada} (Kg)`,data:this.datosEvolucionAnual,borderColor:"rgb(25, 118, 210)",backgroundColor:"rgba(25, 118, 210, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!0,position:"top"}},scales:{y:{beginAtZero:!0}}}});this.chartInstances.push(o)}catch{this.$alert?.error?.("Error al generar gráfico de evolución")}finally{this.loadingGraficos=!1}},async cargarTop3(){this.loadingTop3=!0;try{const e=await this.$axios.post("/reporteAcopioProveedorDep",{producto_id:this.productoSeleccionado,inicio:`${this.gestionSeleccionada}-01-01`,fin:`${this.gestionSeleccionada}-12-31`}),t=(e?.data?.data||e?.data||[]).map(c=>({nombre:c.departamento,kg:parseFloat(c.total||0)})).sort((c,b)=>b.kg-c.kg);this.topDepartamentos=t.slice(0,3);const d=await this.$axios.post("/reporteAcopioProveedorMun",{producto_id:this.productoSeleccionado,inicio:`${this.gestionSeleccionada}-01-01`,fin:`${this.gestionSeleccionada}-12-31`}),n=(d?.data?.data||d?.data||[]).map(c=>({nombre:c.municipio,kg:parseFloat(c.total||0)})).sort((c,b)=>b.kg-c.kg);this.topMunicipios=n.slice(0,3);const o=await this.$axios.post("/reportAcopioOrg",{gestion:this.gestionSeleccionada,producto_id:this.productoSeleccionado}),l=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],r=(o?.data?.data||o?.data||[]).map(c=>{const b=l.reduce((S,V)=>S+parseFloat(c[V]||0),0);return{nombre:c.asociacion||"Sin nombre",kg:b}}).filter(c=>c.kg>0).sort((c,b)=>b.kg-c.kg);this.topOrganizaciones=r.slice(0,3)}catch{this.topDepartamentos.length===0&&(this.topDepartamentos=[]),this.topMunicipios.length===0&&(this.topMunicipios=[]),this.topOrganizaciones.length===0&&(this.topOrganizaciones=[])}finally{this.loadingTop3=!1}},async onDepartamentoChange(){this.filtroMunicipio=null,this.filtroDepartamento&&await this.cargarMunicipios()},async cargarMunicipios(){if(this.filtroDepartamento)try{const{data:e}=await this.$axios.get("/municipios",{params:{departamento_id:this.filtroDepartamento}});this.municipios=e?.data||e||[]}catch{this.$alert?.error?.("Error al cargar municipios")}},async aplicarFiltroGeografico(){this.loadingGraficos=!0,this.loadingTablas=!0;try{const e=this.filtroMunicipio?"/reporteAcopioProveedorMun":"/reporteAcopioProveedorDep",{data:t}=await this.$axios.post(e,{producto_id:this.productoSeleccionado,inicio:`${this.gestionSeleccionada}-01-01`,fin:`${this.gestionSeleccionada}-12-31`}),d=t?.data||t||[];this.datosGeograficos=d;const n=d.reduce((o,l)=>o+parseFloat(l.total||0),0);this.tablaGeografica=d.map(o=>{const l=parseFloat(o.total||0),r=parseInt(o.productores||0);return{ubicacion:o.departamento||o.municipio,productores:r,totalKg:l,promedio:r>0?l/r:0,porcentaje:n>0?(l/n*100).toFixed(2):0}}),await this.generarGraficoGeografico()}catch{this.$alert?.error?.("Error al cargar datos geográficos")}finally{this.loadingGraficos=!1,this.loadingTablas=!1}},async generarGraficoGeografico(){await this.$nextTick();const e=this.$refs.chartGeografico;if(!e||this.datosGeograficos.length===0)return;const t=this.chartInstances.find(o=>o.canvas===e);t&&(t.destroy(),this.chartInstances=this.chartInstances.filter(o=>o.canvas!==e));const d=e.getContext("2d"),n=new z(d,{type:"bar",data:{labels:this.datosGeograficos.map(o=>o.departamento||o.municipio),datasets:[{label:"Acopio (Kg)",data:this.datosGeograficos.map(o=>parseFloat(o.total||0)),backgroundColor:"rgba(25, 118, 210, 0.7)",borderColor:"rgb(25, 118, 210)",borderWidth:1}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0}}}});this.chartInstances.push(n)},async generarGraficoProductos(){this.loadingGraficos=!0;try{const{data:e}=await this.$axios.get("/acopiore1",{params:{year:this.gestionSeleccionada}});this.datosProductos=e?.data||[],await this.$nextTick();const t=this.$refs.chartProductos;if(!t)return;const d=this.chartInstances.find(l=>l.canvas===t);d&&(d.destroy(),this.chartInstances=this.chartInstances.filter(l=>l.canvas!==t));const n=t.getContext("2d"),o=new z(n,{type:"doughnut",data:{labels:this.datosProductos.map(l=>l.producto),datasets:[{data:this.datosProductos.map(l=>parseFloat(l.total_kg||0)),backgroundColor:["rgba(255, 99, 132, 0.7)","rgba(54, 162, 235, 0.7)","rgba(255, 206, 86, 0.7)","rgba(75, 192, 192, 0.7)","rgba(153, 102, 255, 0.7)"],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"bottom"}}}});this.chartInstances.push(o)}catch{this.$alert?.error?.("Error al generar gráfico de productos")}finally{this.loadingGraficos=!1}},async cargarDistribucionProducto(){this.loadingTablas=!0;try{const{data:e}=await this.$axios.post("/reporteAcopioProveedorDep",{producto_id:this.productoSeleccionado,inicio:`${this.gestionSeleccionada}-01-01`,fin:`${this.gestionSeleccionada}-12-31`}),t=e?.data||e||[],d=t.reduce((n,o)=>n+parseFloat(o.total||0),0);this.tablaDistribucionProducto=t.slice(0,5).map(n=>({ubicacion:n.departamento,kg:parseFloat(n.total||0),porcentaje:d>0?parseFloat(n.total||0)/d*100:0,productores:parseInt(n.productores||0)}))}catch{this.tablaDistribucionProducto=[]}finally{this.loadingTablas=!1}},async generarGraficoTemporal(){this.loadingGraficos=!0;try{const e=[],t=["rgb(25, 118, 210)","rgb(76, 175, 80)","rgb(255, 152, 0)"];for(let r=0;r<this.gestionesComparar.length&&r<3;r++){const c=this.gestionesComparar[r],{data:b}=await this.$axios.get("/acopiore2",{params:{year:c}});e.push({label:`Gestión ${c}`,data:b?.data||[],borderColor:t[r],backgroundColor:t[r].replace("rgb","rgba").replace(")",", 0.1)"),tension:.4})}await this.$nextTick();const d=this.$refs.chartTemporal;if(!d)return;const n=this.chartInstances.find(r=>r.canvas===d);n&&(n.destroy(),this.chartInstances=this.chartInstances.filter(r=>r.canvas!==d));const o=d.getContext("2d"),l=new z(o,{type:"line",data:{labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],datasets:e},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!0,position:"top"}},scales:{y:{beginAtZero:!0}}}});this.chartInstances.push(l)}catch{this.$alert?.error?.("Error al generar gráfico temporal")}finally{this.loadingGraficos=!1}},async cargarEstacionalidad(){this.loadingTablas=!0;try{const{data:e}=await this.$axios.post("/reportePorcentual",{producto_id:this.productoSeleccionado,inicio:`${this.gestionSeleccionada}-01-01`,fin:`${this.gestionSeleccionada}-12-31`}),d=(e?.data||e||[]).map((n,o)=>({mes:n.nombre_mes||`Mes ${o+1}`,totalKg:parseFloat(n.acopio_kg||0),porcentaje:parseFloat(n.porcentaje||0),ranking:0})).sort((n,o)=>o.totalKg-n.totalKg);d.forEach((n,o)=>{n.ranking=o+1}),this.tablaEstacionalidad=d.sort((n,o)=>n.mes.localeCompare(o.mes))}catch{this.tablaEstacionalidad=[]}finally{this.loadingTablas=!1}},async cargarComparativaAnual(){this.loadingTablas=!0;try{const[e,t]=await Promise.all([this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada}}),this.$axios.get("/acopiore2",{params:{year:this.gestionSeleccionada-1}})]),d=e?.data?.data||[],n=t?.data?.data||[],o=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];this.tablaComparativa=o.map((l,r)=>{const c=parseFloat(d[r]||0),b=parseFloat(n[r]||0),S=c-b,V=b>0?S/b*100:0;return{mes:l,anioActual:c,anioAnterior:b,diferencia:S,variacion:V}})}catch{this.tablaComparativa=[]}finally{this.loadingTablas=!1}},async cargarRankingOrganizaciones(){this.loadingTablas=!0;try{const{data:e}=await this.$axios.post("/reportAcopioOrg",{gestion:this.gestionSeleccionada,producto_id:this.productoSeleccionado}),t=e?.data||e||[],d=t.reduce((n,o)=>{const l=Object.keys(o).filter(r=>r!=="asociacion").reduce((r,c)=>r+parseFloat(o[c]||0),0);return n+l},0);this.listaOrganizaciones=t,this.tablaOrganizaciones=t.map(n=>{const o=Object.keys(n).filter(l=>l!=="asociacion").reduce((l,r)=>l+parseFloat(n[r]||0),0);return{asociacion:n.asociacion,totalKg:o,productores:0,promedio:0,porcentaje:d>0?o/d*100:0}}).sort((n,o)=>o.totalKg-n.totalKg).map((n,o)=>({...n,posicion:o+1}))}catch{this.tablaOrganizaciones=[],this.listaOrganizaciones=[]}finally{this.loadingTablas=!1}},async generarGraficoPerformanceOrg(){if(this.orgSeleccionada){this.loadingGraficos=!0;try{await this.$nextTick();const e=this.$refs.chartPerformance;if(!e)return;const t=this.chartInstances.find(r=>r.canvas===e);t&&(t.destroy(),this.chartInstances=this.chartInstances.filter(r=>r.canvas!==e));const n=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"].map(r=>parseFloat(this.orgSeleccionada[r]||0)),o=e.getContext("2d"),l=new z(o,{type:"bar",data:{labels:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],datasets:[{label:this.orgSeleccionada.asociacion,data:n,backgroundColor:"rgba(25, 118, 210, 0.7)",borderColor:"rgb(25, 118, 210)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!0}},scales:{y:{beginAtZero:!0}}}});this.chartInstances.push(l)}catch{this.$alert?.error?.("Error al generar gráfico de performance")}finally{this.loadingGraficos=!1}}},cargarMapaContribucion(){this.tablaContribucion=this.tablaOrganizaciones.map(e=>({asociacion:e.asociacion,porcentaje:e.porcentaje}))},exportarDashboard(e){this.$q.notify({type:"info",message:"Funcionalidad de exportación en desarrollo"})},destruirCharts(){this.chartInstances.forEach(e=>{e&&typeof e.destroy=="function"&&e.destroy()}),this.chartInstances=[]}}},X={class:"row items-center q-mb-md"},Y={class:"col-12 col-md-4 q-gutter-sm"},$={class:"row q-gutter-sm"},aa={class:"col"},oa={class:"col"},ta={class:"col-auto"},ea={class:"row q-gutter-sm"},ia={class:"row q-col-gutter-md q-mb-md"},ra={class:"row items-center"},sa={class:"text-caption text-grey-7"},na={class:"text-h5 text-weight-bold"},la={class:"text-subtitle1 q-mb-md"},ca={key:0},da={key:1,ref:"chartEvolucionAnual",height:"80"},ua={class:"row q-col-gutter-md"},ga={class:"col-12 col-md-4"},pa={key:1,class:"text-center text-grey-6 q-pa-md"},ma={class:"col-12 col-md-4"},fa={key:1,class:"text-center text-grey-6 q-pa-md"},ha={class:"col-12 col-md-4"},ba={key:1,class:"text-center text-grey-6 q-pa-md"},va={class:"row q-col-gutter-md q-mb-md"},_a={class:"col-12 col-md-4"},ya={class:"col-12 col-md-4"},wa={class:"col-12 col-md-4"},xa={class:"text-subtitle1 q-mb-md"},Aa={key:0},Ga={key:1,ref:"chartGeografico",height:"100"},ka={class:"row items-center q-mb-md"},Da={class:"text-caption"},Pa={class:"row q-col-gutter-md"},Ca={class:"col-12 col-md-6"},Ta={class:"text-subtitle1 q-mb-md"},za={key:0},Sa={key:1,ref:"chartProductos",height:"200"},Fa={class:"col-12 col-md-6"},Ka={class:"row q-col-gutter-md q-mb-md"},qa={class:"col-12 col-md-6"},Ea={class:"text-subtitle1 q-mb-md"},Qa={ref:"chartTemporal",height:"80"},Ia={class:"row q-col-gutter-md"},Oa={class:"col-12 col-md-6"},Va={class:"col-12 col-md-6"},Ma={class:"row items-center q-mb-md"},ja={class:"row q-col-gutter-md"},Ua={class:"col-12 col-md-6"},Ra={class:"text-subtitle1 q-mb-md"},Na={ref:"chartPerformance",height:"150"},Ba={class:"col-12 col-md-6"};function Ja(e,t,d,n,o,l){return g(),_(W,{class:"q-pa-md"},{default:i(()=>[s("div",X,[t[11]||(t[11]=s("div",{class:"col-12 col-md-4"},[s("div",{class:"text-h5"},"Dashboard de Acopios"),s("div",{class:"text-caption text-grey-7"},"Análisis multidimensional de producción")],-1)),a(M),s("div",Y,[s("div",$,[s("div",aa,[a(A,{modelValue:o.gestionSeleccionada,"onUpdate:modelValue":[t[0]||(t[0]=r=>o.gestionSeleccionada=r),l.cambioFiltroGlobal],options:o.gestiones,label:"Gestión",dense:"",outlined:""},null,8,["modelValue","options","onUpdate:modelValue"])]),s("div",oa,[a(A,{modelValue:o.productoSeleccionado,"onUpdate:modelValue":[t[1]||(t[1]=r=>o.productoSeleccionado=r),l.cambioFiltroGlobal],options:o.productos,"option-label":"nombre_producto","option-value":"id",label:"Producto",dense:"",outlined:"","emit-value":"","map-options":""},null,8,["modelValue","options","onUpdate:modelValue"])])])]),s("div",ta,[a(F,{flat:"",round:"",icon:"refresh",color:"primary",loading:o.loadingActualizar,onClick:l.actualizarDatos},{default:i(()=>[a(G,null,{default:i(()=>t[10]||(t[10]=[u("Actualizar datos")])),_:1})]),_:1},8,["loading","onClick"])])]),o.indicadoresGlobales?(g(),_(E,{key:0,class:"bg-blue-grey-1 q-mb-md",rounded:""},{default:i(()=>[s("div",ea,[a(q,{color:"primary","text-color":"white",icon:"inbox",dense:""},{default:i(()=>[u(" Total Kg: "+p(o.indicadoresGlobales.totalKg?.toFixed(2)||"0.00"),1)]),_:1}),a(q,{color:"green","text-color":"white",icon:"people",dense:""},{default:i(()=>[u(" Productores: "+p(o.indicadoresGlobales.totalProductores||0),1)]),_:1}),a(q,{color:"orange","text-color":"white",icon:"analytics",dense:""},{default:i(()=>[u(" Promedio: "+p(o.indicadoresGlobales.promedioKg?.toFixed(2)||"0.00")+" Kg/Productor ",1)]),_:1}),a(q,{color:o.indicadoresGlobales.crecimiento>=0?"positive":"negative","text-color":"white",icon:o.indicadoresGlobales.crecimiento>=0?"trending_up":"trending_down",dense:""},{default:i(()=>[u(" Crecimiento: "+p(o.indicadoresGlobales.crecimiento?.toFixed(2)||"0.00")+"% ",1)]),_:1},8,["color","icon"])])]),_:1})):B("",!0),a(m,{flat:"",bordered:""},{default:i(()=>[a(L,{modelValue:o.tabActiva,"onUpdate:modelValue":t[2]||(t[2]=r=>o.tabActiva=r),dense:"",align:"left","active-color":"primary","indicator-color":"primary",class:"text-grey"},{default:i(()=>[a(P,{name:"resumen",icon:"dashboard",label:"Resumen General","no-caps":""}),a(P,{name:"geografico",icon:"location_on",label:"Análisis Geográfico","no-caps":""}),a(P,{name:"productos",icon:"inventory",label:"Análisis por Producto","no-caps":""}),a(P,{name:"temporal",icon:"schedule",label:"Análisis Temporal","no-caps":""}),a(P,{name:"organizacional",icon:"apartment",label:"Análisis Organizacional","no-caps":""})]),_:1},8,["modelValue"]),a(J),a(Z,{modelValue:o.tabActiva,"onUpdate:modelValue":t[9]||(t[9]=r=>o.tabActiva=r),animated:""},{default:i(()=>[a(C,{name:"resumen"},{default:i(()=>[s("div",ia,[(g(!0),f(k,null,D(o.kpisResumen,r=>(g(),f("div",{class:"col-12 col-md-6 col-lg-3",key:r.label},[a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingKpis},null,8,["showing"]),s("div",ra,[a(y,{name:r.icon,color:r.color,size:"md",class:"q-mr-sm"},null,8,["name","color"]),s("div",null,[s("div",sa,p(r.label),1),s("div",na,p(r.value),1)])])]),_:2},1024)]),_:2},1024)]))),128))]),a(m,{flat:"",bordered:"",class:"q-mb-md"},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingGraficos},null,8,["showing"]),s("div",la,[t[13]||(t[13]=u(" Evolución Mensual de Acopios ")),a(y,{name:"info",size:"xs",color:"grey-6"},{default:i(()=>[a(G,null,{default:i(()=>t[12]||(t[12]=[u("Muestra la tendencia de acopio a lo largo del año")])),_:1})]),_:1})]),!o.loadingGraficos&&o.datosEvolucionAnual.length===0?(g(),f("div",ca,[a(E,{class:"bg-info text-white",rounded:"",dense:""},{avatar:i(()=>[a(y,{name:"info"})]),default:i(()=>[t[14]||(t[14]=u(" No hay datos disponibles para la gestión seleccionada "))]),_:1})])):(g(),f("canvas",da,null,512))]),_:1})]),_:1}),s("div",ua,[s("div",ga,[a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingTop3},null,8,["showing"]),t[15]||(t[15]=s("div",{class:"text-subtitle1 q-mb-md"},"Top 3 Departamentos",-1)),o.topDepartamentos.length>0?(g(),_(I,{key:0,dense:""},{default:i(()=>[(g(!0),f(k,null,D(o.topDepartamentos,(r,c)=>(g(),_(Q,{key:c},{default:i(()=>[a(w,{avatar:""},{default:i(()=>[a(K,{color:["primary","secondary","accent"][c],"text-color":"white"},{default:i(()=>[u(p(c+1),1)]),_:2},1032,["color"])]),_:2},1024),a(w,null,{default:i(()=>[a(x,null,{default:i(()=>[u(p(r.nombre),1)]),_:2},1024),a(x,{caption:""},{default:i(()=>[u(p(r.kg)+" Kg",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(g(),f("div",pa,"Sin datos"))]),_:1})]),_:1})]),s("div",ma,[a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingTop3},null,8,["showing"]),t[16]||(t[16]=s("div",{class:"text-subtitle1 q-mb-md"},"Top 3 Municipios",-1)),o.topMunicipios.length>0?(g(),_(I,{key:0,dense:""},{default:i(()=>[(g(!0),f(k,null,D(o.topMunicipios,(r,c)=>(g(),_(Q,{key:c},{default:i(()=>[a(w,{avatar:""},{default:i(()=>[a(K,{color:["primary","secondary","accent"][c],"text-color":"white"},{default:i(()=>[u(p(c+1),1)]),_:2},1032,["color"])]),_:2},1024),a(w,null,{default:i(()=>[a(x,null,{default:i(()=>[u(p(r.nombre),1)]),_:2},1024),a(x,{caption:""},{default:i(()=>[u(p(r.kg)+" Kg",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(g(),f("div",fa,"Sin datos"))]),_:1})]),_:1})]),s("div",ha,[a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingTop3},null,8,["showing"]),t[17]||(t[17]=s("div",{class:"text-subtitle1 q-mb-md"},"Top 3 Organizaciones",-1)),o.topOrganizaciones.length>0?(g(),_(I,{key:0,dense:""},{default:i(()=>[(g(!0),f(k,null,D(o.topOrganizaciones,(r,c)=>(g(),_(Q,{key:c},{default:i(()=>[a(w,{avatar:""},{default:i(()=>[a(K,{color:["primary","secondary","accent"][c],"text-color":"white"},{default:i(()=>[u(p(c+1),1)]),_:2},1032,["color"])]),_:2},1024),a(w,null,{default:i(()=>[a(x,null,{default:i(()=>[u(p(r.nombre),1)]),_:2},1024),a(x,{caption:""},{default:i(()=>[u(p(r.kg)+" Kg",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(g(),f("div",ba,"Sin datos"))]),_:1})]),_:1})])])]),_:1}),a(C,{name:"geografico"},{default:i(()=>[s("div",va,[s("div",_a,[a(A,{modelValue:o.filtroDepartamento,"onUpdate:modelValue":[t[3]||(t[3]=r=>o.filtroDepartamento=r),l.onDepartamentoChange],options:o.departamentos,"option-label":"nombre_departamento","option-value":"id",label:"Departamento",dense:"",outlined:"",clearable:"","emit-value":"","map-options":""},null,8,["modelValue","options","onUpdate:modelValue"])]),s("div",ya,[a(A,{modelValue:o.filtroMunicipio,"onUpdate:modelValue":[t[4]||(t[4]=r=>o.filtroMunicipio=r),l.aplicarFiltroGeografico],options:o.municipios,"option-label":"nombre_municipio","option-value":"id",label:"Municipio",dense:"",outlined:"",clearable:"","emit-value":"","map-options":"",disable:!o.filtroDepartamento},null,8,["modelValue","options","disable","onUpdate:modelValue"])]),s("div",wa,[a(F,{color:"primary",label:"Aplicar Filtros",icon:"filter_alt",onClick:l.aplicarFiltroGeografico,disable:!o.filtroDepartamento,"no-caps":""},null,8,["onClick","disable"])])]),a(m,{flat:"",bordered:"",class:"q-mb-md"},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingGraficos},null,8,["showing"]),s("div",xa,[t[19]||(t[19]=u(" Distribución Geográfica de Acopios ")),a(y,{name:"info",size:"xs",color:"grey-6"},{default:i(()=>[a(G,null,{default:i(()=>t[18]||(t[18]=[u("Comparativa de acopio por ubicación geográfica")])),_:1})]),_:1})]),!o.loadingGraficos&&o.datosGeograficos.length===0?(g(),f("div",Aa,[a(E,{class:"bg-info text-white",rounded:"",dense:""},{avatar:i(()=>[a(y,{name:"info"})]),default:i(()=>[t[20]||(t[20]=u(" Seleccione un departamento para visualizar datos "))]),_:1})])):(g(),f("canvas",Ga,null,512))]),_:1})]),_:1}),a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[s("div",ka,[t[21]||(t[21]=s("div",{class:"text-subtitle1"},"Detalle por Ubicación",-1)),a(M),a(F,{flat:"",dense:"",icon:"download",color:"primary",label:"Exportar",onClick:t[5]||(t[5]=r=>l.exportarDashboard("geografico")),disable:o.tablaGeografica.length===0,"no-caps":""},null,8,["disable"])]),a(T,{rows:o.tablaGeografica,columns:o.columnasGeograficas,"row-key":"ubicacion",dense:"",flat:"",loading:o.loadingTablas,pagination:o.paginacionGeo,"binary-state-sort":""},{"body-cell-porcentaje":i(r=>[a(O,{props:r},{default:i(()=>[a(j,{value:r.row.porcentaje/100,color:"primary",size:"md",class:"q-mb-xs"},null,8,["value"]),s("div",Da,p(r.row.porcentaje)+"%",1)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","pagination"])]),_:1})]),_:1})]),_:1}),a(C,{name:"productos"},{default:i(()=>[s("div",Pa,[s("div",Ca,[a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingGraficos},null,8,["showing"]),s("div",Ta,[t[23]||(t[23]=u(" Distribución por Tipo de Producto ")),a(y,{name:"info",size:"xs",color:"grey-6"},{default:i(()=>[a(G,null,{default:i(()=>t[22]||(t[22]=[u("Proporción de acopio por cada tipo de producto")])),_:1})]),_:1})]),!o.loadingGraficos&&o.datosProductos.length===0?(g(),f("div",za,[a(E,{class:"bg-info text-white",rounded:"",dense:""},{avatar:i(()=>[a(y,{name:"info"})]),default:i(()=>[t[24]||(t[24]=u(" No hay datos disponibles para los filtros seleccionados "))]),_:1})])):(g(),f("canvas",Sa,null,512))]),_:1})]),_:1})]),s("div",Fa,[a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingTablas},null,8,["showing"]),t[25]||(t[25]=s("div",{class:"text-subtitle1 q-mb-md"},"Distribución Geográfica",-1)),a(T,{rows:o.tablaDistribucionProducto,columns:o.columnasDistribucionProducto,"row-key":"ubicacion",dense:"",flat:"",pagination:{rowsPerPage:5}},null,8,["rows","columns"])]),_:1})]),_:1})])])]),_:1}),a(C,{name:"temporal"},{default:i(()=>[s("div",Ka,[s("div",qa,[a(A,{modelValue:o.gestionesComparar,"onUpdate:modelValue":[t[6]||(t[6]=r=>o.gestionesComparar=r),l.generarGraficoTemporal],options:o.gestiones,label:"Gestiones a Comparar (máx. 3)",dense:"",outlined:"",multiple:"","use-chips":"","max-values":"3"},null,8,["modelValue","options","onUpdate:modelValue"])])]),a(m,{flat:"",bordered:"",class:"q-mb-md"},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingGraficos},null,8,["showing"]),s("div",Ea,[t[27]||(t[27]=u(" Evolución Mensual Comparativa ")),a(y,{name:"info",size:"xs",color:"grey-6"},{default:i(()=>[a(G,null,{default:i(()=>t[26]||(t[26]=[u("Comparación de acopio mensual entre gestiones")])),_:1})]),_:1})]),s("canvas",Qa,null,512)]),_:1})]),_:1}),s("div",Ia,[s("div",Oa,[a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingTablas},null,8,["showing"]),t[28]||(t[28]=s("div",{class:"text-subtitle1 q-mb-md"},"Análisis de Estacionalidad",-1)),a(T,{rows:o.tablaEstacionalidad,columns:o.columnasEstacionalidad,"row-key":"mes",dense:"",flat:"",pagination:{rowsPerPage:12}},{"body-cell-tendencia":i(r=>[a(O,{props:r},{default:i(()=>[a(U,{color:r.row.ranking<=3?"positive":r.row.ranking>=10?"negative":"grey",label:r.row.ranking<=3?"Alto":r.row.ranking>=10?"Bajo":"Medio"},null,8,["color","label"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})]),s("div",Va,[a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingTablas},null,8,["showing"]),t[29]||(t[29]=s("div",{class:"text-subtitle1 q-mb-md"},"Comparativa Año vs Año",-1)),a(T,{rows:o.tablaComparativa,columns:o.columnasComparativa,"row-key":"mes",dense:"",flat:"",pagination:{rowsPerPage:12}},{"body-cell-variacion":i(r=>[a(O,{props:r},{default:i(()=>[a(U,{color:r.row.variacion>=0?"positive":"negative",icon:r.row.variacion>=0?"trending_up":"trending_down",label:r.row.variacion.toFixed(2)+"%"},null,8,["color","icon","label"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})])])]),_:1}),a(C,{name:"organizacional"},{default:i(()=>[a(m,{flat:"",bordered:"",class:"q-mb-md"},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingTablas},null,8,["showing"]),s("div",Ma,[t[30]||(t[30]=s("div",{class:"text-subtitle1"},"Ranking de Organizaciones",-1)),a(M),a(F,{flat:"",dense:"",icon:"download",color:"primary",label:"Exportar",onClick:t[7]||(t[7]=r=>l.exportarDashboard("organizacional")),disable:o.tablaOrganizaciones.length===0,"no-caps":""},null,8,["disable"])]),a(T,{rows:o.tablaOrganizaciones,columns:o.columnasOrganizaciones,"row-key":"asociacion",dense:"",flat:"",pagination:{rowsPerPage:10}},{"body-cell-posicion":i(r=>[a(O,{props:r},{default:i(()=>[a(K,{color:r.row.posicion<=3?"primary":"grey","text-color":"white",size:"sm"},{default:i(()=>[u(p(r.row.posicion),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1}),s("div",ja,[s("div",Ua,[a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingGraficos},null,8,["showing"]),s("div",Ra,[t[32]||(t[32]=u(" Performance por Organización ")),a(y,{name:"info",size:"xs",color:"grey-6"},{default:i(()=>[a(G,null,{default:i(()=>t[31]||(t[31]=[u("Acopio mensual de organización seleccionada")])),_:1})]),_:1})]),a(A,{modelValue:o.orgSeleccionada,"onUpdate:modelValue":[t[8]||(t[8]=r=>o.orgSeleccionada=r),l.generarGraficoPerformanceOrg],options:o.listaOrganizaciones,"option-label":"asociacion",label:"Seleccionar Organización",dense:"",outlined:"",class:"q-mb-md"},null,8,["modelValue","options","onUpdate:modelValue"]),s("canvas",Na,null,512)]),_:1})]),_:1})]),s("div",Ba,[a(m,{flat:"",bordered:""},{default:i(()=>[a(h,null,{default:i(()=>[a(v,{showing:o.loadingTablas},null,8,["showing"]),t[33]||(t[33]=s("div",{class:"text-subtitle1 q-mb-md"},"Mapa de Contribución Nacional",-1)),a(I,{dense:""},{default:i(()=>[(g(!0),f(k,null,D(o.tablaContribucion,r=>(g(),_(Q,{key:r.asociacion},{default:i(()=>[a(w,null,{default:i(()=>[a(x,null,{default:i(()=>[u(p(r.asociacion),1)]),_:2},1024),a(j,{value:r.porcentaje/100,color:"primary",size:"lg",class:"q-mt-xs"},null,8,["value"])]),_:2},1024),a(w,{side:""},{default:i(()=>[a(x,{caption:""},{default:i(()=>[u(p(r.porcentaje)+"%",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}const yo=N(H,[["render",Ja],["__scopeId","data-v-6f915152"]]);export{yo as default};
